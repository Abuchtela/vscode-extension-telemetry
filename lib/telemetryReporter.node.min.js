var Pm=Object.create;var Hi=Object.defineProperty;var Rm=Object.getOwnPropertyDescriptor;var Nm=Object.getOwnPropertyNames;var Dm=Object.getPrototypeOf,wm=Object.prototype.hasOwnProperty;var hl=e=>Hi(e,"__esModule",{value:!0});var l=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Mm=(e,t)=>{hl(e);for(var r in t)Hi(e,r,{get:t[r],enumerable:!0})},xm=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Nm(t))!wm.call(e,n)&&n!=="default"&&Hi(e,n,{get:()=>t[n],enumerable:!(r=Rm(t,n))||r.enumerable});return e},Ui=e=>xm(hl(Hi(e!=null?Pm(Dm(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var ne=l((VN,_l)=>{"use strict";var Lm=function(){function e(){}return e.info=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.enableDebug&&console.info(e.TAG+t,r)},e.warn=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.disableWarnings||console.warn(e.TAG+t,r)},e.enableDebug=!1,e.disableWarnings=!1,e.disableErrors=!1,e.TAG="ApplicationInsights:",e}();_l.exports=Lm});var io=l(yt=>{"use strict";var Rr=yt&&yt.__assign||function(){return Rr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Rr.apply(this,arguments)};Object.defineProperty(yt,"__esModule",{value:!0});yt.AsyncScopeManager=yt.OpenTelemetryScopeManagerWrapper=void 0;var Vt=$t(),qm=require("events"),gl=function(){function e(){}return e.prototype.active=function(){var t=this,r=Vt.CorrelationContextManager.getCurrentContext();return Rr(Rr({},r),{getValue:function(n){return t._activeSymbol?n===t._activeSymbol?r:!1:(t._activeSymbol=n,r)},setValue:function(){}})},e.prototype.with=function(t,r){var n=t.parentSpanId,i=t.name,a=e._spanToContext(t,n,i);return Vt.CorrelationContextManager.runWithContext(a,r)()},e.prototype.bind=function(t){return typeof t=="function"?Vt.CorrelationContextManager.wrapCallback(t):(t instanceof qm.EventEmitter&&Vt.CorrelationContextManager.wrapEmitter(t),t)},e.prototype.enable=function(){return Vt.CorrelationContextManager.enable(),this},e.prototype.disable=function(){return Vt.CorrelationContextManager.disable(),this},e._spanToContext=function(t,r,n){var i=r?"|"+t.spanContext().traceId+"."+r+".":t.spanContext().traceId,a=Rr(Rr({},t.spanContext()),{traceFlags:t.spanContext().traceFlags}),s=Vt.CorrelationContextManager.spanToContextObject(a,i,n);return s},e}();yt.OpenTelemetryScopeManagerWrapper=gl;yt.AsyncScopeManager=new gl});var Wi=l((S,wl)=>{S=wl.exports=b;var N;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?N=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:N=function(){};S.SEMVER_SPEC_VERSION="2.0.0";var ao=256,Bi=Number.MAX_SAFE_INTEGER||9007199254740991,so=16,D=S.re=[],h=S.src=[],A=0,Nr=A++;h[Nr]="0|[1-9]\\d*";var Dr=A++;h[Dr]="[0-9]+";var oo=A++;h[oo]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var vl=A++;h[vl]="("+h[Nr]+")\\.("+h[Nr]+")\\.("+h[Nr]+")";var El=A++;h[El]="("+h[Dr]+")\\.("+h[Dr]+")\\.("+h[Dr]+")";var uo=A++;h[uo]="(?:"+h[Nr]+"|"+h[oo]+")";var co=A++;h[co]="(?:"+h[Dr]+"|"+h[oo]+")";var lo=A++;h[lo]="(?:-("+h[uo]+"(?:\\."+h[uo]+")*))";var po=A++;h[po]="(?:-?("+h[co]+"(?:\\."+h[co]+")*))";var fo=A++;h[fo]="[0-9A-Za-z-]+";var Ln=A++;h[Ln]="(?:\\+("+h[fo]+"(?:\\."+h[fo]+")*))";var ho=A++,ml="v?"+h[vl]+h[lo]+"?"+h[Ln]+"?";h[ho]="^"+ml+"$";var _o="[v=\\s]*"+h[El]+h[po]+"?"+h[Ln]+"?",go=A++;h[go]="^"+_o+"$";var wr=A++;h[wr]="((?:<|>)?=?)";var Gi=A++;h[Gi]=h[Dr]+"|x|X|\\*";var Fi=A++;h[Fi]=h[Nr]+"|x|X|\\*";var zt=A++;h[zt]="[v=\\s]*("+h[Fi]+")(?:\\.("+h[Fi]+")(?:\\.("+h[Fi]+")(?:"+h[lo]+")?"+h[Ln]+"?)?)?";var Mr=A++;h[Mr]="[v=\\s]*("+h[Gi]+")(?:\\.("+h[Gi]+")(?:\\.("+h[Gi]+")(?:"+h[po]+")?"+h[Ln]+"?)?)?";var yl=A++;h[yl]="^"+h[wr]+"\\s*"+h[zt]+"$";var Tl=A++;h[Tl]="^"+h[wr]+"\\s*"+h[Mr]+"$";var Sl=A++;h[Sl]="(?:^|[^\\d])(\\d{1,"+so+"})(?:\\.(\\d{1,"+so+"}))?(?:\\.(\\d{1,"+so+"}))?(?:$|[^\\d])";var Vi=A++;h[Vi]="(?:~>?)";var $i=A++;h[$i]="(\\s*)"+h[Vi]+"\\s+";D[$i]=new RegExp(h[$i],"g");var km="$1~",Al=A++;h[Al]="^"+h[Vi]+h[zt]+"$";var bl=A++;h[bl]="^"+h[Vi]+h[Mr]+"$";var zi=A++;h[zi]="(?:\\^)";var Ki=A++;h[Ki]="(\\s*)"+h[zi]+"\\s+";D[Ki]=new RegExp(h[Ki],"g");var jm="$1^",Il=A++;h[Il]="^"+h[zi]+h[zt]+"$";var Cl=A++;h[Cl]="^"+h[zi]+h[Mr]+"$";var vo=A++;h[vo]="^"+h[wr]+"\\s*("+_o+")$|^$";var Eo=A++;h[Eo]="^"+h[wr]+"\\s*("+ml+")$|^$";var qn=A++;h[qn]="(\\s*)"+h[wr]+"\\s*("+_o+"|"+h[zt]+")";D[qn]=new RegExp(h[qn],"g");var Hm="$1$2$3",Ol=A++;h[Ol]="^\\s*("+h[zt]+")\\s+-\\s+("+h[zt]+")\\s*$";var Pl=A++;h[Pl]="^\\s*("+h[Mr]+")\\s+-\\s+("+h[Mr]+")\\s*$";var Rl=A++;h[Rl]="(<|>)?=?\\s*\\*";for(var Kt=0;Kt<A;Kt++)N(Kt,h[Kt]),D[Kt]||(D[Kt]=new RegExp(h[Kt]));S.parse=Yt;function Yt(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof b)return e;if(typeof e!="string"||e.length>ao)return null;var r=t.loose?D[go]:D[ho];if(!r.test(e))return null;try{return new b(e,t)}catch(n){return null}}S.valid=Um;function Um(e,t){var r=Yt(e,t);return r?r.version:null}S.clean=Bm;function Bm(e,t){var r=Yt(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}S.SemVer=b;function b(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof b){if(e.loose===t.loose)return e;e=e.version}else if(typeof e!="string")throw new TypeError("Invalid Version: "+e);if(e.length>ao)throw new TypeError("version is longer than "+ao+" characters");if(!(this instanceof b))return new b(e,t);N("SemVer",e,t),this.options=t,this.loose=!!t.loose;var r=e.trim().match(t.loose?D[go]:D[ho]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Bi||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Bi||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Bi||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<Bi)return i}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}b.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};b.prototype.toString=function(){return this.version};b.prototype.compare=function(e){return N("SemVer.compare",this.version,this.options,e),e instanceof b||(e=new b(e,this.options)),this.compareMain(e)||this.comparePre(e)};b.prototype.compareMain=function(e){return e instanceof b||(e=new b(e,this.options)),xr(this.major,e.major)||xr(this.minor,e.minor)||xr(this.patch,e.patch)};b.prototype.comparePre=function(e){if(e instanceof b||(e=new b(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];if(N("prerelease compare",t,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return xr(r,n)}while(++t)};b.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this};S.inc=Gm;function Gm(e,t,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new b(e,r).inc(t,n).version}catch(i){return null}}S.diff=Fm;function Fm(e,t){if(mo(e,t))return null;var r=Yt(e),n=Yt(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var a="prerelease"}for(var s in r)if((s==="major"||s==="minor"||s==="patch")&&r[s]!==n[s])return i+s;return a}S.compareIdentifiers=xr;var Nl=/^[0-9]+$/;function xr(e,t){var r=Nl.test(e),n=Nl.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}S.rcompareIdentifiers=Vm;function Vm(e,t){return xr(t,e)}S.major=$m;function $m(e,t){return new b(e,t).major}S.minor=zm;function zm(e,t){return new b(e,t).minor}S.patch=Km;function Km(e,t){return new b(e,t).patch}S.compare=it;function it(e,t,r){return new b(e,r).compare(new b(t,r))}S.compareLoose=Ym;function Ym(e,t){return it(e,t,!0)}S.rcompare=Xm;function Xm(e,t,r){return it(t,e,r)}S.sort=Qm;function Qm(e,t){return e.sort(function(r,n){return S.compare(r,n,t)})}S.rsort=Wm;function Wm(e,t){return e.sort(function(r,n){return S.rcompare(r,n,t)})}S.gt=kn;function kn(e,t,r){return it(e,t,r)>0}S.lt=Yi;function Yi(e,t,r){return it(e,t,r)<0}S.eq=mo;function mo(e,t,r){return it(e,t,r)===0}S.neq=Dl;function Dl(e,t,r){return it(e,t,r)!==0}S.gte=yo;function yo(e,t,r){return it(e,t,r)>=0}S.lte=To;function To(e,t,r){return it(e,t,r)<=0}S.cmp=Xi;function Xi(e,t,r,n){switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return mo(e,r,n);case"!=":return Dl(e,r,n);case">":return kn(e,r,n);case">=":return yo(e,r,n);case"<":return Yi(e,r,n);case"<=":return To(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}S.Comparator=Re;function Re(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof Re){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof Re))return new Re(e,t);N("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===jn?this.value="":this.value=this.operator+this.semver.version,N("comp",this)}var jn={};Re.prototype.parse=function(e){var t=this.options.loose?D[vo]:D[Eo],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new b(r[2],this.options.loose):this.semver=jn};Re.prototype.toString=function(){return this.value};Re.prototype.test=function(e){return N("Comparator.test",e,this.options.loose),this.semver===jn?!0:(typeof e=="string"&&(e=new b(e,this.options)),Xi(e,this.operator,this.semver,this.options))};Re.prototype.intersects=function(e,t){if(!(e instanceof Re))throw new TypeError("a Comparator is required");(!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1});var r;if(this.operator==="")return r=new H(e.value,t),Qi(this.value,r,t);if(e.operator==="")return r=new H(this.value,t),Qi(e.semver,r,t);var n=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),a=this.semver.version===e.semver.version,s=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),o=Xi(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),u=Xi(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return n||i||a&&s||o||u};S.Range=H;function H(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof H)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new H(e.raw,t);if(e instanceof Re)return new H(e.value,t);if(!(this instanceof H))return new H(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}H.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range};H.prototype.toString=function(){return this.range};H.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var r=t?D[Pl]:D[Ol];e=e.replace(r,oy),N("hyphen replace",e),e=e.replace(D[qn],Hm),N("comparator trim",e,D[qn]),e=e.replace(D[$i],km),e=e.replace(D[Ki],jm),e=e.split(/\s+/).join(" ");var n=t?D[vo]:D[Eo],i=e.split(" ").map(function(a){return Jm(a,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(a){return!!a.match(n)})),i=i.map(function(a){return new Re(a,this.options)},this),i};H.prototype.intersects=function(e,t){if(!(e instanceof H))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return e.set.some(function(i){return i.every(function(a){return n.intersects(a,t)})})})})};S.toComparators=Zm;function Zm(e,t){return new H(e,t).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function Jm(e,t){return N("comp",e,t),e=ry(e,t),N("caret",e),e=ey(e,t),N("tildes",e),e=iy(e,t),N("xrange",e),e=sy(e,t),N("stars",e),e}function ge(e){return!e||e.toLowerCase()==="x"||e==="*"}function ey(e,t){return e.trim().split(/\s+/).map(function(r){return ty(r,t)}).join(" ")}function ty(e,t){var r=t.loose?D[bl]:D[Al];return e.replace(r,function(n,i,a,s,o){N("tilde",e,n,i,a,s,o);var u;return ge(i)?u="":ge(a)?u=">="+i+".0.0 <"+(+i+1)+".0.0":ge(s)?u=">="+i+"."+a+".0 <"+i+"."+(+a+1)+".0":o?(N("replaceTilde pr",o),u=">="+i+"."+a+"."+s+"-"+o+" <"+i+"."+(+a+1)+".0"):u=">="+i+"."+a+"."+s+" <"+i+"."+(+a+1)+".0",N("tilde return",u),u})}function ry(e,t){return e.trim().split(/\s+/).map(function(r){return ny(r,t)}).join(" ")}function ny(e,t){N("caret",e,t);var r=t.loose?D[Cl]:D[Il];return e.replace(r,function(n,i,a,s,o){N("caret",e,n,i,a,s,o);var u;return ge(i)?u="":ge(a)?u=">="+i+".0.0 <"+(+i+1)+".0.0":ge(s)?i==="0"?u=">="+i+"."+a+".0 <"+i+"."+(+a+1)+".0":u=">="+i+"."+a+".0 <"+(+i+1)+".0.0":o?(N("replaceCaret pr",o),i==="0"?a==="0"?u=">="+i+"."+a+"."+s+"-"+o+" <"+i+"."+a+"."+(+s+1):u=">="+i+"."+a+"."+s+"-"+o+" <"+i+"."+(+a+1)+".0":u=">="+i+"."+a+"."+s+"-"+o+" <"+(+i+1)+".0.0"):(N("no pr"),i==="0"?a==="0"?u=">="+i+"."+a+"."+s+" <"+i+"."+a+"."+(+s+1):u=">="+i+"."+a+"."+s+" <"+i+"."+(+a+1)+".0":u=">="+i+"."+a+"."+s+" <"+(+i+1)+".0.0"),N("caret return",u),u})}function iy(e,t){return N("replaceXRanges",e,t),e.split(/\s+/).map(function(r){return ay(r,t)}).join(" ")}function ay(e,t){e=e.trim();var r=t.loose?D[Tl]:D[yl];return e.replace(r,function(n,i,a,s,o,u){N("xRange",e,n,i,a,s,o,u);var c=ge(a),p=c||ge(s),d=p||ge(o),f=d;return i==="="&&f&&(i=""),c?i===">"||i==="<"?n="<0.0.0":n="*":i&&f?(p&&(s=0),o=0,i===">"?(i=">=",p?(a=+a+1,s=0,o=0):(s=+s+1,o=0)):i==="<="&&(i="<",p?a=+a+1:s=+s+1),n=i+a+"."+s+"."+o):p?n=">="+a+".0.0 <"+(+a+1)+".0.0":d&&(n=">="+a+"."+s+".0 <"+a+"."+(+s+1)+".0"),N("xRange return",n),n})}function sy(e,t){return N("replaceStars",e,t),e.trim().replace(D[Rl],"")}function oy(e,t,r,n,i,a,s,o,u,c,p,d,f){return ge(r)?t="":ge(n)?t=">="+r+".0.0":ge(i)?t=">="+r+"."+n+".0":t=">="+t,ge(u)?o="":ge(c)?o="<"+(+u+1)+".0.0":ge(p)?o="<"+u+"."+(+c+1)+".0":d?o="<="+u+"."+c+"."+p+"-"+d:o="<="+o,(t+" "+o).trim()}H.prototype.test=function(e){if(!e)return!1;typeof e=="string"&&(e=new b(e,this.options));for(var t=0;t<this.set.length;t++)if(uy(this.set[t],e,this.options))return!0;return!1};function uy(e,t,r){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(n=0;n<e.length;n++)if(N(e[n].semver),e[n].semver!==jn&&e[n].semver.prerelease.length>0){var i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}S.satisfies=Qi;function Qi(e,t,r){try{t=new H(t,r)}catch(n){return!1}return t.test(e)}S.maxSatisfying=cy;function cy(e,t,r){var n=null,i=null;try{var a=new H(t,r)}catch(s){return null}return e.forEach(function(s){a.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new b(n,r))}),n}S.minSatisfying=ly;function ly(e,t,r){var n=null,i=null;try{var a=new H(t,r)}catch(s){return null}return e.forEach(function(s){a.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new b(n,r))}),n}S.minVersion=py;function py(e,t){e=new H(e,t);var r=new b("0.0.0");if(e.test(r)||(r=new b("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n){var i=e.set[n];i.forEach(function(a){var s=new b(a.semver.version);switch(a.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!r||kn(r,s))&&(r=s);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+a.operator)}})}return r&&e.test(r)?r:null}S.validRange=dy;function dy(e,t){try{return new H(e,t).range||"*"}catch(r){return null}}S.ltr=fy;function fy(e,t,r){return So(e,t,"<",r)}S.gtr=hy;function hy(e,t,r){return So(e,t,">",r)}S.outside=So;function So(e,t,r,n){e=new b(e,n),t=new H(t,n);var i,a,s,o,u;switch(r){case">":i=kn,a=To,s=Yi,o=">",u=">=";break;case"<":i=Yi,a=yo,s=kn,o="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Qi(e,t,n))return!1;for(var c=0;c<t.set.length;++c){var p=t.set[c],d=null,f=null;if(p.forEach(function(_){_.semver===jn&&(_=new Re(">=0.0.0")),d=d||_,f=f||_,i(_.semver,d.semver,n)?d=_:s(_.semver,f.semver,n)&&(f=_)}),d.operator===o||d.operator===u||(!f.operator||f.operator===o)&&a(e,f.semver))return!1;if(f.operator===u&&s(e,f.semver))return!1}return!0}S.prerelease=_y;function _y(e,t){var r=Yt(e,t);return r&&r.prerelease.length?r.prerelease:null}S.intersects=gy;function gy(e,t,r){return e=new H(e,r),t=new H(t,r),e.intersects(t)}S.coerce=vy;function vy(e){if(e instanceof b)return e;if(typeof e!="string")return null;var t=e.match(D[Sl]);return t==null?null:Yt(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}});var Ao=l(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});Zi.makePatchingRequire=void 0;var Ey=require("path"),my=Wi(),Ml=require("module"),yy=Object.keys(process.binding("natives")),xl=Ml.prototype.require;function Ty(e){var t={};return function(n){var i=xl.apply(this,arguments);if(e[n]){var a=Ml._resolveFilename(n,this);if(t.hasOwnProperty(a))return t[a];var s=void 0;if(yy.indexOf(n)<0)try{s=xl.call(this,Ey.join(n,"package.json")).version}catch(f){return i}else s=process.version.substring(1);var o=s.indexOf("-");o>=0&&(s=s.substring(0,o));for(var u=i,c=0,p=e[n];c<p.length;c++){var d=p[c];my.satisfies(s,d.versionSpecifier)&&(u=d.patch(u,a))}return t[a]=u}return i}}Zi.makePatchingRequire=Ty});var Ll=l((KN,Sy)=>{Sy.exports={name:"diagnostic-channel",version:"1.0.0",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"~8.0.0",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"4.1.2"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var Y=l(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.channel=Lr.makePatchingRequire=void 0;var Ay=Ao(),by=Ao();Object.defineProperty(Lr,"makePatchingRequire",{enumerable:!0,get:function(){return by.makePatchingRequire}});var ql=function(e){return!0},Iy=function(){function e(){this.version=Ll().version,this.subscribers={},this.contextPreservationFunction=function(t){return t},this.knownPatches={},this.currentlyPublishing=!1}return e.prototype.shouldPublish=function(t){var r=this.subscribers[t];return r?r.some(function(n){var i=n.filter;return!i||i(!1)}):!1},e.prototype.publish=function(t,r){if(!this.currentlyPublishing){var n=this.subscribers[t];if(n){var i={timestamp:Date.now(),data:r};this.currentlyPublishing=!0,n.forEach(function(a){var s=a.listener,o=a.filter;try{o&&o(!0)&&s(i)}catch(u){}}),this.currentlyPublishing=!1}}},e.prototype.subscribe=function(t,r,n){n===void 0&&(n=ql),this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push({listener:r,filter:n})},e.prototype.unsubscribe=function(t,r,n){n===void 0&&(n=ql);var i=this.subscribers[t];if(i){for(var a=0;a<i.length;++a)if(i[a].listener===r&&i[a].filter===n)return i.splice(a,1),!0}return!1},e.prototype.reset=function(){var t=this;this.subscribers={},this.contextPreservationFunction=function(r){return r},Object.getOwnPropertyNames(this.knownPatches).forEach(function(r){return delete t.knownPatches[r]})},e.prototype.bindToContext=function(t){return this.contextPreservationFunction(t)},e.prototype.addContextPreservation=function(t){var r=this.contextPreservationFunction;this.contextPreservationFunction=function(n){return t(r(n))}},e.prototype.registerMonkeyPatch=function(t,r){this.knownPatches[t]||(this.knownPatches[t]=[]),this.knownPatches[t].push(r)},e.prototype.getPatchesObject=function(){return this.knownPatches},e}();global.diagnosticsSource||(global.diagnosticsSource=new Iy,kl=require("module"),kl.prototype.require=Ay.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var kl;Lr.channel=global.diagnosticsSource});var Hl=l(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0})});var Ul=l(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.BaggageImpl=void 0;var Cy=function(){function e(t){this._entries=t?new Map(t):new Map}return e.prototype.getEntry=function(t){var r=this._entries.get(t);if(!!r)return Object.assign({},r)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(t){var r=t[0],n=t[1];return[r,n]})},e.prototype.setEntry=function(t,r){var n=new e(this._entries);return n._entries.set(t,r),n},e.prototype.removeEntry=function(t){var r=new e(this._entries);return r._entries.delete(t),r},e.prototype.removeEntries=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=new e(this._entries),i=0,a=t;i<a.length;i++){var s=a[i];n._entries.delete(s)}return n},e.prototype.clear=function(){return new e},e}();Ji.BaggageImpl=Cy});var Bl=l(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.baggageEntryMetadataSymbol=void 0;ea.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")});var bo=l(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.baggageEntryMetadataFromString=qr.createBaggage=void 0;var Oy=w(),Py=Ul(),Ry=Bl();function Ny(e){return e===void 0&&(e={}),new Py.BaggageImpl(new Map(Object.entries(e)))}qr.createBaggage=Ny;function Dy(e){return typeof e!="string"&&(Oy.diag.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:Ry.baggageEntryMetadataSymbol,toString:function(){return e}}}qr.baggageEntryMetadataFromString=Dy});var Fl=l(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0})});var $l=l(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0})});var zl=l(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.DiagConsoleLogger=void 0;var Io=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],wy=function(){function e(){function t(n){return function(){var i=arguments;if(console){var a=console[n];if(typeof a!="function"&&(a=console.log),typeof a=="function")return a.apply(console,i)}}}for(var r=0;r<Io.length;r++)this[Io[r].n]=t(Io[r].c)}return e}();ta.DiagConsoleLogger=wy});var ra=l(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.DiagLogLevel=void 0;var My;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(My=Hn.DiagLogLevel||(Hn.DiagLogLevel={}))});var Yl=l(Tt=>{"use strict";var xy=Tt&&Tt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Kl=Tt&&Tt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&xy(t,e,r)};Object.defineProperty(Tt,"__esModule",{value:!0});Kl(zl(),Tt);Kl(ra(),Tt)});var Co=l(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.defaultTextMapSetter=kr.defaultTextMapGetter=void 0;kr.defaultTextMapGetter={get:function(e,t){if(e!=null)return e[t]},keys:function(e){return e==null?[]:Object.keys(e)}};kr.defaultTextMapSetter={set:function(e,t,r){e!=null&&(e[t]=r)}}});var Ql=l(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0})});var Zl=l(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0})});var Un=l(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.ROOT_CONTEXT=jr.createContextKey=void 0;function Ly(e){return Symbol.for(e)}jr.createContextKey=Ly;var qy=function(){function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,i){var a=new e(r._currentContext);return a._currentContext.set(n,i),a},r.deleteValue=function(n){var i=new e(r._currentContext);return i._currentContext.delete(n),i}}return e}();jr.ROOT_CONTEXT=new qy});var Oo=l(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.TraceFlags=void 0;var ky;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(ky=Bn.TraceFlags||(Bn.TraceFlags={}))});var Gn=l(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.wrapSpanContext=W.isSpanContextValid=W.isValidSpanId=W.isValidTraceId=W.INVALID_SPAN_CONTEXT=W.INVALID_TRACEID=W.INVALID_SPANID=void 0;var jy=na(),Hy=Oo(),Uy=/^([0-9a-f]{32})$/i,By=/^[0-9a-f]{16}$/i;W.INVALID_SPANID="0000000000000000";W.INVALID_TRACEID="00000000000000000000000000000000";W.INVALID_SPAN_CONTEXT={traceId:W.INVALID_TRACEID,spanId:W.INVALID_SPANID,traceFlags:Hy.TraceFlags.NONE};function Jl(e){return Uy.test(e)&&e!==W.INVALID_TRACEID}W.isValidTraceId=Jl;function ep(e){return By.test(e)&&e!==W.INVALID_SPANID}W.isValidSpanId=ep;function Gy(e){return Jl(e.traceId)&&ep(e.spanId)}W.isSpanContextValid=Gy;function Fy(e){return new jy.NonRecordingSpan(e)}W.wrapSpanContext=Fy});var na=l(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.NonRecordingSpan=void 0;var Vy=Gn(),$y=function(){function e(t){t===void 0&&(t=Vy.INVALID_SPAN_CONTEXT),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,r){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,r){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,r){},e}();ia.NonRecordingSpan=$y});var Ro=l(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.getSpanContext=Ne.setSpanContext=Ne.deleteSpan=Ne.setSpan=Ne.getSpan=void 0;var zy=Un(),Ky=na(),Po=zy.createContextKey("OpenTelemetry Context Key SPAN");function tp(e){return e.getValue(Po)||void 0}Ne.getSpan=tp;function rp(e,t){return e.setValue(Po,t)}Ne.setSpan=rp;function Yy(e){return e.deleteValue(Po)}Ne.deleteSpan=Yy;function Xy(e,t){return rp(e,new Ky.NonRecordingSpan(t))}Ne.setSpanContext=Xy;function Qy(e){var t;return(t=tp(e))===null||t===void 0?void 0:t.spanContext()}Ne.getSpanContext=Qy});var Do=l(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});aa.NoopTracer=void 0;var np=w(),ip=Ro(),No=na(),Wy=Gn(),Zy=function(){function e(){}return e.prototype.startSpan=function(t,r,n){var i=Boolean(r==null?void 0:r.root);if(i)return new No.NonRecordingSpan;var a=n&&ip.getSpanContext(n);return Jy(a)&&Wy.isSpanContextValid(a)?new No.NonRecordingSpan(a):new No.NonRecordingSpan},e.prototype.startActiveSpan=function(t,r,n,i){var a,s,o;if(!(arguments.length<2)){arguments.length===2?o=r:arguments.length===3?(a=r,o=n):(a=r,s=n,o=i);var u=s??np.context.active(),c=this.startSpan(t,a,u),p=ip.setSpan(u,c);return np.context.with(p,o,void 0,c)}},e}();aa.NoopTracer=Zy;function Jy(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}});var wo=l(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.ProxyTracer=void 0;var eT=Do(),tT=function(){function e(t,r,n){this._provider=t,this.name=r,this.version=n}return e.prototype.startSpan=function(t,r,n){return this._getTracer().startSpan(t,r,n)},e.prototype.startActiveSpan=function(t,r,n,i){var a=this._getTracer();return Reflect.apply(a.startActiveSpan,a,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version);return t?(this._delegate=t,this._delegate):new eT.NoopTracer},e}();sa.ProxyTracer=tT});var ap=l(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.NoopTracerProvider=void 0;var rT=Do(),nT=function(){function e(){}return e.prototype.getTracer=function(t,r){return new rT.NoopTracer},e}();oa.NoopTracerProvider=nT});var Mo=l(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.ProxyTracerProvider=void 0;var iT=wo(),aT=ap(),sT=new aT.NoopTracerProvider,oT=function(){function e(){}return e.prototype.getTracer=function(t,r){var n;return(n=this.getDelegateTracer(t,r))!==null&&n!==void 0?n:new iT.ProxyTracer(this,t,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:sT},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,r){var n;return(n=this._delegate)===null||n===void 0?void 0:n.getTracer(t,r)},e}();ua.ProxyTracerProvider=oT});var op=l(sp=>{"use strict";Object.defineProperty(sp,"__esModule",{value:!0})});var up=l(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.SamplingDecision=void 0;var uT;(function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(uT=Fn.SamplingDecision||(Fn.SamplingDecision={}))});var lp=l(cp=>{"use strict";Object.defineProperty(cp,"__esModule",{value:!0})});var pp=l(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.SpanKind=void 0;var cT;(function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"})(cT=Vn.SpanKind||(Vn.SpanKind={}))});var fp=l(dp=>{"use strict";Object.defineProperty(dp,"__esModule",{value:!0})});var _p=l(hp=>{"use strict";Object.defineProperty(hp,"__esModule",{value:!0})});var gp=l($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.SpanStatusCode=void 0;var lT;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(lT=$n.SpanStatusCode||($n.SpanStatusCode={}))});var Ep=l(vp=>{"use strict";Object.defineProperty(vp,"__esModule",{value:!0})});var yp=l(mp=>{"use strict";Object.defineProperty(mp,"__esModule",{value:!0})});var Sp=l(Tp=>{"use strict";Object.defineProperty(Tp,"__esModule",{value:!0})});var bp=l(Ap=>{"use strict";Object.defineProperty(Ap,"__esModule",{value:!0})});var Ip=l(Hr=>{"use strict";var pT=Hr&&Hr.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.NoopContextManager=void 0;var dT=Un(),fT=function(){function e(){}return e.prototype.active=function(){return dT.ROOT_CONTEXT},e.prototype.with=function(t,r,n){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return r.call.apply(r,pT([n],i))},e.prototype.bind=function(t,r){return r},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}();Hr.NoopContextManager=fT});var Cp=l(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca._globalThis=void 0;ca._globalThis=typeof globalThis=="object"?globalThis:global});var Op=l(Xt=>{"use strict";var hT=Xt&&Xt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),_T=Xt&&Xt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&hT(t,e,r)};Object.defineProperty(Xt,"__esModule",{value:!0});_T(Cp(),Xt)});var Pp=l(Qt=>{"use strict";var gT=Qt&&Qt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),vT=Qt&&Qt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&gT(t,e,r)};Object.defineProperty(Qt,"__esModule",{value:!0});vT(Op(),Qt)});var xo=l(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.VERSION=void 0;la.VERSION="1.0.1"});var Dp=l(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.isCompatible=Ur._makeCompatibilityCheck=void 0;var ET=xo(),Rp=/^(\d+)\.(\d+)\.(\d+)(?:-(.*))?$/;function Np(e){var t=new Set([e]),r=new Set,n=e.match(Rp);if(!n)return function(){return!1};var i={major:+n[1],minor:+n[2],patch:+n[3]};function a(o){return r.add(o),!1}function s(o){return t.add(o),!0}return function(u){if(t.has(u))return!0;if(r.has(u))return!1;var c=u.match(Rp);if(!c)return a(u);var p={major:+c[1],minor:+c[2],patch:+c[3]};return i.major!==p.major?a(u):i.major===0?i.minor===p.minor&&i.patch<=p.patch?s(u):a(u):i.minor<=p.minor?s(u):a(u)}}Ur._makeCompatibilityCheck=Np;Ur.isCompatible=Np(ET.VERSION)});var Br=l(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.unregisterGlobal=St.getGlobal=St.registerGlobal=void 0;var mT=Pp(),zn=xo(),yT=Dp(),TT=zn.VERSION.split(".")[0],Kn=Symbol.for("opentelemetry.js.api."+TT),Yn=mT._globalThis;function ST(e,t,r,n){var i;n===void 0&&(n=!1);var a=Yn[Kn]=(i=Yn[Kn])!==null&&i!==void 0?i:{version:zn.VERSION};if(!n&&a[e]){var s=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(s.stack||s.message),!1}if(a.version!==zn.VERSION){var s=new Error("@opentelemetry/api: All API registration versions must match");return r.error(s.stack||s.message),!1}return a[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+zn.VERSION+"."),!0}St.registerGlobal=ST;function AT(e){var t,r,n=(t=Yn[Kn])===null||t===void 0?void 0:t.version;if(!(!n||!yT.isCompatible(n)))return(r=Yn[Kn])===null||r===void 0?void 0:r[e]}St.getGlobal=AT;function bT(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+zn.VERSION+".");var r=Yn[Kn];r&&delete r[e]}St.unregisterGlobal=bT});var wp=l(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.DiagComponentLogger=void 0;var IT=Br(),CT=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Xn("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Xn("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Xn("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Xn("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Xn("verbose",this._namespace,t)},e}();pa.DiagComponentLogger=CT;function Xn(e,t,r){var n=IT.getGlobal("diag");if(!!n)return r.unshift(t),n[e].apply(n,r)}});var Mp=l(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.createLogLevelDiagLogger=void 0;var at=ra();function OT(e,t){e<at.DiagLogLevel.NONE?e=at.DiagLogLevel.NONE:e>at.DiagLogLevel.ALL&&(e=at.DiagLogLevel.ALL),t=t||{};function r(n,i){var a=t[n];return typeof a=="function"&&e>=i?a.bind(t):function(){}}return{error:r("error",at.DiagLogLevel.ERROR),warn:r("warn",at.DiagLogLevel.WARN),info:r("info",at.DiagLogLevel.INFO),debug:r("debug",at.DiagLogLevel.DEBUG),verbose:r("verbose",at.DiagLogLevel.VERBOSE)}}da.createLogLevelDiagLogger=OT});var Qn=l(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.DiagAPI=void 0;var PT=wp(),RT=Mp(),NT=ra(),fa=Br(),DT="diag",wT=function(){function e(){function t(n){return function(){var i=fa.getGlobal("diag");if(!!i)return i[n].apply(i,arguments)}}var r=this;r.setLogger=function(n,i){var a,s;if(i===void 0&&(i=NT.DiagLogLevel.INFO),n===r){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((a=o.stack)!==null&&a!==void 0?a:o.message),!1}var u=fa.getGlobal("diag"),c=RT.createLogLevelDiagLogger(i,n);if(u){var p=(s=new Error().stack)!==null&&s!==void 0?s:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+p),c.warn("Current logger will overwrite one already registered from "+p)}return fa.registerGlobal("diag",c,r,!0)},r.disable=function(){fa.unregisterGlobal(DT,r)},r.createComponentLogger=function(n){return new PT.DiagComponentLogger(n)},r.verbose=t("verbose"),r.debug=t("debug"),r.info=t("info"),r.warn=t("warn"),r.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();ha.DiagAPI=wT});var Lp=l(Gr=>{"use strict";var MT=Gr&&Gr.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e};Object.defineProperty(Gr,"__esModule",{value:!0});Gr.ContextAPI=void 0;var xT=Ip(),Lo=Br(),xp=Qn(),qo="context",LT=new xT.NoopContextManager,qT=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return Lo.registerGlobal(qo,t,xp.DiagAPI.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,r,n){for(var i,a=[],s=3;s<arguments.length;s++)a[s-3]=arguments[s];return(i=this._getContextManager()).with.apply(i,MT([t,r,n],a))},e.prototype.bind=function(t,r){return this._getContextManager().bind(t,r)},e.prototype._getContextManager=function(){return Lo.getGlobal(qo)||LT},e.prototype.disable=function(){this._getContextManager().disable(),Lo.unregisterGlobal(qo,xp.DiagAPI.instance())},e}();Gr.ContextAPI=qT});var Hp=l(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.TraceAPI=void 0;var ko=Br(),qp=Mo(),kp=Gn(),Wn=Ro(),jp=Qn(),jo="trace",kT=function(){function e(){this._proxyTracerProvider=new qp.ProxyTracerProvider,this.wrapSpanContext=kp.wrapSpanContext,this.isSpanContextValid=kp.isSpanContextValid,this.deleteSpan=Wn.deleteSpan,this.getSpan=Wn.getSpan,this.getSpanContext=Wn.getSpanContext,this.setSpan=Wn.setSpan,this.setSpanContext=Wn.setSpanContext}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){return this._proxyTracerProvider.setDelegate(t),ko.registerGlobal(jo,this._proxyTracerProvider,jp.DiagAPI.instance())},e.prototype.getTracerProvider=function(){return ko.getGlobal(jo)||this._proxyTracerProvider},e.prototype.getTracer=function(t,r){return this.getTracerProvider().getTracer(t,r)},e.prototype.disable=function(){ko.unregisterGlobal(jo,jp.DiagAPI.instance()),this._proxyTracerProvider=new qp.ProxyTracerProvider},e}();_a.TraceAPI=kT});var Up=l(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.NoopTextMapPropagator=void 0;var jT=function(){function e(){}return e.prototype.inject=function(t,r){},e.prototype.extract=function(t,r){return t},e.prototype.fields=function(){return[]},e}();ga.NoopTextMapPropagator=jT});var Bp=l(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.deleteBaggage=At.setBaggage=At.getBaggage=void 0;var HT=Un(),Ho=HT.createContextKey("OpenTelemetry Baggage Key");function UT(e){return e.getValue(Ho)||void 0}At.getBaggage=UT;function BT(e,t){return e.setValue(Ho,t)}At.setBaggage=BT;function GT(e){return e.deleteValue(Ho)}At.deleteBaggage=GT});var Vp=l(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.PropagationAPI=void 0;var Uo=Br(),FT=Up(),Gp=Co(),Bo=Bp(),VT=bo(),Fp=Qn(),Go="propagation",$T=new FT.NoopTextMapPropagator,zT=function(){function e(){this.createBaggage=VT.createBaggage,this.getBaggage=Bo.getBaggage,this.setBaggage=Bo.setBaggage,this.deleteBaggage=Bo.deleteBaggage}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(t){return Uo.registerGlobal(Go,t,Fp.DiagAPI.instance())},e.prototype.inject=function(t,r,n){return n===void 0&&(n=Gp.defaultTextMapSetter),this._getGlobalPropagator().inject(t,r,n)},e.prototype.extract=function(t,r,n){return n===void 0&&(n=Gp.defaultTextMapGetter),this._getGlobalPropagator().extract(t,r,n)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){Uo.unregisterGlobal(Go,Fp.DiagAPI.instance())},e.prototype._getGlobalPropagator=function(){return Uo.getGlobal(Go)||$T},e}();va.PropagationAPI=zT});var w=l(E=>{"use strict";var KT=E&&E.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),G=E&&E.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&KT(t,e,r)};Object.defineProperty(E,"__esModule",{value:!0});E.diag=E.propagation=E.trace=E.context=E.isValidSpanId=E.isValidTraceId=E.isSpanContextValid=E.INVALID_SPAN_CONTEXT=E.INVALID_TRACEID=E.INVALID_SPANID=E.baggageEntryMetadataFromString=void 0;G(Hl(),E);var YT=bo();Object.defineProperty(E,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return YT.baggageEntryMetadataFromString}});G(Fl(),E);G($l(),E);G(Yl(),E);G(Co(),E);G(Ql(),E);G(Zl(),E);G(wo(),E);G(Mo(),E);G(op(),E);G(up(),E);G(lp(),E);G(pp(),E);G(fp(),E);G(_p(),E);G(gp(),E);G(Oo(),E);G(Ep(),E);G(yp(),E);G(Sp(),E);var Fr=Gn();Object.defineProperty(E,"INVALID_SPANID",{enumerable:!0,get:function(){return Fr.INVALID_SPANID}});Object.defineProperty(E,"INVALID_TRACEID",{enumerable:!0,get:function(){return Fr.INVALID_TRACEID}});Object.defineProperty(E,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return Fr.INVALID_SPAN_CONTEXT}});Object.defineProperty(E,"isSpanContextValid",{enumerable:!0,get:function(){return Fr.isSpanContextValid}});Object.defineProperty(E,"isValidTraceId",{enumerable:!0,get:function(){return Fr.isValidTraceId}});Object.defineProperty(E,"isValidSpanId",{enumerable:!0,get:function(){return Fr.isValidSpanId}});G(Un(),E);G(bp(),E);var XT=Lp();E.context=XT.ContextAPI.getInstance();var QT=Hp();E.trace=QT.TraceAPI.getInstance();var WT=Vp();E.propagation=WT.PropagationAPI.getInstance();var ZT=Qn();E.diag=ZT.DiagAPI.instance();E.default={trace:E.trace,context:E.context,propagation:E.propagation,diag:E.diag}});var Ea=l(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.isTracingSuppressed=bt.unsuppressTracing=bt.suppressTracing=void 0;var JT=w(),Fo=JT.createContextKey("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function eS(e){return e.setValue(Fo,!0)}bt.suppressTracing=eS;function tS(e){return e.deleteValue(Fo)}bt.unsuppressTracing=tS;function rS(e){return e.getValue(Fo)===!0}bt.isTracingSuppressed=rS});var Vo=l(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.BAGGAGE_MAX_TOTAL_LENGTH=pe.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=pe.BAGGAGE_MAX_NAME_VALUE_PAIRS=pe.BAGGAGE_HEADER=pe.BAGGAGE_ITEMS_SEPARATOR=pe.BAGGAGE_PROPERTIES_SEPARATOR=pe.BAGGAGE_KEY_PAIR_SEPARATOR=void 0;pe.BAGGAGE_KEY_PAIR_SEPARATOR="=";pe.BAGGAGE_PROPERTIES_SEPARATOR=";";pe.BAGGAGE_ITEMS_SEPARATOR=",";pe.BAGGAGE_HEADER="baggage";pe.BAGGAGE_MAX_NAME_VALUE_PAIRS=180;pe.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=4096;pe.BAGGAGE_MAX_TOTAL_LENGTH=8192});var $o=l(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.parseKeyPairsIntoRecord=He.parsePairKeyValue=He.getKeyPairs=He.serializeKeyPairs=void 0;var nS=w(),Vr=Vo(),iS=e=>e.reduce((t,r)=>{let n=`${t}${t!==""?Vr.BAGGAGE_ITEMS_SEPARATOR:""}${r}`;return n.length>Vr.BAGGAGE_MAX_TOTAL_LENGTH?t:n},"");He.serializeKeyPairs=iS;var aS=e=>e.getAllEntries().map(([t,r])=>`${encodeURIComponent(t)}=${encodeURIComponent(r.value)}`);He.getKeyPairs=aS;var sS=e=>{let t=e.split(Vr.BAGGAGE_PROPERTIES_SEPARATOR);if(t.length<=0)return;let r=t.shift();if(!r)return;let n=r.split(Vr.BAGGAGE_KEY_PAIR_SEPARATOR);if(n.length!==2)return;let i=decodeURIComponent(n[0].trim()),a=decodeURIComponent(n[1].trim()),s;return t.length>0&&(s=nS.baggageEntryMetadataFromString(t.join(Vr.BAGGAGE_PROPERTIES_SEPARATOR))),{key:i,value:a,metadata:s}};He.parsePairKeyValue=sS;var oS=e=>typeof e!="string"||e.length===0?{}:e.split(Vr.BAGGAGE_ITEMS_SEPARATOR).map(t=>He.parsePairKeyValue(t)).filter(t=>t!==void 0&&t.value.length>0).reduce((t,r)=>(t[r.key]=r.value,t),{});He.parseKeyPairsIntoRecord=oS});var zp=l(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.HttpBaggagePropagator=void 0;var zo=w(),uS=Ea(),$r=Vo(),Ko=$o(),$p=class{inject(t,r,n){let i=zo.propagation.getBaggage(t);if(!i||uS.isTracingSuppressed(t))return;let a=Ko.getKeyPairs(i).filter(o=>o.length<=$r.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS).slice(0,$r.BAGGAGE_MAX_NAME_VALUE_PAIRS),s=Ko.serializeKeyPairs(a);s.length>0&&n.set(r,$r.BAGGAGE_HEADER,s)}extract(t,r,n){let i=n.get(r,$r.BAGGAGE_HEADER);if(!i)return t;let a={};return i.length===0||(i.split($r.BAGGAGE_ITEMS_SEPARATOR).forEach(o=>{let u=Ko.parsePairKeyValue(o);if(u){let c={value:u.value};u.metadata&&(c.metadata=u.metadata),a[u.key]=c}}),Object.entries(a).length===0)?t:zo.propagation.setBaggage(t,zo.propagation.createBaggage(a))}fields(){return[$r.BAGGAGE_HEADER]}};ma.HttpBaggagePropagator=$p});var Xp=l(zr=>{"use strict";Object.defineProperty(zr,"__esModule",{value:!0});zr.isAttributeValue=zr.sanitizeAttributes=void 0;function cS(e){let t={};if(e==null||typeof e!="object")return t;for(let[r,n]of Object.entries(e))Kp(n)&&(Array.isArray(n)?t[r]=n.slice():t[r]=n);return t}zr.sanitizeAttributes=cS;function Kp(e){return e==null?!0:Array.isArray(e)?lS(e):Yp(e)}zr.isAttributeValue=Kp;function lS(e){let t;for(let r of e)if(r!=null){if(!t){if(Yp(r)){t=typeof r;continue}return!1}if(typeof r!==t)return!1}return!0}function Yp(e){switch(typeof e){case"number":return!0;case"boolean":return!0;case"string":return!0}return!1}});var Yo=l(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.loggingErrorHandler=void 0;var pS=w();function dS(){return e=>{pS.diag.error(fS(e))}}ya.loggingErrorHandler=dS;function fS(e){return typeof e=="string"?e:JSON.stringify(hS(e))}function hS(e){let t={},r=e;for(;r!==null;)Object.getOwnPropertyNames(r).forEach(n=>{if(t[n])return;let i=r[n];i&&(t[n]=String(i))}),r=Object.getPrototypeOf(r);return t}});var Xo=l(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.globalErrorHandler=Kr.setGlobalErrorHandler=void 0;var _S=Yo(),Qp=_S.loggingErrorHandler();function gS(e){Qp=e}Kr.setGlobalErrorHandler=gS;var vS=e=>{try{Qp(e)}catch(t){}};Kr.globalErrorHandler=vS});var Qo=l(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:!0});Zn.TracesSamplerValues=void 0;var ES;(function(e){e.AlwaysOff="always_off",e.AlwaysOn="always_on",e.ParentBasedAlwaysOff="parentbased_always_off",e.ParentBasedAlwaysOn="parentbased_always_on",e.ParentBasedTraceIdRatio="parentbased_traceidratio",e.TraceIdRatio="traceidratio"})(ES=Zn.TracesSamplerValues||(Zn.TracesSamplerValues={}))});var Wo=l(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.parseEnvironment=Wt.DEFAULT_ENVIRONMENT=void 0;var It=w(),mS=Qo(),yS=",",TS=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT"];function SS(e){return TS.indexOf(e)>-1}var AS=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function bS(e){return AS.indexOf(e)>-1}Wt.DEFAULT_ENVIRONMENT={CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:It.DiagLogLevel.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"none",OTEL_TRACES_SAMPLER:mS.TracesSamplerValues.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:""};function IS(e,t,r,n=-1/0,i=1/0){if(typeof r[e]!="undefined"){let a=Number(r[e]);isNaN(a)||(a<n?t[e]=n:a>i?t[e]=i:t[e]=a)}}function CS(e,t,r,n=yS){let i=r[e];typeof i=="string"&&(t[e]=i.split(n).map(a=>a.trim()))}var OS={ALL:It.DiagLogLevel.ALL,VERBOSE:It.DiagLogLevel.VERBOSE,DEBUG:It.DiagLogLevel.DEBUG,INFO:It.DiagLogLevel.INFO,WARN:It.DiagLogLevel.WARN,ERROR:It.DiagLogLevel.ERROR,NONE:It.DiagLogLevel.NONE};function PS(e,t,r){let n=r[e];if(typeof n=="string"){let i=OS[n.toUpperCase()];i!=null&&(t[e]=i)}}function RS(e){let t={};for(let r in Wt.DEFAULT_ENVIRONMENT){let n=r;switch(n){case"OTEL_LOG_LEVEL":PS(n,t,e);break;default:if(SS(n))IS(n,t,e);else if(bS(n))CS(n,t,e);else{let i=e[n];typeof i!="undefined"&&i!==null&&(t[n]=String(i))}}}return t}Wt.parseEnvironment=RS});var Zp=l(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.getEnv=void 0;var NS=require("os"),Wp=Wo();function DS(){let e=Wp.parseEnvironment(process.env);return Object.assign({HOSTNAME:NS.hostname()},Wp.DEFAULT_ENVIRONMENT,e)}Ta.getEnv=DS});var Jp=l(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.hexToBase64=void 0;function wS(e){let t=e.length,r="";for(let n=0;n<t;n+=2){let i=e.substring(n,n+2),a=parseInt(i,16);r+=String.fromCharCode(a)}return Buffer.from(r,"ascii").toString("base64")}Sa.hexToBase64=wS});var nd=l(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.RandomIdGenerator=void 0;var MS=8,ed=16,td=class{constructor(){this.generateTraceId=rd(ed),this.generateSpanId=rd(MS)}};ba.RandomIdGenerator=td;var Aa=Buffer.allocUnsafe(ed);function rd(e){return function(){for(let r=0;r<e/4;r++)Aa.writeUInt32BE(Math.random()*2**32>>>0,r*4);for(let r=0;r<e&&!(Aa[r]>0);r++)r===e-1&&(Aa[e-1]=1);return Aa.toString("hex",0,e)}}});var id=l(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.otperformance=void 0;var xS=require("perf_hooks");Ia.otperformance=xS.performance});var Oa=l(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.VERSION=void 0;Ca.VERSION="0.23.0"});var ad=l(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.RpcGrpcStatusCodeValues=I.MessagingOperationValues=I.MessagingDestinationKindValues=I.HttpFlavorValues=I.NetTransportValues=I.FaasInvokedProviderValues=I.FaasDocumentOperationValues=I.FaasTriggerValues=I.DbCassandraConsistencyLevelValues=I.DbSystemValues=I.SemanticAttributes=void 0;I.SemanticAttributes={DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_METHOD:"rpc.jsonrpc.method",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message"};var LS;(function(e){e.OTHER_SQL="other_sql",e.MSSQL="mssql",e.MYSQL="mysql",e.ORACLE="oracle",e.DB2="db2",e.POSTGRESQL="postgresql",e.REDSHIFT="redshift",e.HIVE="hive",e.CLOUDSCAPE="cloudscape",e.HSQLDB="hsqldb",e.PROGRESS="progress",e.MAXDB="maxdb",e.HANADB="hanadb",e.INGRES="ingres",e.FIRSTSQL="firstsql",e.EDB="edb",e.CACHE="cache",e.ADABAS="adabas",e.FIREBIRD="firebird",e.DERBY="derby",e.FILEMAKER="filemaker",e.INFORMIX="informix",e.INSTANTDB="instantdb",e.INTERBASE="interbase",e.MARIADB="mariadb",e.NETEZZA="netezza",e.PERVASIVE="pervasive",e.POINTBASE="pointbase",e.SQLITE="sqlite",e.SYBASE="sybase",e.TERADATA="teradata",e.VERTICA="vertica",e.H2="h2",e.COLDFUSION="coldfusion",e.CASSANDRA="cassandra",e.HBASE="hbase",e.MONGODB="mongodb",e.REDIS="redis",e.COUCHBASE="couchbase",e.COUCHDB="couchdb",e.COSMOSDB="cosmosdb",e.DYNAMODB="dynamodb",e.NEO4J="neo4j",e.GEODE="geode",e.ELASTICSEARCH="elasticsearch",e.MEMCACHED="memcached",e.COCKROACHDB="cockroachdb"})(LS=I.DbSystemValues||(I.DbSystemValues={}));var qS;(function(e){e.ALL="all",e.EACH_QUORUM="each_quorum",e.QUORUM="quorum",e.LOCAL_QUORUM="local_quorum",e.ONE="one",e.TWO="two",e.THREE="three",e.LOCAL_ONE="local_one",e.ANY="any",e.SERIAL="serial",e.LOCAL_SERIAL="local_serial"})(qS=I.DbCassandraConsistencyLevelValues||(I.DbCassandraConsistencyLevelValues={}));var kS;(function(e){e.DATASOURCE="datasource",e.HTTP="http",e.PUBSUB="pubsub",e.TIMER="timer",e.OTHER="other"})(kS=I.FaasTriggerValues||(I.FaasTriggerValues={}));var jS;(function(e){e.INSERT="insert",e.EDIT="edit",e.DELETE="delete"})(jS=I.FaasDocumentOperationValues||(I.FaasDocumentOperationValues={}));var HS;(function(e){e.AWS="aws",e.AZURE="azure",e.GCP="gcp"})(HS=I.FaasInvokedProviderValues||(I.FaasInvokedProviderValues={}));var US;(function(e){e.IP_TCP="ip_tcp",e.IP_UDP="ip_udp",e.IP="ip",e.UNIX="unix",e.PIPE="pipe",e.INPROC="inproc",e.OTHER="other"})(US=I.NetTransportValues||(I.NetTransportValues={}));var BS;(function(e){e.HTTP_1_0="1.0",e.HTTP_1_1="1.1",e.HTTP_2_0="2.0",e.SPDY="SPDY",e.QUIC="QUIC"})(BS=I.HttpFlavorValues||(I.HttpFlavorValues={}));var GS;(function(e){e.QUEUE="queue",e.TOPIC="topic"})(GS=I.MessagingDestinationKindValues||(I.MessagingDestinationKindValues={}));var FS;(function(e){e.RECEIVE="receive",e.PROCESS="process"})(FS=I.MessagingOperationValues||(I.MessagingOperationValues={}));var VS;(function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"})(VS=I.RpcGrpcStatusCodeValues||(I.RpcGrpcStatusCodeValues={}))});var sd=l(Zt=>{"use strict";var $S=Zt&&Zt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zS=Zt&&Zt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&$S(t,e,r)};Object.defineProperty(Zt,"__esModule",{value:!0});zS(ad(),Zt)});var od=l(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.TelemetrySdkLanguageValues=F.OsTypeValues=F.HostArchValues=F.AwsEcsLaunchtypeValues=F.CloudPlatformValues=F.CloudProviderValues=F.ResourceAttributes=void 0;F.ResourceAttributes={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"};var KS;(function(e){e.AWS="aws",e.AZURE="azure",e.GCP="gcp"})(KS=F.CloudProviderValues||(F.CloudProviderValues={}));var YS;(function(e){e.AWS_EC2="aws_ec2",e.AWS_ECS="aws_ecs",e.AWS_EKS="aws_eks",e.AWS_LAMBDA="aws_lambda",e.AWS_ELASTIC_BEANSTALK="aws_elastic_beanstalk",e.AZURE_VM="azure_vm",e.AZURE_CONTAINER_INSTANCES="azure_container_instances",e.AZURE_AKS="azure_aks",e.AZURE_FUNCTIONS="azure_functions",e.AZURE_APP_SERVICE="azure_app_service",e.GCP_COMPUTE_ENGINE="gcp_compute_engine",e.GCP_CLOUD_RUN="gcp_cloud_run",e.GCP_KUBERNETES_ENGINE="gcp_kubernetes_engine",e.GCP_CLOUD_FUNCTIONS="gcp_cloud_functions",e.GCP_APP_ENGINE="gcp_app_engine"})(YS=F.CloudPlatformValues||(F.CloudPlatformValues={}));var XS;(function(e){e.EC2="ec2",e.FARGATE="fargate"})(XS=F.AwsEcsLaunchtypeValues||(F.AwsEcsLaunchtypeValues={}));var QS;(function(e){e.AMD64="amd64",e.ARM32="arm32",e.ARM64="arm64",e.IA64="ia64",e.PPC32="ppc32",e.PPC64="ppc64",e.X86="x86"})(QS=F.HostArchValues||(F.HostArchValues={}));var WS;(function(e){e.WINDOWS="windows",e.LINUX="linux",e.DARWIN="darwin",e.FREEBSD="freebsd",e.NETBSD="netbsd",e.OPENBSD="openbsd",e.DRAGONFLYBSD="dragonflybsd",e.HPUX="hpux",e.AIX="aix",e.SOLARIS="solaris",e.Z_OS="z_os"})(WS=F.OsTypeValues||(F.OsTypeValues={}));var ZS;(function(e){e.CPP="cpp",e.DOTNET="dotnet",e.ERLANG="erlang",e.GO="go",e.JAVA="java",e.NODEJS="nodejs",e.PHP="php",e.PYTHON="python",e.RUBY="ruby",e.WEBJS="webjs"})(ZS=F.TelemetrySdkLanguageValues||(F.TelemetrySdkLanguageValues={}))});var ud=l(Jt=>{"use strict";var JS=Jt&&Jt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),eA=Jt&&Jt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&JS(t,e,r)};Object.defineProperty(Jt,"__esModule",{value:!0});eA(od(),Jt)});var Yr=l(Ct=>{"use strict";var tA=Ct&&Ct.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),cd=Ct&&Ct.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&tA(t,e,r)};Object.defineProperty(Ct,"__esModule",{value:!0});cd(sd(),Ct);cd(ud(),Ct)});var ld=l(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});Pa.SDK_INFO=void 0;var rA=Oa(),Jn=Yr();Pa.SDK_INFO={[Jn.ResourceAttributes.TELEMETRY_SDK_NAME]:"opentelemetry",[Jn.ResourceAttributes.PROCESS_RUNTIME_NAME]:"node",[Jn.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:Jn.TelemetrySdkLanguageValues.NODEJS,[Jn.ResourceAttributes.TELEMETRY_SDK_VERSION]:rA.VERSION}});var pd=l(Ra=>{"use strict";Object.defineProperty(Ra,"__esModule",{value:!0});Ra.unrefTimer=void 0;function nA(e){e.unref()}Ra.unrefTimer=nA});var dd=l(De=>{"use strict";var iA=De&&De.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Xr=De&&De.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&iA(t,e,r)};Object.defineProperty(De,"__esModule",{value:!0});Xr(Zp(),De);Xr(Jp(),De);Xr(nd(),De);Xr(id(),De);Xr(ld(),De);Xr(pd(),De)});var Zo=l(er=>{"use strict";var aA=er&&er.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),sA=er&&er.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&aA(t,e,r)};Object.defineProperty(er,"__esModule",{value:!0});sA(dd(),er)});var _d=l(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.isTimeInput=Z.isTimeInputHrTime=Z.hrTimeToMicroseconds=Z.hrTimeToMilliseconds=Z.hrTimeToNanoseconds=Z.hrTimeToTimeStamp=Z.hrTimeDuration=Z.timeInputToHrTime=Z.hrTime=void 0;var Jo=Zo(),eu=9,ei=Math.pow(10,eu);function Na(e){let t=e/1e3,r=Math.trunc(t),n=Number((t-r).toFixed(eu))*ei;return[r,n]}function fd(){let e=Jo.otperformance.timeOrigin;if(typeof e!="number"){let t=Jo.otperformance;e=t.timing&&t.timing.fetchStart}return e}function hd(e){let t=Na(fd()),r=Na(typeof e=="number"?e:Jo.otperformance.now()),n=t[0]+r[0],i=t[1]+r[1];return i>ei&&(i-=ei,n+=1),[n,i]}Z.hrTime=hd;function oA(e){if(tu(e))return e;if(typeof e=="number")return e<fd()?hd(e):Na(e);if(e instanceof Date)return Na(e.getTime());throw TypeError("Invalid input type")}Z.timeInputToHrTime=oA;function uA(e,t){let r=t[0]-e[0],n=t[1]-e[1];return n<0&&(r-=1,n+=ei),[r,n]}Z.hrTimeDuration=uA;function cA(e){let t=eu,r=`${"0".repeat(t)}${e[1]}Z`,n=r.substr(r.length-t-1);return new Date(e[0]*1e3).toISOString().replace("000Z",n)}Z.hrTimeToTimeStamp=cA;function lA(e){return e[0]*ei+e[1]}Z.hrTimeToNanoseconds=lA;function pA(e){return Math.round(e[0]*1e3+e[1]/1e6)}Z.hrTimeToMilliseconds=pA;function dA(e){return Math.round(e[0]*1e6+e[1]/1e3)}Z.hrTimeToMicroseconds=dA;function tu(e){return Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"}Z.isTimeInputHrTime=tu;function fA(e){return tu(e)||typeof e=="number"||e instanceof Date}Z.isTimeInput=fA});var vd=l(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0})});var Ed=l(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.ExportResultCode=void 0;var hA;(function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"})(hA=ti.ExportResultCode||(ti.ExportResultCode={}))});var Td=l(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});Da.CompositePropagator=void 0;var md=w(),yd=class{constructor(t={}){var r;this._propagators=(r=t.propagators)!==null&&r!==void 0?r:[],this._fields=Array.from(new Set(this._propagators.map(n=>typeof n.fields=="function"?n.fields():[]).reduce((n,i)=>n.concat(i),[])))}inject(t,r,n){for(let i of this._propagators)try{i.inject(t,r,n)}catch(a){md.diag.warn(`Failed to inject with ${i.constructor.name}. Err: ${a.message}`)}}extract(t,r,n){return this._propagators.reduce((i,a)=>{try{return a.extract(i,r,n)}catch(s){md.diag.warn(`Failed to inject with ${a.constructor.name}. Err: ${s.message}`)}return i},t)}fields(){return this._fields.slice()}};Da.CompositePropagator=yd});var Sd=l(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.validateValue=Qr.validateKey=void 0;var ru="[_0-9a-z-*/]",_A=`[a-z]${ru}{0,255}`,gA=`[a-z0-9]${ru}{0,240}@[a-z]${ru}{0,13}`,vA=new RegExp(`^(?:${_A}|${gA})$`),EA=/^[ -~]{0,255}[!-~]$/,mA=/,|=/;function yA(e){return vA.test(e)}Qr.validateKey=yA;function TA(e){return EA.test(e)&&!mA.test(e)}Qr.validateValue=TA});var nu=l(Ma=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});Ma.TraceState=void 0;var Ad=Sd(),bd=32,SA=512,Id=",",Cd="=",wa=class{constructor(t){this._internalState=new Map,t&&this._parse(t)}set(t,r){let n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,r),n}unset(t){let r=this._clone();return r._internalState.delete(t),r}get(t){return this._internalState.get(t)}serialize(){return this._keys().reduce((t,r)=>(t.push(r+Cd+this.get(r)),t),[]).join(Id)}_parse(t){t.length>SA||(this._internalState=t.split(Id).reverse().reduce((r,n)=>{let i=n.trim(),a=i.indexOf(Cd);if(a!==-1){let s=i.slice(0,a),o=i.slice(a+1,n.length);Ad.validateKey(s)&&Ad.validateValue(o)&&r.set(s,o)}return r},new Map),this._internalState.size>bd&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,bd))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let t=new wa;return t._internalState=new Map(this._internalState),t}};Ma.TraceState=wa});var Rd=l(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.HttpTraceContextPropagator=de.parseTraceParent=de.TRACE_STATE_HEADER=de.TRACE_PARENT_HEADER=void 0;var xa=w(),AA=Ea(),bA=nu();de.TRACE_PARENT_HEADER="traceparent";de.TRACE_STATE_HEADER="tracestate";var IA="00",CA="(?!ff)[\\da-f]{2}",OA="(?![0]{32})[\\da-f]{32}",PA="(?![0]{16})[\\da-f]{16}",RA="[\\da-f]{2}",NA=new RegExp(`^\\s?(${CA})-(${OA})-(${PA})-(${RA})(-.*)?\\s?$`);function Od(e){let t=NA.exec(e);return!t||t[1]==="00"&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}}de.parseTraceParent=Od;var Pd=class{inject(t,r,n){let i=xa.trace.getSpanContext(t);if(!i||AA.isTracingSuppressed(t)||!xa.isSpanContextValid(i))return;let a=`${IA}-${i.traceId}-${i.spanId}-0${Number(i.traceFlags||xa.TraceFlags.NONE).toString(16)}`;n.set(r,de.TRACE_PARENT_HEADER,a),i.traceState&&n.set(r,de.TRACE_STATE_HEADER,i.traceState.serialize())}extract(t,r,n){let i=n.get(r,de.TRACE_PARENT_HEADER);if(!i)return t;let a=Array.isArray(i)?i[0]:i;if(typeof a!="string")return t;let s=Od(a);if(!s)return t;s.isRemote=!0;let o=n.get(r,de.TRACE_STATE_HEADER);if(o){let u=Array.isArray(o)?o.join(","):o;s.traceState=new bA.TraceState(typeof u=="string"?u:void 0)}return xa.trace.setSpanContext(t,s)}fields(){return[de.TRACE_PARENT_HEADER,de.TRACE_STATE_HEADER]}};de.HttpTraceContextPropagator=Pd});var Dd=l(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0})});var wd=l(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.getRPCMetadata=Ue.deleteRPCMetadata=Ue.setRPCMetadata=Ue.RPCType=void 0;var DA=w(),iu=DA.createContextKey("OpenTelemetry SDK Context Key RPC_METADATA"),wA;(function(e){e.HTTP="http"})(wA=Ue.RPCType||(Ue.RPCType={}));function MA(e,t){return e.setValue(iu,t)}Ue.setRPCMetadata=MA;function xA(e){return e.deleteValue(iu)}Ue.deleteRPCMetadata=xA;function LA(e){return e.getValue(iu)}Ue.getRPCMetadata=LA});var au=l(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.AlwaysOffSampler=void 0;var qA=w(),Md=class{shouldSample(){return{decision:qA.SamplingDecision.NOT_RECORD}}toString(){return"AlwaysOffSampler"}};La.AlwaysOffSampler=Md});var su=l(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.AlwaysOnSampler=void 0;var kA=w(),xd=class{shouldSample(){return{decision:kA.SamplingDecision.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}};qa.AlwaysOnSampler=xd});var kd=l(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});ja.ParentBasedSampler=void 0;var ka=w(),jA=Xo(),Ld=au(),ou=su(),qd=class{constructor(t){var r,n,i,a;this._root=t.root,this._root||(jA.globalErrorHandler(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new ou.AlwaysOnSampler),this._remoteParentSampled=(r=t.remoteParentSampled)!==null&&r!==void 0?r:new ou.AlwaysOnSampler,this._remoteParentNotSampled=(n=t.remoteParentNotSampled)!==null&&n!==void 0?n:new Ld.AlwaysOffSampler,this._localParentSampled=(i=t.localParentSampled)!==null&&i!==void 0?i:new ou.AlwaysOnSampler,this._localParentNotSampled=(a=t.localParentNotSampled)!==null&&a!==void 0?a:new Ld.AlwaysOffSampler}shouldSample(t,r,n,i,a,s){let o=ka.trace.getSpanContext(t);return!o||!ka.isSpanContextValid(o)?this._root.shouldSample(t,r,n,i,a,s):o.isRemote?o.traceFlags&ka.TraceFlags.SAMPLED?this._remoteParentSampled.shouldSample(t,r,n,i,a,s):this._remoteParentNotSampled.shouldSample(t,r,n,i,a,s):o.traceFlags&ka.TraceFlags.SAMPLED?this._localParentSampled.shouldSample(t,r,n,i,a,s):this._localParentNotSampled.shouldSample(t,r,n,i,a,s)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}};ja.ParentBasedSampler=qd});var Hd=l(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});Ha.TraceIdRatioBasedSampler=void 0;var uu=w(),jd=class{constructor(t=0){this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(t,r){return{decision:uu.isValidTraceId(r)&&this._accumulate(r)<this._upperBound?uu.SamplingDecision.RECORD_AND_SAMPLED:uu.SamplingDecision.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(t){return typeof t!="number"||isNaN(t)?0:t>=1?1:t<=0?0:t}_accumulate(t){let r=0;for(let n=0;n<t.length/8;n++){let i=n*8,a=parseInt(t.slice(i,i+8),16);r=(r^a)>>>0}return r}};Ha.TraceIdRatioBasedSampler=jd});var Bd=l(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.isUrlIgnored=Wr.urlMatches=void 0;function Ud(e,t){return typeof t=="string"?e===t:t.test(e)}Wr.urlMatches=Ud;function HA(e,t){if(!t)return!1;for(let r of t)if(Ud(e,r))return!0;return!1}Wr.isUrlIgnored=HA});var Gd=l(Ua=>{"use strict";Object.defineProperty(Ua,"__esModule",{value:!0});Ua.isWrapped=void 0;function UA(e){return typeof e=="function"&&typeof e.__original=="function"&&typeof e.__unwrap=="function"&&e.__wrapped===!0}Ua.isWrapped=UA});var we=l(C=>{"use strict";var BA=C&&C.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),k=C&&C.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&BA(t,e,r)};Object.defineProperty(C,"__esModule",{value:!0});C.baggageUtils=void 0;k(zp(),C);k(Xp(),C);k(Xo(),C);k(Yo(),C);k(_d(),C);k(vd(),C);k(Ed(),C);k(Oa(),C);C.baggageUtils=$o();k(Zo(),C);k(Td(),C);k(Rd(),C);k(Dd(),C);k(wd(),C);k(au(),C);k(su(),C);k(kd(),C);k(Hd(),C);k(Ea(),C);k(nu(),C);k(Wo(),C);k(Qo(),C);k(Bd(),C);k(Gd(),C);k(Oa(),C)});var Fd=l(Ba=>{"use strict";Object.defineProperty(Ba,"__esModule",{value:!0});Ba.ExceptionEventName=void 0;Ba.ExceptionEventName="exception"});var cu=l(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});Ga.Span=void 0;var Ot=w(),ze=we(),tr=Yr(),GA=Fd(),Vd=class{constructor(t,r,n,i,a,s,o=[],u=ze.hrTime()){this.attributes={},this.links=[],this.events=[],this.status={code:Ot.SpanStatusCode.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=i,this.parentSpanId=s,this.kind=a,this.links=o,this.startTime=ze.timeInputToHrTime(u),this.resource=t.resource,this.instrumentationLibrary=t.instrumentationLibrary,this._spanLimits=t.getSpanLimits(),this._spanProcessor=t.getActiveSpanProcessor(),this._spanProcessor.onStart(this,r)}spanContext(){return this._spanContext}setAttribute(t,r){return r==null||this._isSpanEnded()?this:t.length===0?(Ot.diag.warn(`Invalid attribute key: ${t}`),this):ze.isAttributeValue(r)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?this:(this.attributes[t]=r,this):(Ot.diag.warn(`Invalid attribute value set for key: ${t}`),this)}setAttributes(t){for(let[r,n]of Object.entries(t))this.setAttribute(r,n);return this}addEvent(t,r,n){return this._isSpanEnded()?this:(this.events.length>=this._spanLimits.eventCountLimit&&(Ot.diag.warn("Dropping extra events."),this.events.shift()),ze.isTimeInput(r)&&(typeof n=="undefined"&&(n=r),r=void 0),typeof n=="undefined"&&(n=ze.hrTime()),this.events.push({name:t,attributes:r,time:ze.timeInputToHrTime(n)}),this)}setStatus(t){return this._isSpanEnded()?this:(this.status=t,this)}updateName(t){return this._isSpanEnded()?this:(this.name=t,this)}end(t=ze.hrTime()){if(this._isSpanEnded()){Ot.diag.error("You can only call end() on a span once.");return}this._ended=!0,this.endTime=ze.timeInputToHrTime(t),this._duration=ze.hrTimeDuration(this.startTime,this.endTime),this._duration[0]<0&&Ot.diag.warn("Inconsistent start and end time, startTime > endTime",this.startTime,this.endTime),this._spanProcessor.onEnd(this)}isRecording(){return this._ended===!1}recordException(t,r=ze.hrTime()){let n={};typeof t=="string"?n[tr.SemanticAttributes.EXCEPTION_MESSAGE]=t:t&&(t.code?n[tr.SemanticAttributes.EXCEPTION_TYPE]=t.code.toString():t.name&&(n[tr.SemanticAttributes.EXCEPTION_TYPE]=t.name),t.message&&(n[tr.SemanticAttributes.EXCEPTION_MESSAGE]=t.message),t.stack&&(n[tr.SemanticAttributes.EXCEPTION_STACKTRACE]=t.stack)),n[tr.SemanticAttributes.EXCEPTION_TYPE]||n[tr.SemanticAttributes.EXCEPTION_MESSAGE]?this.addEvent(GA.ExceptionEventName,n,r):Ot.diag.warn(`Failed to record an exception ${t}`)}get duration(){return this._duration}get ended(){return this._ended}_isSpanEnded(){return this._ended&&Ot.diag.warn("Can not execute the operation on ended Span {traceId: %s, spanId: %s}",this._spanContext.traceId,this._spanContext.spanId),this._ended}};Ga.Span=Vd});var lu=l(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.buildSamplerFromEnv=Jr.DEFAULT_CONFIG=void 0;var Fa=w(),V=we(),FA=V.getEnv(),VA=V.TracesSamplerValues.AlwaysOn;Jr.DEFAULT_CONFIG={sampler:$d(FA),forceFlushTimeoutMillis:3e4,spanLimits:{attributeCountLimit:V.getEnv().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:V.getEnv().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:V.getEnv().OTEL_SPAN_EVENT_COUNT_LIMIT}};function $d(e=V.getEnv()){switch(e.OTEL_TRACES_SAMPLER){case V.TracesSamplerValues.AlwaysOn:return new V.AlwaysOnSampler;case V.TracesSamplerValues.AlwaysOff:return new V.AlwaysOffSampler;case V.TracesSamplerValues.ParentBasedAlwaysOn:return new V.ParentBasedSampler({root:new V.AlwaysOnSampler});case V.TracesSamplerValues.ParentBasedAlwaysOff:return new V.ParentBasedSampler({root:new V.AlwaysOffSampler});case V.TracesSamplerValues.TraceIdRatio:return new V.TraceIdRatioBasedSampler(zd(e));case V.TracesSamplerValues.ParentBasedTraceIdRatio:return new V.ParentBasedSampler({root:new V.TraceIdRatioBasedSampler(zd(e))});default:return Fa.diag.error(`OTEL_TRACES_SAMPLER value "${e.OTEL_TRACES_SAMPLER} invalid, defaulting to ${VA}".`),new V.AlwaysOnSampler}}Jr.buildSamplerFromEnv=$d;var Zr=1;function zd(e){if(e.OTEL_TRACES_SAMPLER_ARG===void 0||e.OTEL_TRACES_SAMPLER_ARG==="")return Fa.diag.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${Zr}.`),Zr;let t=Number(e.OTEL_TRACES_SAMPLER_ARG);return isNaN(t)?(Fa.diag.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is invalid, defaulting to ${Zr}.`),Zr):t<0||t>1?(Fa.diag.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is out of range ([0..1]), defaulting to ${Zr}.`),Zr):t}});var Kd=l(Va=>{"use strict";Object.defineProperty(Va,"__esModule",{value:!0});Va.mergeConfig=void 0;var pu=lu();function $A(e){let t={sampler:pu.buildSamplerFromEnv()},r=Object.assign({},pu.DEFAULT_CONFIG,t,e);return r.spanLimits=Object.assign({},pu.DEFAULT_CONFIG.spanLimits,e.spanLimits||{}),r}Va.mergeConfig=$A});var Xd=l($a=>{"use strict";Object.defineProperty($a,"__esModule",{value:!0});$a.Tracer=void 0;var ie=w(),du=we(),zA=cu(),KA=Kd(),Yd=class{constructor(t,r,n){this._tracerProvider=n;let i=KA.mergeConfig(r);this._sampler=i.sampler,this._spanLimits=i.spanLimits,this._idGenerator=r.idGenerator||new du.RandomIdGenerator,this.resource=n.resource,this.instrumentationLibrary=t}startSpan(t,r={},n=ie.context.active()){var i,a;if(du.isTracingSuppressed(n))return ie.diag.debug("Instrumentation suppressed, returning Noop Span"),ie.trace.wrapSpanContext(ie.INVALID_SPAN_CONTEXT);let s=YA(r,n),o=this._idGenerator.generateSpanId(),u,c,p;!s||!ie.trace.isSpanContextValid(s)?u=this._idGenerator.generateTraceId():(u=s.traceId,c=s.traceState,p=s.spanId);let d=(i=r.kind)!==null&&i!==void 0?i:ie.SpanKind.INTERNAL,f=(a=r.links)!==null&&a!==void 0?a:[],_=du.sanitizeAttributes(r.attributes),g=this._sampler.shouldSample(r.root?ie.trace.setSpanContext(n,ie.INVALID_SPAN_CONTEXT):n,u,t,d,_,f),y=g.decision===ie.SamplingDecision.RECORD_AND_SAMPLED?ie.TraceFlags.SAMPLED:ie.TraceFlags.NONE,R={traceId:u,spanId:o,traceFlags:y,traceState:c};if(g.decision===ie.SamplingDecision.NOT_RECORD)return ie.diag.debug("Recording is off, propagating context in a non-recording span"),ie.trace.wrapSpanContext(R);let K=new zA.Span(this,n,t,R,d,p,f,r.startTime);return K.setAttributes(Object.assign(_,g.attributes)),K}startActiveSpan(t,r,n,i){let a,s,o;if(arguments.length<2)return;arguments.length===2?o=r:arguments.length===3?(a=r,o=n):(a=r,s=n,o=i);let u=s??ie.context.active(),c=this.startSpan(t,a,u),p=ie.trace.setSpan(u,c);return ie.context.with(p,o,void 0,c)}getSpanLimits(){return this._spanLimits}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}};$a.Tracer=Yd;function YA(e,t){if(!e.root)return ie.trace.getSpanContext(t)}});var Qd=l(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.defaultServiceName=void 0;function XA(){return`unknown_service:${process.argv0}`}za.defaultServiceName=XA});var Zd=l(Ka=>{"use strict";Object.defineProperty(Ka,"__esModule",{value:!0});Ka.detectResources=void 0;var Wd=hu(),fu=w(),QA=require("util"),WA=async(e={})=>{let t=Object.assign(e),r=await Promise.all((t.detectors||[]).map(async n=>{try{let i=await n.detect(t);return fu.diag.debug(`${n.constructor.name} found resource.`,i),i}catch(i){return fu.diag.debug(`${n.constructor.name} failed: ${i.message}`),Wd.Resource.empty()}}));return ZA(r),r.reduce((n,i)=>n.merge(i),Wd.Resource.empty())};Ka.detectResources=WA;var ZA=e=>{e.forEach(t=>{if(Object.keys(t.attributes).length>0){let r=QA.inspect(t.attributes,{depth:2,breakLength:1/0,sorted:!0,compact:!1});fu.diag.verbose(r)}})}});var ef=l(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});Ya.envDetector=void 0;var JA=w(),eb=we(),tb=Yr(),rb=Xa(),Jd=class{constructor(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}async detect(t){let r={},n=eb.getEnv(),i=n.OTEL_RESOURCE_ATTRIBUTES,a=n.OTEL_SERVICE_NAME;if(i)try{let s=this._parseResourceAttributes(i);Object.assign(r,s)}catch(s){JA.diag.debug(`EnvDetector failed: ${s.message}`)}return a&&(r[tb.ResourceAttributes.SERVICE_NAME]=a),new rb.Resource(r)}_parseResourceAttributes(t){if(!t)return{};let r={},n=t.split(this._COMMA_SEPARATOR,-1);for(let i of n){let a=i.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(a.length!==2)continue;let[s,o]=a;if(s=s.trim(),o=o.trim().split('^"|"$').join(""),!this._isValidAndNotEmpty(s))throw new Error(`Attribute key ${this._ERROR_MESSAGE_INVALID_CHARS}`);if(!this._isValid(o))throw new Error(`Attribute value ${this._ERROR_MESSAGE_INVALID_VALUE}`);r[s]=o}return r}_isValid(t){return t.length<=this._MAX_LENGTH&&this._isPrintableString(t)}_isPrintableString(t){for(let r=0;r<t.length;r++){let n=t.charAt(r);if(n<=" "||n>="~")return!1}return!0}_isValidAndNotEmpty(t){return t.length>0&&this._isValid(t)}};Ya.envDetector=new Jd});var nf=l(Qa=>{"use strict";Object.defineProperty(Qa,"__esModule",{value:!0});Qa.processDetector=void 0;var nb=w(),Pt=Yr(),tf=Xa(),rf=class{async detect(t){let r={[Pt.ResourceAttributes.PROCESS_PID]:process.pid,[Pt.ResourceAttributes.PROCESS_EXECUTABLE_NAME]:process.title||"",[Pt.ResourceAttributes.PROCESS_COMMAND]:process.argv[1]||"",[Pt.ResourceAttributes.PROCESS_COMMAND_LINE]:process.argv.join(" ")||""};return this._getResourceAttributes(r,t)}_getResourceAttributes(t,r){return t[Pt.ResourceAttributes.PROCESS_EXECUTABLE_NAME]===""||t[Pt.ResourceAttributes.PROCESS_EXECUTABLE_PATH]===""||t[Pt.ResourceAttributes.PROCESS_COMMAND]===""||t[Pt.ResourceAttributes.PROCESS_COMMAND_LINE]===""?(nb.diag.debug("ProcessDetector failed: Unable to find required process resources. "),tf.Resource.empty()):new tf.Resource(Object.assign({},t))}};Qa.processDetector=new rf});var sf=l(Rt=>{"use strict";var ib=Rt&&Rt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),af=Rt&&Rt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&ib(t,e,r)};Object.defineProperty(Rt,"__esModule",{value:!0});af(ef(),Rt);af(nf(),Rt)});var of=l(st=>{"use strict";var ab=st&&st.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),_u=st&&st.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&ab(t,e,r)};Object.defineProperty(st,"__esModule",{value:!0});_u(Qd(),st);_u(Zd(),st);_u(sf(),st)});var gu=l(rr=>{"use strict";var sb=rr&&rr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ob=rr&&rr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&sb(t,e,r)};Object.defineProperty(rr,"__esModule",{value:!0});ob(of(),rr)});var hu=l(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.Resource=void 0;var nr=Yr(),vu=we(),ub=gu(),Nt=class{constructor(t){this.attributes=t}static empty(){return Nt.EMPTY}static default(){return new Nt({[nr.ResourceAttributes.SERVICE_NAME]:ub.defaultServiceName(),[nr.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:vu.SDK_INFO[nr.ResourceAttributes.TELEMETRY_SDK_LANGUAGE],[nr.ResourceAttributes.TELEMETRY_SDK_NAME]:vu.SDK_INFO[nr.ResourceAttributes.TELEMETRY_SDK_NAME],[nr.ResourceAttributes.TELEMETRY_SDK_VERSION]:vu.SDK_INFO[nr.ResourceAttributes.TELEMETRY_SDK_VERSION]})}merge(t){if(!t||!Object.keys(t.attributes).length)return this;let r=Object.assign({},this.attributes,t.attributes);return new Nt(r)}};Wa.Resource=Nt;Nt.EMPTY=new Nt({})});var cf=l(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0})});var pf=l(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0})});var Xa=l(Ke=>{"use strict";var cb=Ke&&Ke.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Za=Ke&&Ke.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&cb(t,e,r)};Object.defineProperty(Ke,"__esModule",{value:!0});Za(hu(),Ke);Za(gu(),Ke);Za(cf(),Ke);Za(pf(),Ke)});var ff=l(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.MultiSpanProcessor=void 0;var lb=we(),df=class{constructor(t){this._spanProcessors=t}forceFlush(){let t=[];for(let r of this._spanProcessors)t.push(r.forceFlush());return new Promise(r=>{Promise.all(t).then(()=>{r()}).catch(n=>{lb.globalErrorHandler(n||new Error("MultiSpanProcessor: forceFlush failed")),r()})})}onStart(t,r){for(let n of this._spanProcessors)n.onStart(t,r)}onEnd(t){for(let r of this._spanProcessors)r.onEnd(t)}shutdown(){let t=[];for(let r of this._spanProcessors)t.push(r.shutdown());return new Promise((r,n)=>{Promise.all(t).then(()=>{r()},n)})}};Ja.MultiSpanProcessor=df});var Eu=l(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.NoopSpanProcessor=void 0;var hf=class{onStart(t,r){}onEnd(t){}shutdown(){return Promise.resolve()}forceFlush(){return Promise.resolve()}};es.NoopSpanProcessor=hf});var Ff=l((si,rn)=>{var pb=200,_f="__lodash_hash_undefined__",db=800,fb=16,gf=9007199254740991,vf="[object Arguments]",hb="[object Array]",_b="[object AsyncFunction]",gb="[object Boolean]",vb="[object Date]",Eb="[object Error]",Ef="[object Function]",mb="[object GeneratorFunction]",yb="[object Map]",Tb="[object Number]",Sb="[object Null]",mf="[object Object]",Ab="[object Proxy]",bb="[object RegExp]",Ib="[object Set]",Cb="[object String]",Ob="[object Undefined]",Pb="[object WeakMap]",Rb="[object ArrayBuffer]",Nb="[object DataView]",Db="[object Float32Array]",wb="[object Float64Array]",Mb="[object Int8Array]",xb="[object Int16Array]",Lb="[object Int32Array]",qb="[object Uint8Array]",kb="[object Uint8ClampedArray]",jb="[object Uint16Array]",Hb="[object Uint32Array]",Ub=/[\\^$.*+?()[\]{}|]/g,Bb=/^\[object .+?Constructor\]$/,Gb=/^(?:0|[1-9]\d*)$/,L={};L[Db]=L[wb]=L[Mb]=L[xb]=L[Lb]=L[qb]=L[kb]=L[jb]=L[Hb]=!0;L[vf]=L[hb]=L[Rb]=L[gb]=L[Nb]=L[vb]=L[Eb]=L[Ef]=L[yb]=L[Tb]=L[mf]=L[bb]=L[Ib]=L[Cb]=L[Pb]=!1;var yf=typeof global=="object"&&global&&global.Object===Object&&global,Fb=typeof self=="object"&&self&&self.Object===Object&&self,ri=yf||Fb||Function("return this")(),Tf=typeof si=="object"&&si&&!si.nodeType&&si,ni=Tf&&typeof rn=="object"&&rn&&!rn.nodeType&&rn,Sf=ni&&ni.exports===Tf,mu=Sf&&yf.process,Af=function(){try{var e=ni&&ni.require&&ni.require("util").types;return e||mu&&mu.binding&&mu.binding("util")}catch(t){}}(),bf=Af&&Af.isTypedArray;function Vb(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function $b(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function zb(e){return function(t){return e(t)}}function Kb(e,t){return e==null?void 0:e[t]}function Yb(e,t){return function(r){return e(t(r))}}var Xb=Array.prototype,Qb=Function.prototype,ts=Object.prototype,yu=ri["__core-js_shared__"],rs=Qb.toString,ot=ts.hasOwnProperty,If=function(){var e=/[^.]+$/.exec(yu&&yu.keys&&yu.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Cf=ts.toString,Wb=rs.call(Object),Zb=RegExp("^"+rs.call(ot).replace(Ub,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ns=Sf?ri.Buffer:void 0,Of=ri.Symbol,Pf=ri.Uint8Array,Rf=ns?ns.allocUnsafe:void 0,Nf=Yb(Object.getPrototypeOf,Object),Df=Object.create,Jb=ts.propertyIsEnumerable,eI=Xb.splice,ir=Of?Of.toStringTag:void 0,is=function(){try{var e=Au(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),tI=ns?ns.isBuffer:void 0,wf=Math.max,rI=Date.now,Mf=Au(ri,"Map"),ii=Au(Object,"create"),nI=function(){function e(){}return function(t){if(!sr(t))return{};if(Df)return Df(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function ar(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function iI(){this.__data__=ii?ii(null):{},this.size=0}function aI(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function sI(e){var t=this.__data__;if(ii){var r=t[e];return r===_f?void 0:r}return ot.call(t,e)?t[e]:void 0}function oI(e){var t=this.__data__;return ii?t[e]!==void 0:ot.call(t,e)}function uI(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ii&&t===void 0?_f:t,this}ar.prototype.clear=iI;ar.prototype.delete=aI;ar.prototype.get=sI;ar.prototype.has=oI;ar.prototype.set=uI;function ut(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function cI(){this.__data__=[],this.size=0}function lI(e){var t=this.__data__,r=as(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():eI.call(t,r,1),--this.size,!0}function pI(e){var t=this.__data__,r=as(t,e);return r<0?void 0:t[r][1]}function dI(e){return as(this.__data__,e)>-1}function fI(e,t){var r=this.__data__,n=as(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}ut.prototype.clear=cI;ut.prototype.delete=lI;ut.prototype.get=pI;ut.prototype.has=dI;ut.prototype.set=fI;function en(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function hI(){this.size=0,this.__data__={hash:new ar,map:new(Mf||ut),string:new ar}}function _I(e){var t=os(this,e).delete(e);return this.size-=t?1:0,t}function gI(e){return os(this,e).get(e)}function vI(e){return os(this,e).has(e)}function EI(e,t){var r=os(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}en.prototype.clear=hI;en.prototype.delete=_I;en.prototype.get=gI;en.prototype.has=vI;en.prototype.set=EI;function tn(e){var t=this.__data__=new ut(e);this.size=t.size}function mI(){this.__data__=new ut,this.size=0}function yI(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function TI(e){return this.__data__.get(e)}function SI(e){return this.__data__.has(e)}function AI(e,t){var r=this.__data__;if(r instanceof ut){var n=r.__data__;if(!Mf||n.length<pb-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new en(n)}return r.set(e,t),this.size=r.size,this}tn.prototype.clear=mI;tn.prototype.delete=yI;tn.prototype.get=TI;tn.prototype.has=SI;tn.prototype.set=AI;function bI(e,t){var r=Cu(e),n=!r&&Iu(e),i=!r&&!n&&jf(e),a=!r&&!n&&!i&&Uf(e),s=r||n||i||a,o=s?$b(e.length,String):[],u=o.length;for(var c in e)(t||ot.call(e,c))&&!(s&&(c=="length"||i&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||qf(c,u)))&&o.push(c);return o}function Tu(e,t,r){(r!==void 0&&!us(e[t],r)||r===void 0&&!(t in e))&&Su(e,t,r)}function II(e,t,r){var n=e[t];(!(ot.call(e,t)&&us(n,r))||r===void 0&&!(t in e))&&Su(e,t,r)}function as(e,t){for(var r=e.length;r--;)if(us(e[r][0],t))return r;return-1}function Su(e,t,r){t=="__proto__"&&is?is(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var CI=HI();function ss(e){return e==null?e===void 0?Ob:Sb:ir&&ir in Object(e)?UI(e):zI(e)}function xf(e){return ai(e)&&ss(e)==vf}function OI(e){if(!sr(e)||VI(e))return!1;var t=Pu(e)?Zb:Bb;return t.test(QI(e))}function PI(e){return ai(e)&&Hf(e.length)&&!!L[ss(e)]}function RI(e){if(!sr(e))return $I(e);var t=kf(e),r=[];for(var n in e)n=="constructor"&&(t||!ot.call(e,n))||r.push(n);return r}function Lf(e,t,r,n,i){e!==t&&CI(t,function(a,s){if(i||(i=new tn),sr(a))NI(e,t,s,r,Lf,n,i);else{var o=n?n(bu(e,s),a,s+"",e,t,i):void 0;o===void 0&&(o=a),Tu(e,s,o)}},Bf)}function NI(e,t,r,n,i,a,s){var o=bu(e,r),u=bu(t,r),c=s.get(u);if(c){Tu(e,r,c);return}var p=a?a(o,u,r+"",e,t,s):void 0,d=p===void 0;if(d){var f=Cu(u),_=!f&&jf(u),g=!f&&!_&&Uf(u);p=u,f||_||g?Cu(o)?p=o:WI(o)?p=qI(o):_?(d=!1,p=MI(u,!0)):g?(d=!1,p=LI(u,!0)):p=[]:ZI(u)||Iu(u)?(p=o,Iu(o)?p=JI(o):(!sr(o)||Pu(o))&&(p=BI(u))):d=!1}d&&(s.set(u,p),i(p,u,n,a,s),s.delete(u)),Tu(e,r,p)}function DI(e,t){return YI(KI(e,t,Gf),e+"")}var wI=is?function(e,t){return is(e,"toString",{configurable:!0,enumerable:!1,value:tC(t),writable:!0})}:Gf;function MI(e,t){if(t)return e.slice();var r=e.length,n=Rf?Rf(r):new e.constructor(r);return e.copy(n),n}function xI(e){var t=new e.constructor(e.byteLength);return new Pf(t).set(new Pf(e)),t}function LI(e,t){var r=t?xI(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function qI(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function kI(e,t,r,n){var i=!r;r||(r={});for(var a=-1,s=t.length;++a<s;){var o=t[a],u=n?n(r[o],e[o],o,r,e):void 0;u===void 0&&(u=e[o]),i?Su(r,o,u):II(r,o,u)}return r}function jI(e){return DI(function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(i--,a):void 0,s&&GI(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var o=r[n];o&&e(t,o,n,a)}return t})}function HI(e){return function(t,r,n){for(var i=-1,a=Object(t),s=n(t),o=s.length;o--;){var u=s[e?o:++i];if(r(a[u],u,a)===!1)break}return t}}function os(e,t){var r=e.__data__;return FI(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Au(e,t){var r=Kb(e,t);return OI(r)?r:void 0}function UI(e){var t=ot.call(e,ir),r=e[ir];try{e[ir]=void 0;var n=!0}catch(a){}var i=Cf.call(e);return n&&(t?e[ir]=r:delete e[ir]),i}function BI(e){return typeof e.constructor=="function"&&!kf(e)?nI(Nf(e)):{}}function qf(e,t){var r=typeof e;return t=t??gf,!!t&&(r=="number"||r!="symbol"&&Gb.test(e))&&e>-1&&e%1==0&&e<t}function GI(e,t,r){if(!sr(r))return!1;var n=typeof t;return(n=="number"?Ou(r)&&qf(t,r.length):n=="string"&&t in r)?us(r[t],e):!1}function FI(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function VI(e){return!!If&&If in e}function kf(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||ts;return e===r}function $I(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}function zI(e){return Cf.call(e)}function KI(e,t,r){return t=wf(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=wf(n.length-t,0),s=Array(a);++i<a;)s[i]=n[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=n[i];return o[t]=r(s),Vb(e,this,o)}}function bu(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var YI=XI(wI);function XI(e){var t=0,r=0;return function(){var n=rI(),i=fb-(n-r);if(r=n,i>0){if(++t>=db)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function QI(e){if(e!=null){try{return rs.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function us(e,t){return e===t||e!==e&&t!==t}var Iu=xf(function(){return arguments}())?xf:function(e){return ai(e)&&ot.call(e,"callee")&&!Jb.call(e,"callee")},Cu=Array.isArray;function Ou(e){return e!=null&&Hf(e.length)&&!Pu(e)}function WI(e){return ai(e)&&Ou(e)}var jf=tI||rC;function Pu(e){if(!sr(e))return!1;var t=ss(e);return t==Ef||t==mb||t==_b||t==Ab}function Hf(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=gf}function sr(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ai(e){return e!=null&&typeof e=="object"}function ZI(e){if(!ai(e)||ss(e)!=mf)return!1;var t=Nf(e);if(t===null)return!0;var r=ot.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&rs.call(r)==Wb}var Uf=bf?zb(bf):PI;function JI(e){return kI(e,Bf(e))}function Bf(e){return Ou(e)?bI(e,!0):RI(e)}var eC=jI(function(e,t,r){Lf(e,t,r)});function tC(e){return function(){return e}}function Gf(e){return e}function rC(){return!1}rn.exports=eC});var zf=l(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.BatchSpanProcessorBase=void 0;var Vf=w(),oi=we(),$f=class{constructor(t,r){this._exporter=t,this._finishedSpans=[],this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve();let n=oi.getEnv();this._maxExportBatchSize=typeof(r==null?void 0:r.maxExportBatchSize)=="number"?r.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof(r==null?void 0:r.maxQueueSize)=="number"?r.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof(r==null?void 0:r.scheduledDelayMillis)=="number"?r.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof(r==null?void 0:r.exportTimeoutMillis)=="number"?r.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT}forceFlush(){return this._isShutdown?this._shuttingDownPromise:this._flushAll()}onStart(t){}onEnd(t){this._isShutdown||this._addToBuffer(t)}shutdown(){return this._isShutdown?this._shuttingDownPromise:(this._isShutdown=!0,this._shuttingDownPromise=new Promise((t,r)=>{Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown()).then(t).catch(n=>{r(n)})}),this._shuttingDownPromise)}_addToBuffer(t){this._finishedSpans.length>=this._maxQueueSize||(this._finishedSpans.push(t),this._maybeStartTimer())}_flushAll(){return new Promise((t,r)=>{let n=[],i=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);for(let a=0,s=i;a<s;a++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{t()}).catch(r)})}_flushOneBatch(){return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise((t,r)=>{let n=setTimeout(()=>{r(new Error("Timeout"))},this._exportTimeoutMillis);Vf.context.with(oi.suppressTracing(Vf.context.active()),()=>{this._exporter.export(this._finishedSpans.splice(0,this._maxExportBatchSize),i=>{var a;clearTimeout(n),i.code===oi.ExportResultCode.SUCCESS?t():r((a=i.error)!==null&&a!==void 0?a:new Error("BatchSpanProcessor: span export failed"))})})})}_maybeStartTimer(){this._timer===void 0&&(this._timer=setTimeout(()=>{this._flushOneBatch().then(()=>{this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(t=>{oi.globalErrorHandler(t)})},this._scheduledDelayMillis),oi.unrefTimer(this._timer))}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}};cs.BatchSpanProcessorBase=$f});var Yf=l(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.BatchSpanProcessor=void 0;var nC=zf(),Kf=class extends nC.BatchSpanProcessorBase{onShutdown(){}};ls.BatchSpanProcessor=Kf});var Xf=l(or=>{"use strict";var iC=or&&or.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),aC=or&&or.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&iC(t,e,r)};Object.defineProperty(or,"__esModule",{value:!0});aC(Yf(),or)});var Ru=l(ur=>{"use strict";var sC=ur&&ur.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),oC=ur&&ur.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&sC(t,e,r)};Object.defineProperty(ur,"__esModule",{value:!0});oC(Xf(),ur)});var Wf=l(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.BasicTracerProvider=lr.ForceFlushState=void 0;var nn=w(),ui=we(),Qf=Xa(),uC=Nu(),cC=lu(),lC=ff(),pC=Eu(),dC=Ff(),fC=Ru(),an;(function(e){e[e.resolved=0]="resolved",e[e.timeout=1]="timeout",e[e.error=2]="error",e[e.unresolved=3]="unresolved"})(an=lr.ForceFlushState||(lr.ForceFlushState={}));var cr=class{constructor(t={}){var r;this._registeredSpanProcessors=[],this._tracers=new Map;let n=dC({},cC.DEFAULT_CONFIG,t);this.resource=(r=n.resource)!==null&&r!==void 0?r:Qf.Resource.empty(),this.resource=Qf.Resource.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});let i=this._buildExporterFromEnv();if(i!==void 0){let a=new fC.BatchSpanProcessor(i);this.activeSpanProcessor=a}else this.activeSpanProcessor=new pC.NoopSpanProcessor}getTracer(t,r){let n=`${t}@${r||""}`;return this._tracers.has(n)||this._tracers.set(n,new uC.Tracer({name:t,version:r},this._config,this)),this._tracers.get(n)}addSpanProcessor(t){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(r=>nn.diag.error("Error while trying to shutdown current span processor",r)),this._registeredSpanProcessors.push(t),this.activeSpanProcessor=new lC.MultiSpanProcessor(this._registeredSpanProcessors)}getActiveSpanProcessor(){return this.activeSpanProcessor}register(t={}){nn.trace.setGlobalTracerProvider(this),t.propagator===void 0&&(t.propagator=this._buildPropagatorFromEnv()),t.contextManager&&nn.context.setGlobalContextManager(t.contextManager),t.propagator&&nn.propagation.setGlobalPropagator(t.propagator)}forceFlush(){let t=this._config.forceFlushTimeoutMillis,r=this._registeredSpanProcessors.map(n=>new Promise(i=>{let a,s=setTimeout(()=>{i(new Error(`Span processor did not completed within timeout period of ${t} ms`)),a=an.timeout},t);n.forceFlush().then(()=>{clearTimeout(s),a!==an.timeout&&(a=an.resolved,i(a))}).catch(o=>{clearTimeout(s),a=an.error,i(o)})}));return new Promise((n,i)=>{Promise.all(r).then(a=>{let s=a.filter(o=>o!==an.resolved);s.length>0?i(s):n()}).catch(a=>i([a]))})}shutdown(){return this.activeSpanProcessor.shutdown()}_getPropagator(t){var r;return(r=cr._registeredPropagators.get(t))===null||r===void 0?void 0:r()}_getSpanExporter(t){var r;return(r=cr._registeredExporters.get(t))===null||r===void 0?void 0:r()}_buildPropagatorFromEnv(){let t=Array.from(new Set(ui.getEnv().OTEL_PROPAGATORS)),n=t.map(i=>{let a=this._getPropagator(i);return a||nn.diag.warn(`Propagator "${i}" requested through environment variable is unavailable.`),a}).reduce((i,a)=>(a&&i.push(a),i),[]);if(n.length!==0)return t.length===1?n[0]:new ui.CompositePropagator({propagators:n})}_buildExporterFromEnv(){let t=ui.getEnv().OTEL_TRACES_EXPORTER;if(t==="none")return;let r=this._getSpanExporter(t);return r||nn.diag.error(`Exporter "${t}" requested through environment variable is unavailable.`),r}};lr.BasicTracerProvider=cr;cr._registeredPropagators=new Map([["tracecontext",()=>new ui.HttpTraceContextPropagator],["baggage",()=>new ui.HttpBaggagePropagator]]);cr._registeredExporters=new Map});var Jf=l(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.ConsoleSpanExporter=void 0;var Du=we(),Zf=class{export(t,r){return this._sendSpans(t,r)}shutdown(){return this._sendSpans([]),Promise.resolve()}_exportInfo(t){return{traceId:t.spanContext().traceId,parentId:t.parentSpanId,name:t.name,id:t.spanContext().spanId,kind:t.kind,timestamp:Du.hrTimeToMicroseconds(t.startTime),duration:Du.hrTimeToMicroseconds(t.duration),attributes:t.attributes,status:t.status,events:t.events}}_sendSpans(t,r){for(let n of t)console.log(this._exportInfo(n));if(r)return r({code:Du.ExportResultCode.SUCCESS})}};ps.ConsoleSpanExporter=Zf});var rh=l(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.InMemorySpanExporter=void 0;var eh=we(),th=class{constructor(){this._finishedSpans=[],this._stopped=!1}export(t,r){if(this._stopped)return r({code:eh.ExportResultCode.FAILED,error:new Error("Exporter has been stopped")});this._finishedSpans.push(...t),setTimeout(()=>r({code:eh.ExportResultCode.SUCCESS}),0)}shutdown(){return this._stopped=!0,this._finishedSpans=[],Promise.resolve()}reset(){this._finishedSpans=[]}getFinishedSpans(){return this._finishedSpans}};ds.InMemorySpanExporter=th});var ih=l(nh=>{"use strict";Object.defineProperty(nh,"__esModule",{value:!0})});var oh=l(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.SimpleSpanProcessor=void 0;var ah=w(),wu=we(),sh=class{constructor(t){this._exporter=t,this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve()}forceFlush(){return Promise.resolve()}onStart(t){}onEnd(t){this._isShutdown||ah.context.with(wu.suppressTracing(ah.context.active()),()=>{this._exporter.export([t],r=>{var n;r.code!==wu.ExportResultCode.SUCCESS&&wu.globalErrorHandler((n=r.error)!==null&&n!==void 0?n:new Error(`SimpleSpanProcessor: span export failed (status ${r})`))})})}shutdown(){return this._isShutdown?this._shuttingDownPromise:(this._isShutdown=!0,this._shuttingDownPromise=new Promise((t,r)=>{Promise.resolve().then(()=>this._exporter.shutdown()).then(t).catch(n=>{r(n)})}),this._shuttingDownPromise)}};fs.SimpleSpanProcessor=sh});var ch=l(uh=>{"use strict";Object.defineProperty(uh,"__esModule",{value:!0})});var ph=l(lh=>{"use strict";Object.defineProperty(lh,"__esModule",{value:!0})});var fh=l(dh=>{"use strict";Object.defineProperty(dh,"__esModule",{value:!0})});var _h=l(hh=>{"use strict";Object.defineProperty(hh,"__esModule",{value:!0})});var Nu=l(te=>{"use strict";var hC=te&&te.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),be=te&&te.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&hC(t,e,r)};Object.defineProperty(te,"__esModule",{value:!0});be(Xd(),te);be(Wf(),te);be(Ru(),te);be(Jf(),te);be(rh(),te);be(ih(),te);be(oh(),te);be(ch(),te);be(Eu(),te);be(cu(),te);be(ph(),te);be(fh(),te);be(_h(),te)});var Eh=l(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.enable=Ye.azureCoreTracing=Ye.AzureMonitorSymbol=void 0;var gh=Y();Ye.AzureMonitorSymbol="Azure_Monitor_Tracer";var vh=!1,_C=function(e){if(vh)return e;try{var t=Nu(),r=w(),n=new t.BasicTracerProvider,i=n.getTracer("applicationinsights tracer"),a=e.setTracer;e.setTracer=function(s){var o=s.startSpan;s.startSpan=function(u,c,p){var d=o.call(this,u,c,p),f=d.end;return d.end=function(){var _=f.apply(this,arguments);return gh.channel.publish("azure-coretracing",d),_},d},s[Ye.AzureMonitorSymbol]=!0,a.call(this,s)},r.trace.getSpan(r.context.active()),e.setTracer(i),vh=!0}catch(s){}return e};Ye.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:_C};function gC(){gh.channel.registerMonkeyPatch("@azure/core-tracing",Ye.azureCoreTracing)}Ye.enable=gC});var yh=l(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.enable=pr.bunyan=void 0;var mh=Y(),vC=function(e){var t=e.prototype._emit;return e.prototype._emit=function(r,n){var i=t.apply(this,arguments);if(!n){var a=i;a||(a=t.call(this,r,!0)),mh.channel.publish("bunyan",{level:r.level,result:a})}return i},e};pr.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:vC};function EC(){mh.channel.registerMonkeyPatch("bunyan",pr.bunyan)}pr.enable=EC});var Sh=l(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.enable=dr.console=void 0;var Mu=Y(),Th=require("stream"),mC=function(e){var t=new Th.Writable,r=new Th.Writable;t.write=function(c){if(!c)return!0;var p=c.toString();return Mu.channel.publish("console",{message:p}),!0},r.write=function(c){if(!c)return!0;var p=c.toString();return Mu.channel.publish("console",{message:p,stderr:!0}),!0};for(var n=new e.Console(t,r),i=["log","info","warn","error","dir","time","timeEnd","trace","assert"],a=function(c){var p=e[c];p&&(e[c]=function(){if(n[c])try{n[c].apply(n,arguments)}catch(d){}return p.apply(e,arguments)})},s=0,o=i;s<o.length;s++){var u=o[s];a(u)}return e};dr.console={versionSpecifier:">= 4.0.0",patch:mC};function yC(){Mu.channel.registerMonkeyPatch("console",dr.console),require("console")}dr.enable=yC});var Ah=l(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.enable=fr.mongoCore=void 0;var xu=Y(),TC=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.pool.write;this.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=xu.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var a=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=xu.channel.bindToContext(arguments[1])),a.apply(this,arguments)},n},e};fr.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:TC};function SC(){xu.channel.registerMonkeyPatch("mongodb-core",fr.mongoCore)}fr.enable=SC});var bh=l(ve=>{"use strict";var sn=ve&&ve.__assign||function(){return sn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},sn.apply(this,arguments)};Object.defineProperty(ve,"__esModule",{value:!0});ve.enable=ve.mongo330=ve.mongo3=ve.mongo2=void 0;var fe=Y(),AC=function(e){var t=e.instrument({operationIdGenerator:{next:function(){return fe.channel.bindToContext(function(n){return n()})}}}),r={};return t.on("started",function(n){r[n.requestId]||(r[n.requestId]=sn(sn({},n),{time:new Date}))}),t.on("succeeded",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return fe.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}):fe.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}),t.on("failed",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return fe.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}):fe.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}),e},bC=function(e){var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=fe.channel.bindToContext(function(a){return a()}),r[i.requestId]=sn(sn({},i),{time:new Date}))}),t.on("succeeded",function(i){var a=r[i.requestId];a&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return fe.channel.publish("mongodb",{startedData:a,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var a=r[i.requestId];a&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return fe.channel.publish("mongodb",{startedData:a,event:i,succeeded:!1})}),delete n[i.requestId])}),e},IC=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=fe.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var a=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=fe.channel.bindToContext(arguments[1])),a.apply(this,arguments)},n},e},CC=function(e){IC(e);var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=fe.channel.bindToContext(function(a){return a()}),r[i.requestId]=i)}),t.on("succeeded",function(i){var a=r[i.requestId];a&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return fe.channel.publish("mongodb",{startedData:a,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var a=r[i.requestId];a&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return fe.channel.publish("mongodb",{startedData:a,event:i,succeeded:!1})}),delete n[i.requestId])}),e};ve.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:AC};ve.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:bC};ve.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:CC};function OC(){fe.channel.registerMonkeyPatch("mongodb",ve.mongo2),fe.channel.registerMonkeyPatch("mongodb",ve.mongo3),fe.channel.registerMonkeyPatch("mongodb",ve.mongo330)}ve.enable=OC});var Ch=l(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.enable=hr.mysql=void 0;var hs=Y(),Ih=require("path"),PC=function(e,t){var r=function(u,c){return function(p,d){var f=u[p];f&&(u[p]=function(){for(var g=arguments.length-1,y=arguments.length-1;y>=0;--y)if(typeof arguments[y]=="function"){g=y;break}else if(typeof arguments[y]!="undefined")break;var R=arguments[g],K={result:null,startTime:null,startDate:null};typeof R=="function"&&(d?(K.startTime=process.hrtime(),K.startDate=new Date,arguments[g]=hs.channel.bindToContext(d(K,R))):arguments[g]=hs.channel.bindToContext(R));var le=f.apply(this,arguments);return K.result=le,le})}},n=function(u,c){return r(u.prototype,c+".prototype")},i=["connect","changeUser","ping","statistics","end"],a=require(Ih.dirname(t)+"/lib/Connection");i.forEach(function(u){return n(a,"Connection")(u)}),r(a,"Connection")("createQuery",function(u,c){return function(p){var d=process.hrtime(u.startTime),f=d[0]*1e3+d[1]/1e6|0;hs.channel.publish("mysql",{query:u.result,callbackArgs:arguments,err:p,duration:f,time:u.startDate}),c.apply(this,arguments)}});var s=["_enqueueCallback"],o=require(Ih.dirname(t)+"/lib/Pool");return s.forEach(function(u){return n(o,"Pool")(u)}),e};hr.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:PC};function RC(){hs.channel.registerMonkeyPatch("mysql",hr.mysql)}hr.enable=RC});var Ph=l(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});_r.enable=_r.postgresPool1=void 0;var Oh=Y();function NC(e){var t=e.prototype.connect;return e.prototype.connect=function(n){return n&&(arguments[0]=Oh.channel.bindToContext(n)),t.apply(this,arguments)},e}_r.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:NC};function DC(){Oh.channel.registerMonkeyPatch("pg-pool",_r.postgresPool1)}_r.enable=DC});var Nh=l(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.enable=Xe.postgres7=Xe.postgres6=void 0;var on=Y(),Rh=require("events");function wC(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(a,s,o){var u={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},c=process.hrtime(),p;function d(f){f&&f[n]&&(f=f[n]);var _=on.channel.bindToContext(function(g,y){var R=process.hrtime(c);if(u.result=y&&{rowCount:y.rowCount,command:y.command},u.error=g,u.duration=Math.ceil(R[0]*1e3+R[1]/1e6),on.channel.publish("postgres",u),g){if(f)return f.apply(this,arguments);p&&p instanceof Rh.EventEmitter&&p.emit("error",g)}else f&&f.apply(this,arguments)});try{return Object.defineProperty(_,n,{value:f}),_}catch(g){return f}}try{typeof a=="string"?s instanceof Array?(u.query.preparable={text:a,args:s},o=d(o)):(u.query.text=a,o?o=d(o):s=d(s)):(typeof a.name=="string"?u.query.plan=a.name:a.values instanceof Array?u.query.preparable={text:a.text,args:a.values}:u.query.text=a.text,o?o=d(o):s?s=d(s):a.callback=d(a.callback))}catch(f){return r.apply(this,arguments)}return arguments[0]=a,arguments[1]=s,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,p=r.apply(this,arguments),p},e}function MC(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(a,s,o){var u=this,c=!!o,p={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},d=process.hrtime(),f;function _(g){g&&g[n]&&(g=g[n]);var y=on.channel.bindToContext(function(R,K){var le=process.hrtime(d);if(p.result=K&&{rowCount:K.rowCount,command:K.command},p.error=R,p.duration=Math.ceil(le[0]*1e3+le[1]/1e6),on.channel.publish("postgres",p),R){if(g)return g.apply(this,arguments);f&&f instanceof Rh.EventEmitter&&f.emit("error",R)}else g&&g.apply(this,arguments)});try{return Object.defineProperty(y,n,{value:g}),y}catch(R){return g}}try{typeof a=="string"?s instanceof Array?(p.query.preparable={text:a,args:s},c=typeof o=="function",o=c?_(o):o):(p.query.text=a,o?(c=typeof o=="function",o=c?_(o):o):(c=typeof s=="function",s=c?_(s):s)):(typeof a.name=="string"?p.query.plan=a.name:a.values instanceof Array?p.query.preparable={text:a.text,args:a.values}:p.query.text=a.text,o?(c=typeof o=="function",o=_(o)):s?(c=typeof s=="function",s=c?_(s):s):(c=typeof a.callback=="function",a.callback=c?_(a.callback):a.callback))}catch(g){return r.apply(this,arguments)}return arguments[0]=a,arguments[1]=s,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,f=r.apply(this,arguments),c?f:f.then(function(g){return _()(void 0,g),new u._Promise(function(y,R){y(g)})}).catch(function(g){return _()(g,void 0),new u._Promise(function(y,R){R(g)})})},e}Xe.postgres6={versionSpecifier:"6.*",patch:wC};Xe.postgres7={versionSpecifier:">=7.* <=8.*",patch:MC};function xC(){on.channel.registerMonkeyPatch("pg",Xe.postgres6),on.channel.registerMonkeyPatch("pg",Xe.postgres7)}Xe.enable=xC});var Dh=l(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.enable=gr.redis=void 0;var Lu=Y(),LC=function(e){var t=e.RedisClient.prototype.internal_send_command;return e.RedisClient.prototype.internal_send_command=function(r){if(r){var n=r.callback;if(!n||!n.pubsubBound){var i=this.address,a=process.hrtime(),s=new Date;r.callback=Lu.channel.bindToContext(function(o,u){var c=process.hrtime(a),p=c[0]*1e3+c[1]/1e6|0;Lu.channel.publish("redis",{duration:p,address:i,commandObj:r,err:o,result:u,time:s}),typeof n=="function"&&n.apply(this,arguments)}),r.callback.pubsubBound=!0}}return t.call(this,r)},e};gr.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:LC};function qC(){Lu.channel.registerMonkeyPatch("redis",gr.redis)}gr.enable=qC});var wh=l(ct=>{"use strict";var _s=ct&&ct.__assign||function(){return _s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},_s.apply(this,arguments)};Object.defineProperty(ct,"__esModule",{value:!0});ct.enable=ct.tedious=void 0;var qu=Y(),kC=function(e){var t=e.Connection.prototype.makeRequest;return e.Connection.prototype.makeRequest=function(){function n(a){var s=process.hrtime(),o={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return qu.channel.bindToContext(function(u,c,p){var d=process.hrtime(s);o=_s(_s({},o),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!u&&{rowCount:c,rows:p},query:{text:this.parametersByName.statement.value},error:u,duration:Math.ceil(d[0]*1e3+d[1]/1e6)}),qu.channel.publish("tedious",o),a.call(this,u,c,p)})}var i=arguments[0];arguments[0].callback=n(i.callback),t.apply(this,arguments)},e};ct.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:kC};function jC(){qu.channel.registerMonkeyPatch("tedious",ct.tedious)}ct.enable=jC});var Mh=l(ye=>{"use strict";var HC=ye&&ye.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),UC=ye&&ye.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};Object.defineProperty(ye,"__esModule",{value:!0});ye.enable=ye.winston2=ye.winston3=void 0;var gs=Y(),BC=function(e){var t=e.Logger.prototype.log,r,n=function(i,a,s){var o;return r===e.config.npm.levels?o="npm":r===e.config.syslog.levels?o="syslog":o="unknown",gs.channel.publish("winston",{level:i,message:a,meta:s,levelKind:o}),a};return e.Logger.prototype.log=function(){return r=this.levels,!this.filters||this.filters.length===0?this.filters=[n]:this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter(function(a){return a!==n}),this.filters.push(n)),t.apply(this,arguments)},e},GC=function(e){var t=function(s,o){var u;return s.config.npm.levels[o]!=null?u="npm":s.config.syslog.levels[o]!=null?u="syslog":u="unknown",u},r=function(s){HC(o,s);function o(u,c){var p=s.call(this,c)||this;return p.winston=u,p}return o.prototype.log=function(u,c){var p=u.message,d=u.level,f=u.meta,_=UC(u,["message","level","meta"]);d=typeof Symbol.for=="function"?u[Symbol.for("level")]:d,p=u instanceof Error?u:p;var g=t(this.winston,d);f=f||{};for(var y in _)_.hasOwnProperty(y)&&(f[y]=_[y]);gs.channel.publish("winston",{message:p,level:d,levelKind:g,meta:f}),c()},o}(e.Transport);function n(){var s=arguments[0].levels||e.config.npm.levels,o;for(var u in s)s.hasOwnProperty(u)&&(o=o===void 0||s[u]>s[o]?u:o);this.add(new r(e,{level:o}))}var i=e.createLogger;e.createLogger=function(){var o=arguments[0].levels||e.config.npm.levels,u;for(var c in o)o.hasOwnProperty(c)&&(u=u===void 0||o[c]>o[u]?c:u);var p=i.apply(this,arguments);p.add(new r(e,{level:u}));var d=p.configure;return p.configure=function(){d.apply(this,arguments),n.apply(this,arguments)},p};var a=e.configure;return e.configure=function(){a.apply(this,arguments),n.apply(this,arguments)},e.add(new r(e)),e};ye.winston3={versionSpecifier:"3.x",patch:GC};ye.winston2={versionSpecifier:"2.x",patch:BC};function FC(){gs.channel.registerMonkeyPatch("winston",ye.winston2),gs.channel.registerMonkeyPatch("winston",ye.winston3)}ye.enable=FC});var $h=l(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.enable=x.tedious=x.pgPool=x.pg=x.winston=x.redis=x.mysql=x.mongodb=x.mongodbCore=x.console=x.bunyan=x.azuresdk=void 0;var xh=Eh();x.azuresdk=xh;var Lh=yh();x.bunyan=Lh;var qh=Sh();x.console=qh;var kh=Ah();x.mongodbCore=kh;var jh=bh();x.mongodb=jh;var Hh=Ch();x.mysql=Hh;var Uh=Ph();x.pgPool=Uh;var Bh=Nh();x.pg=Bh;var Gh=Dh();x.redis=Gh;var Fh=wh();x.tedious=Fh;var Vh=Mh();x.winston=Vh;function VC(){Lh.enable(),qh.enable(),kh.enable(),jh.enable(),Hh.enable(),Bh.enable(),Uh.enable(),Gh.enable(),Vh.enable(),xh.enable(),Fh.enable()}x.enable=VC});var ms=l(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.registerContextPreservation=Dt.IsInitialized=void 0;var $C=io(),ku=ne();Dt.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var ju="DiagnosticChannel";if(Dt.IsInitialized){Be=$h(),zh=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",vs=zh.split(","),Hu={bunyan:Be.bunyan,console:Be.console,mongodb:Be.mongodb,mongodbCore:Be.mongodbCore,mysql:Be.mysql,redis:Be.redis,pg:Be.pg,pgPool:Be.pgPool,winston:Be.winston,azuresdk:Be.azuresdk};for(Es in Hu)vs.indexOf(Es)===-1&&(Hu[Es].enable(),ku.info(ju,"Subscribed to "+Es+" events"));vs.length>0&&ku.info(ju,"Some modules will not be patched",vs)}else ku.info(ju,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var Be,zh,vs,Hu,Es;function zC(e){if(!!Dt.IsInitialized){var t=Y();t.channel.addContextPreservation(e),t.channel.spanContextPropagator=$C.AsyncScopeManager}}Dt.registerContextPreservation=zC});var un=l((mw,Kh)=>{"use strict";Kh.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var Ie=l((Bu,Xh)=>{"use strict";var wt=Bu&&Bu.__assign||function(){return wt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},wt.apply(this,arguments)},KC=require("http"),Yh=require("https"),Uu=require("url"),ys=require("constants"),ci=ne(),cn=un(),YC=function(){function e(){}return e.getCookie=function(t,r){var n="";if(t&&t.length&&typeof r=="string")for(var i=t+"=",a=r.split(";"),s=0;s<a.length;s++){var r=a[s];if(r=e.trim(r),r&&r.indexOf(i)===0){n=r.substring(i.length,a[s].length);break}}return n},e.trim=function(t){return typeof t=="string"?t.replace(/^\s+|\s+$/g,""):""},e.int32ArrayToBase64=function(t){var r=function(o,u){return String.fromCharCode(o>>u&255)},n=function(o){return r(o,24)+r(o,16)+r(o,8)+r(o,0)},i=t.map(n).join(""),a=Buffer.from?Buffer.from(i,"binary"):new Buffer(i,"binary"),s=a.toString("base64");return s.substr(0,s.indexOf("="))},e.random32=function(){return 4294967296*Math.random()|0},e.randomu32=function(){return e.random32()+2147483648},e.w3cTraceId=function(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n,i=0;i<4;i++)n=e.random32(),r+=t[n&15]+t[n>>4&15]+t[n>>8&15]+t[n>>12&15]+t[n>>16&15]+t[n>>20&15]+t[n>>24&15]+t[n>>28&15];var a=t[8+Math.random()*4|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+a+r.substr(16,3)+r.substr(19,12)},e.w3cSpanId=function(){return e.w3cTraceId().substring(16)},e.isValidW3CId=function(t){return t.length===32&&t!=="00000000000000000000000000000000"},e.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"},e.isError=function(t){return t instanceof Error},e.isPrimitive=function(t){var r=typeof t;return r==="string"||r==="number"||r==="boolean"},e.isDate=function(t){return Object.prototype.toString.call(t)==="[object Date]"},e.msToTimeSpan=function(t){(isNaN(t)||t<0)&&(t=0);var r=(t/1e3%60).toFixed(7).replace(/0{0,4}$/,""),n=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,a=Math.floor(t/(1e3*60*60*24));r=r.indexOf(".")<2?"0"+r:r,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i;var s=a>0?a+".":"";return s+i+":"+n+":"+r},e.extractError=function(t){var r=t;return{message:t.message,code:r.code||r.id||""}},e.extractObject=function(t){return t instanceof Error?e.extractError(t):typeof t.toJSON=="function"?t.toJSON():t},e.validateStringMap=function(t){if(typeof t!="object"){ci.info("Invalid properties dropped from payload");return}var r={};for(var n in t){var i="",a=t[n],s=typeof a;if(e.isPrimitive(a))i=a.toString();else if(a===null||s==="undefined")i="";else if(s==="function"){ci.info("key: "+n+" was function; will not serialize");continue}else{var o=e.isArray(a)?a:e.extractObject(a);try{e.isPrimitive(o)?i=o:i=JSON.stringify(o)}catch(u){i=a.constructor.name.toString()+" (Error: "+u.message+")",ci.info("key: "+n+", could not be serialized")}}r[n]=i.substring(0,e.MAX_PROPERTY_LENGTH)}return r},e.canIncludeCorrelationHeader=function(t,r){var n=t&&t.config&&t.config.correlationHeaderExcludedDomains;if(!n||n.length==0||!r)return!0;for(var i=0;i<n.length;i++){var a=new RegExp(n[i].replace(/\./g,".").replace(/\*/g,".*"));if(a.test(Uu.parse(r).hostname))return!1}return!0},e.getCorrelationContextTarget=function(t,r){var n=t.headers&&t.headers[cn.requestContextHeader];if(n)for(var i=n.split(","),a=0;a<i.length;++a){var s=i[a].split("=");if(s.length==2&&s[0]==r)return s[1]}},e.makeRequest=function(t,r,n,i){r&&r.indexOf("//")===0&&(r="https:"+r);var a=Uu.parse(r),s=wt(wt({},n),{host:a.hostname,port:a.port,path:a.pathname}),o=void 0;if(a.protocol==="https:"&&(o=t.proxyHttpsUrl||void 0),a.protocol==="http:"&&(o=t.proxyHttpUrl||void 0),o){o.indexOf("//")===0&&(o="http:"+o);var u=Uu.parse(o);u.protocol==="https:"?(ci.info("Proxies that use HTTPS are not supported"),o=void 0):s=wt(wt({},s),{host:u.hostname,port:u.port||"80",path:r,headers:wt(wt({},s.headers),{Host:a.hostname})})}var c=a.protocol==="https:"&&!o;return c&&t.httpsAgent!==void 0?s.agent=t.httpsAgent:!c&&t.httpAgent!==void 0?s.agent=t.httpAgent:c&&(s.agent=e.tlsRestrictedAgent),c?Yh.request(s,i):KC.request(s,i)},e.safeIncludeCorrelationHeader=function(t,r,n){var i;if(typeof n=="string")i=n;else if(n instanceof Array)i=n.join(",");else if(n&&typeof n.toString=="function")try{i=n.toString()}catch(a){ci.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",a,n)}i?e.addCorrelationIdHeaderFromString(t,r,i):r.setHeader(cn.requestContextHeader,cn.requestContextSourceKey+"="+t.config.correlationId)},e.dumpObj=function(t){var r=Object.prototype.toString.call(t),n="";return r==="[object Error]"?n="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t.name+"'":n=JSON.stringify(t),r+n},e.addCorrelationIdHeaderFromString=function(t,r,n){var i=n.split(","),a=cn.requestContextSourceKey+"=",s=i.some(function(o){return o.substring(0,a.length)===a});s||r.setHeader(cn.requestContextHeader,n+","+cn.requestContextSourceKey+"="+t.config.correlationId)},e.MAX_PROPERTY_LENGTH=8192,e.tlsRestrictedAgent=new Yh.Agent({keepAlive:!0,maxSockets:25,secureOptions:ys.SSL_OP_NO_SSLv2|ys.SSL_OP_NO_SSLv3|ys.SSL_OP_NO_TLSv1|ys.SSL_OP_NO_TLSv1_1}),e}();Xh.exports=YC});var vr=l((yw,Qh)=>{"use strict";var Ts=Ie(),Gu=ne(),XC=function(){function e(){}return e.queryCorrelationId=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId";if(e.completedLookups.hasOwnProperty(n)){r(e.completedLookups[n]);return}else if(e.pendingLookups[n]){e.pendingLookups[n].push(r);return}e.pendingLookups[n]=[r];var i=function(){if(!!e.pendingLookups[n]){var a={method:"GET",disableAppInsightsAutoCollection:!0};Gu.info(e.TAG,a);var s=Ts.makeRequest(t,n,a,function(o){if(o.statusCode===200){var u="";o.setEncoding("utf-8"),o.on("data",function(c){u+=c}),o.on("end",function(){Gu.info(e.TAG,u);var c=e.correlationIdPrefix+u;e.completedLookups[n]=c,e.pendingLookups[n]&&e.pendingLookups[n].forEach(function(p){return p(c)}),delete e.pendingLookups[n]})}else o.statusCode>=400&&o.statusCode<500?(e.completedLookups[n]=void 0,delete e.pendingLookups[n]):setTimeout(i,t.correlationIdRetryIntervalMs)});s&&(s.on("error",function(o){Gu.warn(e.TAG,o)}),s.end())}};setTimeout(i,0)},e.cancelCorrelationIdQuery=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId",i=e.pendingLookups[n];i&&(e.pendingLookups[n]=i.filter(function(a){return a!=r}),e.pendingLookups[n].length==0&&delete e.pendingLookups[n])},e.generateRequestId=function(t){if(t){t=t[0]=="|"?t:"|"+t,t[t.length-1]!=="."&&(t+=".");var r=(e.currentRootId++).toString(16);return e.appendSuffix(t,r,"_")}else return e.generateRootId()},e.getRootId=function(t){var r=t.indexOf(".");r<0&&(r=t.length);var n=t[0]==="|"?1:0;return t.substring(n,r)},e.generateRootId=function(){return"|"+Ts.w3cTraceId()+"."},e.appendSuffix=function(t,r,n){if(t.length+r.length<e.requestIdMaxLength)return t+r+n;var i=e.requestIdMaxLength-9;if(t.length>i)for(;i>1;--i){var a=t[i-1];if(a==="."||a==="_")break}if(i<=1)return e.generateRootId();for(r=Ts.randomu32().toString(16);r.length<8;)r="0"+r;return t.substring(0,i)+r+"#"},e.TAG="CorrelationIdManager",e.correlationIdPrefix="cid-v1:",e.w3cEnabled=!0,e.pendingLookups={},e.completedLookups={},e.requestIdMaxLength=1024,e.currentRootId=Ts.randomu32(),e}();Qh.exports=XC});var li=l((Tw,Wh)=>{"use strict";var oe=Ie(),QC=vr(),WC=function(){function e(t,r){if(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&typeof t=="string")if(t.split(",").length>1)this.traceId=oe.w3cTraceId(),this.spanId=oe.w3cTraceId().substr(0,16);else{var n=t.trim().split("-"),i=n.length;i>=4?(this.version=n[0],this.traceId=n[1],this.spanId=n[2],this.traceFlag=n[3]):(this.traceId=oe.w3cTraceId(),this.spanId=oe.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=e.DEFAULT_VERSION,this.traceId=oe.w3cTraceId()),this.version==="00"&&i!==4&&(this.traceId=oe.w3cTraceId(),this.spanId=oe.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=e.DEFAULT_VERSION,this.traceId=oe.w3cTraceId(),this.spanId=oe.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=e.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.traceId=oe.w3cTraceId()),e.isValidTraceId(this.traceId)||(this.traceId=oe.w3cTraceId()),e.isValidSpanId(this.spanId)||(this.spanId=oe.w3cTraceId().substr(0,16),this.traceId=oe.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var a=QC.getRootId(r);e.isValidTraceId(a)||(this.legacyRootId=a,a=oe.w3cTraceId()),r.indexOf("|")!==-1&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=a,this.spanId=r}else this.traceId=oe.w3cTraceId(),this.spanId=oe.w3cTraceId().substr(0,16)}return e.isValidTraceId=function(t){return t.match(/^[0-9a-f]{32}$/)&&t!=="00000000000000000000000000000000"},e.isValidSpanId=function(t){return t.match(/^[0-9a-f]{16}$/)&&t!=="0000000000000000"},e.formatOpenTelemetryTraceFlags=function(t){var r="0"+t.toString(16);return r.substring(r.length-2)},e.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.prototype.updateSpanId=function(){this.spanId=oe.w3cTraceId().substr(0,16)},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}();Wh.exports=WC});var Fu=l((Sw,Zh)=>{"use strict";var ZC=function(){function e(t){this.fieldmap=[],!!t&&(this.fieldmap=this.parseHeader(t))}return e.prototype.toString=function(){var t=this.fieldmap;return!t||t.length==0?null:t.join(", ")},e.validateKeyChars=function(t){var r=t.split("@");if(r.length==2){var n=r[0].trim(),i=r[1].trim(),a=Boolean(n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),s=Boolean(i.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return a&&s}else if(r.length==1)return Boolean(t.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},e.prototype.parseHeader=function(t){var r=[],n={},i=t.split(",");if(i.length>32)return null;for(var a=0,s=i;a<s.length;a++){var o=s[a],u=o.trim();if(u.length!==0){var c=u.split("=");if(c.length!==2||!e.validateKeyChars(c[0])||n[c[0]])return null;n[c[0]]=!0,r.push(u)}}return r},e.strict=!0,e}();Zh.exports=ZC});var lt=l((Aw,Jh)=>{"use strict";var JC=function(){function e(){}return e}();Jh.exports=JC});var t_=l((Vu,e_)=>{"use strict";var eO=Vu&&Vu.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),tO=lt(),rO=function(e){eO(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(tO);e_.exports=rO});var $u=l((bw,r_)=>{"use strict";var nO=function(){function e(){}return e}();r_.exports=nO});var i_=l((Iw,n_)=>{"use strict";var iO=function(){function e(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return e}();n_.exports=iO});var s_=l((zu,a_)=>{"use strict";var aO=zu&&zu.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),sO=$u(),oO=function(e){aO(t,e);function t(){return e.call(this)||this}return t}(sO);a_.exports=oO});var Yu=l((Cw,o_)=>{"use strict";var Ku;(function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"})(Ku||(Ku={}));o_.exports=Ku});var c_=l((Ow,u_)=>{"use strict";var uO=Yu(),cO=function(){function e(){this.kind=uO.Measurement}return e}();u_.exports=cO});var p_=l((Pw,l_)=>{"use strict";var lO=function(){function e(){this.ver=1,this.sampleRate=100,this.tags={}}return e}();l_.exports=lO});var Qu=l((Xu,d_)=>{"use strict";var pO=Xu&&Xu.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),dO=lt(),fO=function(e){pO(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(dO);d_.exports=fO});var h_=l((Wu,f_)=>{"use strict";var hO=Wu&&Wu.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_O=lt(),gO=function(e){hO(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.exceptions=[],r.properties={},r.measurements={},r}return t}(_O);f_.exports=gO});var g_=l((Rw,__)=>{"use strict";var vO=function(){function e(){this.hasFullStack=!0,this.parsedStack=[]}return e}();__.exports=vO});var E_=l((Zu,v_)=>{"use strict";var EO=Zu&&Zu.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),mO=lt(),yO=function(e){EO(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r}return t}(mO);v_.exports=yO});var y_=l((Ju,m_)=>{"use strict";var TO=Ju&&Ju.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),SO=lt(),AO=function(e){TO(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.metrics=[],r.properties={},r}return t}(SO);m_.exports=AO});var S_=l((ec,T_)=>{"use strict";var bO=ec&&ec.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),IO=Qu(),CO=function(e){bO(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(IO);T_.exports=CO});var b_=l((tc,A_)=>{"use strict";var OO=tc&&tc.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),PO=lt(),RO=function(e){OO(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.success=!0,r.properties={},r.measurements={},r}return t}(PO);A_.exports=RO});var C_=l((rc,I_)=>{"use strict";var NO=rc&&rc.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),DO=lt(),wO=function(e){NO(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(DO);I_.exports=wO});var P_=l((Nw,O_)=>{"use strict";var nc;(function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"})(nc||(nc={}));O_.exports=nc});var N_=l((Dw,R_)=>{"use strict";var MO=function(){function e(){}return e}();R_.exports=MO});var ic=l(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.AvailabilityData=t_();J.Base=$u();J.ContextTagKeys=i_();J.Data=s_();J.DataPoint=c_();J.DataPointType=Yu();J.Domain=lt();J.Envelope=p_();J.EventData=Qu();J.ExceptionData=h_();J.ExceptionDetails=g_();J.MessageData=E_();J.MetricData=y_();J.PageViewData=S_();J.RemoteDependencyData=b_();J.RequestData=C_();J.SeverityLevel=P_();J.StackFrame=N_()});var D_=l(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.domainSupportsProperties=ln.RemoteDependencyDataConstants=void 0;var Er=ic(),xO=function(){function e(){}return e.TYPE_HTTP="Http",e.TYPE_AI="Http (tracked component)",e}();ln.RemoteDependencyDataConstants=xO;function LO(e){return"properties"in e||e instanceof Er.EventData||e instanceof Er.ExceptionData||e instanceof Er.MessageData||e instanceof Er.MetricData||e instanceof Er.PageViewData||e instanceof Er.RemoteDependencyData||e instanceof Er.RequestData}ln.domainSupportsProperties=LO});var M_=l(w_=>{"use strict";Object.defineProperty(w_,"__esModule",{value:!0})});var L_=l(x_=>{"use strict";Object.defineProperty(x_,"__esModule",{value:!0})});var k_=l(q_=>{"use strict";Object.defineProperty(q_,"__esModule",{value:!0})});var H_=l(j_=>{"use strict";Object.defineProperty(j_,"__esModule",{value:!0})});var B_=l(U_=>{"use strict";Object.defineProperty(U_,"__esModule",{value:!0})});var F_=l(G_=>{"use strict";Object.defineProperty(G_,"__esModule",{value:!0})});var $_=l(V_=>{"use strict";Object.defineProperty(V_,"__esModule",{value:!0})});var K_=l(z_=>{"use strict";Object.defineProperty(z_,"__esModule",{value:!0})});var X_=l(Y_=>{"use strict";Object.defineProperty(Y_,"__esModule",{value:!0})});var W_=l(Q_=>{"use strict";Object.defineProperty(Q_,"__esModule",{value:!0})});var J_=l(Z_=>{"use strict";Object.defineProperty(Z_,"__esModule",{value:!0})});var tg=l(eg=>{"use strict";Object.defineProperty(eg,"__esModule",{value:!0})});var rg=l(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.TelemetryType=Ge.TelemetryTypeString=Ge.baseTypeToTelemetryType=Ge.telemetryTypeToBaseType=void 0;function qO(e){switch(e){case ue.Event:return"EventData";case ue.Exception:return"ExceptionData";case ue.Trace:return"MessageData";case ue.Metric:return"MetricData";case ue.Request:return"RequestData";case ue.Dependency:return"RemoteDependencyData";case ue.Availability:return"AvailabilityData";case ue.PageView:return"PageViewData"}}Ge.telemetryTypeToBaseType=qO;function kO(e){switch(e){case"EventData":return ue.Event;case"ExceptionData":return ue.Exception;case"MessageData":return ue.Trace;case"MetricData":return ue.Metric;case"RequestData":return ue.Request;case"RemoteDependencyData":return ue.Dependency;case"AvailabilityData":return ue.Availability;case"PageViewData":return ue.PageView}}Ge.baseTypeToTelemetryType=kO;Ge.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var ue;(function(e){e[e.Event=0]="Event",e[e.Exception=1]="Exception",e[e.Trace=2]="Trace",e[e.Metric=3]="Metric",e[e.Request=4]="Request",e[e.Dependency=5]="Dependency",e[e.Availability=6]="Availability",e[e.PageView=7]="PageView"})(ue=Ge.TelemetryType||(Ge.TelemetryType={}))});var ng=l(re=>{"use strict";var jO=re&&re.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ce=re&&re.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&jO(t,e,r)};Object.defineProperty(re,"__esModule",{value:!0});Ce(M_(),re);Ce(L_(),re);Ce(k_(),re);Ce(H_(),re);Ce(B_(),re);Ce(F_(),re);Ce($_(),re);Ce(K_(),re);Ce(X_(),re);Ce(W_(),re);Ce(J_(),re);Ce(tg(),re);Ce(rg(),re)});var ag=l(ig=>{"use strict";Object.defineProperty(ig,"__esModule",{value:!0})});var og=l(sg=>{"use strict";Object.defineProperty(sg,"__esModule",{value:!0})});var cg=l(ug=>{"use strict";Object.defineProperty(ug,"__esModule",{value:!0})});var pg=l(lg=>{"use strict";Object.defineProperty(lg,"__esModule",{value:!0})});var fg=l(dg=>{"use strict";Object.defineProperty(dg,"__esModule",{value:!0})});var _g=l(hg=>{"use strict";Object.defineProperty(hg,"__esModule",{value:!0})});var vg=l(gg=>{"use strict";Object.defineProperty(gg,"__esModule",{value:!0})});var mg=l(Eg=>{"use strict";Object.defineProperty(Eg,"__esModule",{value:!0})});var yg=l(Te=>{"use strict";var HO=Te&&Te.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Mt=Te&&Te.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&HO(t,e,r)};Object.defineProperty(Te,"__esModule",{value:!0});Mt(ag(),Te);Mt(og(),Te);Mt(cg(),Te);Mt(pg(),Te);Mt(fg(),Te);Mt(_g(),Te);Mt(vg(),Te);Mt(mg(),Te)});var Ee=l(Qe=>{"use strict";var UO=Qe&&Qe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ss=Qe&&Qe.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&UO(t,e,r)};Object.defineProperty(Qe,"__esModule",{value:!0});Ss(D_(),Qe);Ss(ic(),Qe);Ss(ng(),Qe);Ss(yg(),Qe)});var ac=l((iM,Tg)=>{"use strict";var BO=function(){function e(){}return e.prototype.getUrl=function(){return this.url},e.prototype.RequestParser=function(){this.startTime=+new Date},e.prototype._setStatus=function(t,r){var n=+new Date;this.duration=n-this.startTime,this.statusCode=t;var i=this.properties||{};if(r){if(typeof r=="string")i.error=r;else if(r instanceof Error)i.error=r.message;else if(typeof r=="object")for(var a in r)i[a]=r[a]&&r[a].toString&&r[a].toString()}this.properties=i},e.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},e}();Tg.exports=BO});var uc=l((oc,Ag)=>{"use strict";var GO=oc&&oc.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),As=require("url"),FO=Ee(),Sg=Ie(),Oe=un(),VO=ac(),xt=vr(),$O=Fu(),sc=li(),zO=function(e){GO(t,e);function t(r,n){var i=e.call(this)||this;return r&&(i.method=r.method,i.url=i._getAbsoluteUrl(r),i.startTime=+new Date,i.socketRemoteAddress=r.socket&&r.socket.remoteAddress,i.parseHeaders(r,n),r.connection&&(i.connectionRemoteAddress=r.connection.remoteAddress,i.legacySocketRemoteAddress=r.connection.socket&&r.connection.socket.remoteAddress)),i}return t.prototype.onError=function(r,n){this._setStatus(void 0,r),n&&(this.duration=n)},t.prototype.onResponse=function(r,n){this._setStatus(r.statusCode,void 0),n&&(this.duration=n)},t.prototype.getRequestTelemetry=function(r){var n={id:this.requestId,name:this.method+" "+As.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(r&&r.time?n.time=r.time:this.startTime&&(n.time=new Date(this.startTime)),r){for(var i in r)n[i]||(n[i]=r[i]);if(r.properties)for(var i in r.properties)n.properties[i]=r.properties[i]}return n},t.prototype.getRequestTags=function(r){var n={};for(var i in r)n[i]=r[i];return n[t.keys.locationIp]=r[t.keys.locationIp]||this._getIp(),n[t.keys.sessionId]=r[t.keys.sessionId]||this._getId("ai_session"),n[t.keys.userId]=r[t.keys.userId]||this._getId("ai_user"),n[t.keys.userAuthUserId]=r[t.keys.userAuthUserId]||this._getId("ai_authUser"),n[t.keys.operationName]=this.getOperationName(r),n[t.keys.operationParentId]=this.getOperationParentId(r),n[t.keys.operationId]=this.getOperationId(r),n},t.prototype.getOperationId=function(r){return r[t.keys.operationId]||this.operationId},t.prototype.getOperationParentId=function(r){return r[t.keys.operationParentId]||this.parentId||this.getOperationId(r)},t.prototype.getOperationName=function(r){return r[t.keys.operationName]||this.method+" "+As.parse(this.url).pathname},t.prototype.getRequestId=function(){return this.requestId},t.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},t.prototype.getTraceparent=function(){return this.traceparent},t.prototype.getTracestate=function(){return this.tracestate},t.prototype.getLegacyRootId=function(){return this.legacyRootId},t.prototype._getAbsoluteUrl=function(r){if(!r.headers)return r.url;var n=r.connection?r.connection.encrypted:null,i=As.parse(r.url),a=i.pathname,s=i.search,o=n||r.headers["x-forwarded-proto"]=="https"?"https":"http",u=As.format({protocol:o,host:r.headers.host,pathname:a,search:s});return u},t.prototype._getIp=function(){var r=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=function(a){var s=r.exec(a);if(s)return s[0]},i=n(this.rawHeaders["x-forwarded-for"])||n(this.rawHeaders["x-client-ip"])||n(this.rawHeaders["x-real-ip"])||n(this.connectionRemoteAddress)||n(this.socketRemoteAddress)||n(this.legacySocketRemoteAddress);return!i&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(i="127.0.0.1"),i},t.prototype._getId=function(r){var n=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",i=t.parseId(Sg.getCookie(r,n));return i},t.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},t.prototype.parseHeaders=function(r,n){if(this.rawHeaders=r.headers||r.rawHeaders,this.userAgent=r.headers&&r.headers["user-agent"],this.sourceCorrelationId=Sg.getCorrelationContextTarget(r,Oe.requestContextSourceKey),r.headers){var i=r.headers[Oe.traceStateHeader]?r.headers[Oe.traceStateHeader].toString():null,a=r.headers[Oe.traceparentHeader]?r.headers[Oe.traceparentHeader].toString():null,s=r.headers[Oe.requestIdHeader]?r.headers[Oe.requestIdHeader].toString():null,o=r.headers[Oe.parentIdHeader]?r.headers[Oe.parentIdHeader].toString():null,u=r.headers[Oe.rootIdHeader]?r.headers[Oe.rootIdHeader].toString():null;this.correlationContextHeader=r.headers[Oe.correlationContextHeader]?r.headers[Oe.correlationContextHeader].toString():null,xt.w3cEnabled&&(a||i)?(this.traceparent=new sc(a?a.toString():null),this.tracestate=a&&i&&new $O(i?i.toString():null),this.setBackCompatFromThisTraceContext()):s?xt.w3cEnabled?(this.traceparent=new sc(null,s),this.setBackCompatFromThisTraceContext()):(this.parentId=s,this.requestId=xt.generateRequestId(this.parentId),this.operationId=xt.getRootId(this.requestId)):xt.w3cEnabled?(this.traceparent=new sc,this.traceparent.parentId=o,this.traceparent.legacyRootId=u||o,this.setBackCompatFromThisTraceContext()):(this.parentId=o,this.requestId=xt.generateRequestId(u||this.parentId),this.correlationContextHeader=null,this.operationId=xt.getRootId(this.requestId)),n&&(this.requestId=n,this.operationId=xt.getRootId(this.requestId))}},t.parseId=function(r){var n=r.split("|");return n.length>0?n[0]:""},t.keys=new FO.ContextTagKeys,t}(VO);Ag.exports=zO});var bs=l((aM,Cg)=>{"use strict";function cc(e){return typeof e=="function"}var me=console.error.bind(console);function pi(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function di(e){e&&e.logger&&(cc(e.logger)?me=e.logger:me("new logger isn't a function, not replacing"))}function bg(e,t,r){if(!e||!e[t]){me("no original function "+t+" to wrap");return}if(!r){me("no wrapper function"),me(new Error().stack);return}if(!cc(e[t])||!cc(r)){me("original object and wrapper must be functions");return}var n=e[t],i=r(n,t);return pi(i,"__original",n),pi(i,"__unwrap",function(){e[t]===i&&pi(e,t,n)}),pi(i,"__wrapped",!0),pi(e,t,i),i}function KO(e,t,r){if(e)Array.isArray(e)||(e=[e]);else{me("must provide one or more modules to patch"),me(new Error().stack);return}if(!(t&&Array.isArray(t))){me("must provide one or more functions to wrap on modules");return}e.forEach(function(n){t.forEach(function(i){bg(n,i,r)})})}function Ig(e,t){if(!e||!e[t]){me("no function to unwrap."),me(new Error().stack);return}if(!e[t].__unwrap)me("no original to unwrap to -- has "+t+" already been unwrapped?");else return e[t].__unwrap()}function YO(e,t){if(e)Array.isArray(e)||(e=[e]);else{me("must provide one or more modules to patch"),me(new Error().stack);return}if(!(t&&Array.isArray(t))){me("must provide one or more functions to unwrap on modules");return}e.forEach(function(r){t.forEach(function(n){Ig(r,n)})})}di.wrap=bg;di.massWrap=KO;di.unwrap=Ig;di.massUnwrap=YO;Cg.exports=di});var Os=l((sM,Ng)=>{"use strict";var Og=bs(),pn=Og.wrap,Is=Og.unwrap,pt="wrap@before";function Cs(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function XO(e,t){for(var r=t.length,n=0;n<r;n++){var i=t[n],a=e[pt];if(typeof a=="function")a(i);else if(Array.isArray(a))for(var s=a.length,o=0;o<s;o++)a[o](i)}}function Pg(e,t){var r;return r=e._events&&e._events[t],Array.isArray(r)||(r?r=[r]:r=[]),r}function QO(e,t,r){var n=Pg(e,t),i=n.filter(function(a){return r.indexOf(a)===-1});i.length>0&&XO(e,i)}function Rg(e,t){if(!!e){var r=e;if(typeof e=="function")r=t(e);else if(Array.isArray(e)){r=[];for(var n=0;n<e.length;n++)r[n]=t(e[n])}return r}}Ng.exports=function(t,r,n){if(!t||!t.on||!t.addListener||!t.removeListener||!t.emit)throw new Error("can only wrap real EEs");if(!r)throw new Error("must have function to run on listener addition");if(!n)throw new Error("must have function to wrap listeners when emitting");function i(s){return function(u,c){var p=Pg(this,u).slice();try{var d=s.call(this,u,c);return QO(this,u,p),d}finally{this.on.__wrapped||pn(this,"on",i),this.addListener.__wrapped||pn(this,"addListener",i)}}}function a(s){return function(u){if(!this._events||!this._events[u])return s.apply(this,arguments);var c=this._events[u];function p(d){return function(){this._events[u]=c;try{return d.apply(this,arguments)}finally{c=this._events[u],this._events[u]=Rg(c,n)}}}pn(this,"removeListener",p);try{return this._events[u]=Rg(c,n),s.apply(this,arguments)}finally{Is(this,"removeListener"),this._events[u]=c}}}t[pt]?typeof t[pt]=="function"?Cs(t,pt,[t[pt],r]):Array.isArray(t[pt])&&t[pt].push(r):Cs(t,pt,r),t.__wrapped||(pn(t,"addListener",i),pn(t,"on",i),pn(t,"emit",a),Cs(t,"__unwrap",function(){Is(t,"addListener"),Is(t,"on"),Is(t,"emit"),delete t[pt],delete t.__wrapped}),Cs(t,"__wrapped",!0))}});var xg=l((oM,Mg)=>{"use strict";var O=require("util"),dt=require("assert"),WO=Os(),q=require("async_hooks"),fi="cls@contexts",hi="error@context",U=process.env.DEBUG_CLS_HOOKED,P=-1;Mg.exports={getNamespace:Dg,createNamespace:ZO,destroyNamespace:wg,reset:JO,ERROR_SYMBOL:hi};function Me(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}Me.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[t]=r,U){let n=" ".repeat(this._indent<0?0:this._indent);j(n+"CONTEXT-SET KEY:"+t+"="+r+" in ns:"+this.name+" currentUid:"+P+" active:"+O.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return r};Me.prototype.get=function(t){if(!this.active){if(U){let r=q.currentId(),n=q.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);j(`${i}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${t}=undefined currentUid:${P} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length}`)}return}if(U){let r=q.executionAsyncId(),n=q.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);j(i+"CONTEXT-GETTING KEY:"+t+"="+this.active[t]+" ("+this.name+") currentUid:"+P+" active:"+O.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),j(`${i}CONTEXT-GETTING KEY: (${this.name}) ${t}=${this.active[t]} currentUid:${P} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} active:${O.inspect(this.active)}`)}return this.active[t]};Me.prototype.createContext=function(){let t=Object.create(this.active?this.active:Object.prototype);if(t._ns_name=this.name,t.id=P,U){let r=q.executionAsyncId(),n=q.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);j(`${i}CONTEXT-CREATED Context: (${this.name}) currentUid:${P} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} context:${O.inspect(t,{showHidden:!0,depth:2,colors:!0})}`)}return t};Me.prototype.run=function(t){let r=this.createContext();this.enter(r);try{if(U){let n=q.triggerAsyncId(),i=q.executionAsyncId(),a=" ".repeat(this._indent<0?0:this._indent);j(`${a}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${P} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} context:${O.inspect(r)}`)}return t(r),r}catch(n){throw n&&(n[hi]=r),n}finally{if(U){let n=q.triggerAsyncId(),i=q.executionAsyncId(),a=" ".repeat(this._indent<0?0:this._indent);j(`${a}CONTEXT-RUN END: (${this.name}) currentUid:${P} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} ${O.inspect(r)}`)}this.exit(r)}};Me.prototype.runAndReturn=function(t){let r;return this.run(function(n){r=t(n)}),r};Me.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return U&&j("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+P+" len:"+this._set.length+" "+O.inspect(r)),n.then(i=>(U&&j("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+P+" len:"+this._set.length+" "+O.inspect(r)),this.exit(r),i)).catch(i=>{throw i[hi]=r,U&&j("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+P+" len:"+this._set.length+" "+O.inspect(r)),this.exit(r),i})};Me.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(a){throw a&&(a[hi]=r),a}finally{n.exit(r)}}};Me.prototype.enter=function(t){if(dt.ok(t,"context must be provided for entering"),U){let r=q.executionAsyncId(),n=q.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);j(`${i}CONTEXT-ENTER: (${this.name}) currentUid:${P} triggerId:${n} asyncHooksCurrentId:${r} len:${this._set.length} ${O.inspect(t)}`)}this._set.push(this.active),this.active=t};Me.prototype.exit=function(t){if(dt.ok(t,"context must be provided for exiting"),U){let n=q.executionAsyncId(),i=q.triggerAsyncId(),a=" ".repeat(this._indent<0?0:this._indent);j(`${a}CONTEXT-EXIT: (${this.name}) currentUid:${P} triggerId:${i} asyncHooksCurrentId:${n} len:${this._set.length} ${O.inspect(t)}`)}if(this.active===t){dt.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?(U&&j("??ERROR?? context exiting but not entered - ignoring: "+O.inspect(t)),dt.ok(r>=0,`context not currently entered; can't exit. 
`+O.inspect(this)+`
`+O.inspect(t))):(dt.ok(r,"can't remove top context"),this._set.splice(r,1))};Me.prototype.bindEmitter=function(t){dt.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(s){!s||(s[fi]||(s[fi]=Object.create(null)),s[fi][n]={namespace:r,context:r.active})}function a(s){if(!(s&&s[fi]))return s;let o=s,u=s[fi];return Object.keys(u).forEach(function(c){let p=u[c];o=p.namespace.bind(o,p.context)}),o}WO(t,i,a)};Me.prototype.fromException=function(t){return t[hi]};function Dg(e){return process.namespaces[e]}function ZO(e){dt.ok(e,"namespace must be given a name."),U&&j(`NS-CREATING NAMESPACE (${e})`);let t=new Me(e);return t.id=P,q.createHook({init(n,i,a,s){if(P=q.executionAsyncId(),t.active){if(t._contexts.set(n,t.active),U){let o=" ".repeat(t._indent<0?0:t._indent);j(`${o}INIT [${i}] (${e}) asyncId:${n} currentUid:${P} triggerId:${a} active:${O.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${s}`)}}else if(P===0){let o=q.triggerAsyncId(),u=t._contexts.get(o);if(u){if(t._contexts.set(n,u),U){let c=" ".repeat(t._indent<0?0:t._indent);j(`${c}INIT USING CONTEXT FROM TRIGGERID [${i}] (${e}) asyncId:${n} currentUid:${P} triggerId:${o} active:${O.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${s}`)}}else if(U){let c=" ".repeat(t._indent<0?0:t._indent);j(`${c}INIT MISSING CONTEXT [${i}] (${e}) asyncId:${n} currentUid:${P} triggerId:${o} active:${O.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${s}`)}}if(U&&i==="PROMISE"){j(O.inspect(s,{showHidden:!0}));let o=s.parentId,u=" ".repeat(t._indent<0?0:t._indent);j(`${u}INIT RESOURCE-PROMISE [${i}] (${e}) parentId:${o} asyncId:${n} currentUid:${P} triggerId:${a} active:${O.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${s}`)}},before(n){P=q.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(P),i){if(U){let a=q.triggerAsyncId(),s=" ".repeat(t._indent<0?0:t._indent);j(`${s}BEFORE (${e}) asyncId:${n} currentUid:${P} triggerId:${a} active:${O.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${O.inspect(i)}`),t._indent+=2}t.enter(i)}else if(U){let a=q.triggerAsyncId(),s=" ".repeat(t._indent<0?0:t._indent);j(`${s}BEFORE MISSING CONTEXT (${e}) asyncId:${n} currentUid:${P} triggerId:${a} active:${O.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${O.inspect(t._contexts,{showHidden:!0,depth:2,colors:!0})}`),t._indent+=2}},after(n){P=q.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(P),i){if(U){let a=q.triggerAsyncId();t._indent-=2;let s=" ".repeat(t._indent<0?0:t._indent);j(`${s}AFTER (${e}) asyncId:${n} currentUid:${P} triggerId:${a} active:${O.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${O.inspect(i)}`)}t.exit(i)}else if(U){let a=q.triggerAsyncId();t._indent-=2;let s=" ".repeat(t._indent<0?0:t._indent);j(`${s}AFTER MISSING CONTEXT (${e}) asyncId:${n} currentUid:${P} triggerId:${a} active:${O.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${O.inspect(i)}`)}},destroy(n){if(P=q.executionAsyncId(),U){let i=q.triggerAsyncId(),a=" ".repeat(t._indent<0?0:t._indent);j(`${a}DESTROY (${e}) currentUid:${P} asyncId:${n} triggerId:${i} active:${O.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${O.inspect(t._contexts.get(P))}`)}t._contexts.delete(n)}}).enable(),process.namespaces[e]=t,t}function wg(e){let t=Dg(e);dt.ok(t,`can't delete nonexistent namespace! "`+e+'"'),dt.ok(t.id,"don't assign to process.namespaces directly! "+O.inspect(t)),process.namespaces[e]=null}function JO(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){wg(e)}),process.namespaces=Object.create(null)}process.namespaces={};function j(...e){U&&process._rawDebug(`${O.format(...e)}`)}});var qg=l((uM,Lg)=>{"use strict";function eP(){}Lg.exports=function(){let t=this._hooks,r=this._state,n=process.nextTick;process.nextTick=function(){if(!r.enabled)return n.apply(process,arguments);let i=new Array(arguments.length);for(let u=0;u<arguments.length;u++)i[u]=arguments[u];let a=i[0];if(typeof a!="function")throw new TypeError("callback is not a function");let s=new eP,o=--r.counter;return t.init.call(s,o,0,null,null),i[0]=function(){t.pre.call(s,o);let u=!0;try{a.apply(this,arguments),u=!1}finally{u&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){t.post.call(s,o,!0),t.destroy.call(null,o)})}t.post.call(s,o,!1),t.destroy.call(null,o)},n.apply(process,i)}}});var jg=l((cM,kg)=>{"use strict";function tP(){}kg.exports=function(){let t=this._hooks,r=this._state,n=global.Promise,i=n.prototype.then;n.prototype.then=u;function a(c,p,d,f){return typeof c!="function"?f?s(d):o(d):function(){t.pre.call(p,d);try{return c.apply(this,arguments)}finally{t.post.call(p,d,!1),t.destroy.call(null,d)}}}function s(c){return function(d){return t.destroy.call(null,c),d}}function o(c){return function(d){throw t.destroy.call(null,c),d}}function u(c,p){if(!r.enabled)return i.call(this,c,p);let d=new tP,f=--r.counter;return t.init.call(d,f,0,null,null),i.call(this,a(c,d,f,!0),a(p,d,f,!1))}}});var Ug=l((lM,Hg)=>{"use strict";var Pe=require("timers");function rP(){}function nP(){}function iP(){}var aP=new Map,sP=new Map,oP=new Map,lc=null,pc=!1;Hg.exports=function(){dc(this._hooks,this._state,"setTimeout","clearTimeout",rP,aP,!0),dc(this._hooks,this._state,"setInterval","clearInterval",nP,sP,!1),dc(this._hooks,this._state,"setImmediate","clearImmediate",iP,oP,!0),global.setTimeout=Pe.setTimeout,global.setInterval=Pe.setInterval,global.setImmediate=Pe.setImmediate,global.clearTimeout=Pe.clearTimeout,global.clearInterval=Pe.clearInterval,global.clearImmediate=Pe.clearImmediate};function dc(e,t,r,n,i,a,s){let o=Pe[r],u=Pe[n];Pe[r]=function(){if(!t.enabled)return o.apply(Pe,arguments);let c=new Array(arguments.length);for(let g=0;g<arguments.length;g++)c[g]=arguments[g];let p=c[0];if(typeof p!="function")throw new TypeError('"callback" argument must be a function');let d=new i,f=--t.counter,_;return e.init.call(d,f,0,null,null),c[0]=function(){lc=_,e.pre.call(d,f);let g=!0;try{p.apply(this,arguments),g=!1}finally{g&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(d,f,!0),a.delete(_),e.destroy.call(null,f)})}e.post.call(d,f,!1),lc=null,(s||pc)&&(pc=!1,a.delete(_),e.destroy.call(null,f))},_=o.apply(Pe,c),a.set(_,f),_},Pe[n]=function(c){if(lc===c&&c!==null)pc=!0;else if(a.has(c)){let p=a.get(c);a.delete(c),e.destroy.call(null,p)}u.apply(Pe,arguments)}}});var fc=l((pM,uP)=>{uP.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}});var Fg=l((dM,Gg)=>{"use strict";var _i=process.binding("async_wrap"),cP=_i.Providers.TIMERWRAP,Bg={nextTick:qg(),promise:jg(),timers:Ug()},gi=new Set;function lP(){this.enabled=!1,this.counter=0}function hc(){let e=this.initFns=[],t=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(i,a,s,o){if(a===cP){gi.add(i);return}for(let u of e)u(i,this,a,s,o)},this.pre=function(i){if(!gi.has(i))for(let a of t)a(i,this)},this.post=function(i,a){if(!gi.has(i))for(let s of r)s(i,this,a)},this.destroy=function(i){if(gi.has(i)){gi.delete(i);return}for(let a of n)a(i)}}hc.prototype.add=function(e){e.init&&this.initFns.push(e.init),e.pre&&this.preFns.push(e.pre),e.post&&this.postFns.push(e.post),e.destroy&&this.destroyFns.push(e.destroy)};function Ps(e,t){let r=e.indexOf(t);r!==-1&&e.splice(r,1)}hc.prototype.remove=function(e){e.init&&Ps(this.initFns,e.init),e.pre&&Ps(this.preFns,e.pre),e.post&&Ps(this.postFns,e.post),e.destroy&&Ps(this.destroyFns,e.destroy)};function vi(){this._state=new lP,this._hooks=new hc,this.version=fc().version,this.providers=_i.Providers;for(let e of Object.keys(Bg))Bg[e].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),_i.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}Gg.exports=vi;vi.prototype.addHooks=function(e){this._hooks.add(e)};vi.prototype.removeHooks=function(e){this._hooks.remove(e)};vi.prototype.enable=function(){this._state.enabled=!0,_i.enable()};vi.prototype.disable=function(){this._state.enabled=!1,_i.disable()}});var _c=l((fM,pP)=>{pP.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}});var $g=l((hM,Vg)=>{function dP(e){try{return Error.prototype.toString.call(e)}catch(t){try{return"<error: "+t+">"}catch(r){return"<error>"}}}Vg.exports=function(t,r){var n=[];n.push(dP(t));for(var i=0;i<r.length;i++){var a=r[i],s;try{s=a.toString()}catch(o){try{s="<error: "+o+">"}catch(u){s="<error>"}}n.push("    at "+s)}return n.join(`
`)}});var Xg=l((_M,Yg)=>{var Rs=$g();function zg(){this.extend=new Ei,this.filter=new Ei,this.format=new mi,this.version=_c().version}var gc=!1;zg.prototype.callSite=function e(t){t||(t={}),gc=!0;var r={};Error.captureStackTrace(r,e);var n=r.stack;return gc=!1,n=n.slice(t.slice||0),t.extend&&(n=this.extend._modify(r,n)),t.filter&&(n=this.filter._modify(r,n)),n};var Lt=new zg;function Ei(){this._modifiers=[]}Ei.prototype._modify=function(e,t){for(var r=0,n=this._modifiers.length;r<n;r++)t=this._modifiers[r](e,t);return t};Ei.prototype.attach=function(e){this._modifiers.push(e)};Ei.prototype.deattach=function(e){var t=this._modifiers.indexOf(e);return t===-1?!1:(this._modifiers.splice(t,1),!0)};function mi(){this._formater=Rs,this._previous=void 0}mi.prototype.replace=function(e){e?this._formater=e:this.restore()};mi.prototype.restore=function(){this._formater=Rs,this._previous=void 0};mi.prototype._backup=function(){this._previous=this._formater};mi.prototype._roolback=function(){this._previous===Rs?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&Lt.format.replace(Error.prepareStackTrace);var vc=!1;function Kg(e,t){if(gc)return t;if(vc)return Rs(e,t);var r=t.concat();r=Lt.extend._modify(e,r),r=Lt.filter._modify(e,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(e)&&Object.getOwnPropertyDescriptor(e,"callSite")===void 0&&(e.callSite={original:t,mutated:r}),vc=!0;var n=Lt.format._formater(e,r);return vc=!1,n}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return Kg},set:function(e){e===Kg?Lt.format._roolback():(Lt.format._backup(),Lt.format.replace(e))}});function fP(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:fP,set:function(e){Object.defineProperty(this,"callSite",{value:e,writable:!0,configurable:!0})},configurable:!0});Yg.exports=Lt});var mc=l((gM,Ec)=>{if(global._stackChain)if(global._stackChain.version===_c().version)Ec.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else Ec.exports=global._stackChain=Xg()});var Qg=l((vM,yc)=>{"use strict";var hP=Fg();if(global._asyncHook)if(global._asyncHook.version===fc().version)yc.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else mc().filter.attach(function(t,r){return r.filter(function(n){let i=n.getFileName();return!(i&&i.slice(0,__dirname.length)===__dirname)})}),yc.exports=global._asyncHook=new hP});var rv=l((EM,tv)=>{"use strict";var X=require("util"),ft=require("assert"),_P=Os(),dn=Qg(),yi="cls@contexts",Ti="error@context",Wg=[];for(let e in dn.providers)Wg[dn.providers[e]]=e;var $=process.env.DEBUG_CLS_HOOKED,ee=-1;tv.exports={getNamespace:Zg,createNamespace:gP,destroyNamespace:Jg,reset:vP,ERROR_SYMBOL:Ti};function xe(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map}xe.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return $&&Q("    SETTING KEY:"+t+"="+r+" in ns:"+this.name+" uid:"+ee+" active:"+X.inspect(this.active,!0)),this.active[t]=r,r};xe.prototype.get=function(t){if(!this.active){$&&Q("    GETTING KEY:"+t+"=undefined "+this.name+" uid:"+ee+" active:"+X.inspect(this.active,!0));return}return $&&Q("    GETTING KEY:"+t+"="+this.active[t]+" "+this.name+" uid:"+ee+" active:"+X.inspect(this.active,!0)),this.active[t]};xe.prototype.createContext=function(){$&&Q("   CREATING Context: "+this.name+" uid:"+ee+" len:"+this._set.length+"  active:"+X.inspect(this.active,!0,2,!0));let t=Object.create(this.active?this.active:Object.prototype);return t._ns_name=this.name,t.id=ee,$&&Q("   CREATED Context: "+this.name+" uid:"+ee+" len:"+this._set.length+"  context:"+X.inspect(t,!0,2,!0)),t};xe.prototype.run=function(t){let r=this.createContext();this.enter(r);try{return $&&Q(" BEFORE RUN: "+this.name+" uid:"+ee+" len:"+this._set.length+" "+X.inspect(r)),t(r),r}catch(n){throw n&&(n[Ti]=r),n}finally{$&&Q(" AFTER RUN: "+this.name+" uid:"+ee+" len:"+this._set.length+" "+X.inspect(r)),this.exit(r)}};xe.prototype.runAndReturn=function(t){var r;return this.run(function(n){r=t(n)}),r};xe.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return $&&Q(" BEFORE runPromise: "+this.name+" uid:"+ee+" len:"+this._set.length+" "+X.inspect(r)),n.then(i=>($&&Q(" AFTER runPromise: "+this.name+" uid:"+ee+" len:"+this._set.length+" "+X.inspect(r)),this.exit(r),i)).catch(i=>{throw i[Ti]=r,$&&Q(" AFTER runPromise: "+this.name+" uid:"+ee+" len:"+this._set.length+" "+X.inspect(r)),this.exit(r),i})};xe.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(a){throw a&&(a[Ti]=r),a}finally{n.exit(r)}}};xe.prototype.enter=function(t){ft.ok(t,"context must be provided for entering"),$&&Q("  ENTER "+this.name+" uid:"+ee+" len:"+this._set.length+" context: "+X.inspect(t)),this._set.push(this.active),this.active=t};xe.prototype.exit=function(t){if(ft.ok(t,"context must be provided for exiting"),$&&Q("  EXIT "+this.name+" uid:"+ee+" len:"+this._set.length+" context: "+X.inspect(t)),this.active===t){ft.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?($&&Q("??ERROR?? context exiting but not entered - ignoring: "+X.inspect(t)),ft.ok(r>=0,`context not currently entered; can't exit. 
`+X.inspect(this)+`
`+X.inspect(t))):(ft.ok(r,"can't remove top context"),this._set.splice(r,1))};xe.prototype.bindEmitter=function(t){ft.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(s){!s||(s[yi]||(s[yi]=Object.create(null)),s[yi][n]={namespace:r,context:r.active})}function a(s){if(!(s&&s[yi]))return s;let o=s,u=s[yi];return Object.keys(u).forEach(function(c){let p=u[c];o=p.namespace.bind(o,p.context)}),o}_P(t,i,a)};xe.prototype.fromException=function(t){return t[Ti]};function Zg(e){return process.namespaces[e]}function gP(e){ft.ok(e,"namespace must be given a name."),$&&Q("CREATING NAMESPACE "+e);let t=new xe(e);return t.id=ee,dn.addHooks({init(r,n,i,a,s){ee=r,a?(t._contexts.set(r,t._contexts.get(a)),$&&Q("PARENTID: "+e+" uid:"+r+" parent:"+a+" provider:"+i)):t._contexts.set(ee,t.active),$&&Q("INIT "+e+" uid:"+r+" parent:"+a+" provider:"+Wg[i]+" active:"+X.inspect(t.active,!0))},pre(r,n){ee=r;let i=t._contexts.get(r);i?($&&Q(" PRE "+e+" uid:"+r+" handle:"+Ns(n)+" context:"+X.inspect(i)),t.enter(i)):$&&Q(" PRE MISSING CONTEXT "+e+" uid:"+r+" handle:"+Ns(n))},post(r,n){ee=r;let i=t._contexts.get(r);i?($&&Q(" POST "+e+" uid:"+r+" handle:"+Ns(n)+" context:"+X.inspect(i)),t.exit(i)):$&&Q(" POST MISSING CONTEXT "+e+" uid:"+r+" handle:"+Ns(n))},destroy(r){ee=r,$&&Q("DESTROY "+e+" uid:"+r+" context:"+X.inspect(t._contexts.get(ee))+" active:"+X.inspect(t.active,!0)),t._contexts.delete(r)}}),process.namespaces[e]=t,t}function Jg(e){let t=Zg(e);ft.ok(t,`can't delete nonexistent namespace! "`+e+'"'),ft.ok(t.id,"don't assign to process.namespaces directly! "+X.inspect(t)),process.namespaces[e]=null}function vP(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){Jg(e)}),process.namespaces=Object.create(null)}process.namespaces={};dn._state&&!dn._state.enabled&&dn.enable();function Q(e){process.env.DEBUG&&process._rawDebug(e)}function Ns(e){if(!e)return e;if(typeof e=="function")return e.name?e.name:(e.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(e.constructor&&e.constructor.name)return e.constructor.name}if($){Tc=mc();for(ev in Tc.filter._modifiers)Tc.filter.deattach(ev)}var Tc,ev});var nv=l((mM,Sc)=>{"use strict";var EP=Wi();process&&EP.gte(process.versions.node,"8.0.0")?Sc.exports=xg():Sc.exports=rv()});var sv=l((yM,av)=>{var mP=bs().wrap,Ac=1<<0,bc=1<<1,Ic=1<<2,Ds=1<<3,M=[],yP=0,he=!1,qt=[],fn,Cc;function Oc(e,t){var r=e.length,n=t.length,i=[];if(r===0&&n===0)return i;for(var a=0;a<r;a++)i[a]=e[a];if(n===0)return i;for(var s=0;s<n;s++){var o=!0;for(a=0;a<r;a++)if(e[a].uid===t[s].uid){o=!1;break}o&&i.push(t[s])}return i}process._fatalException?(ws=!1,fn=function(t){var r=M.length;if(ws||r===0)return!1;var n=!1;ws=!0;for(var i=0;i<r;++i){var a=M[i];if((a.flags&Ds)!=0){var s=hn&&hn[a.uid];n=a.error(s,t)||n}}return ws=!1,qt.length>0&&(M=qt.pop()),hn=void 0,n&&!he},Cc=function(t,r,n){var i=[];he=!0;for(var a=0;a<n;++a){var s=r[a];if(i[s.uid]=s.data,(s.flags&Ac)!=0){var o=s.create(s.data);o!==void 0&&(i[s.uid]=o)}}return he=!1,function(){hn=i,qt.push(M),M=Oc(r,M),he=!0;for(var u=0;u<n;++u)(r[u].flags&bc)>0&&r[u].before(this,i[r[u].uid]);he=!1;var c=t.apply(this,arguments);for(he=!0,u=0;u<n;++u)(r[u].flags&Ic)>0&&r[u].after(this,i[r[u].uid]);return he=!1,M=qt.pop(),hn=void 0,c}},mP(process,"_fatalException",function(e){return function(r){return fn(r)||e(r)}})):(Pc=!1,fn=function(t){if(Pc)throw t;for(var r=!1,n=M.length,i=0;i<n;++i){var a=M[i];(a.flags&Ds)!=0&&(r=a.error(null,t)||r)}if(!r&&he)throw t},Cc=function(t,r,n){var i=[];he=!0;for(var a=0;a<n;++a){var s=r[a];if(i[s.uid]=s.data,(s.flags&Ac)!=0){var o=s.create(s.data);o!==void 0&&(i[s.uid]=o)}}return he=!1,function(){var u=!1,c=!1;qt.push(M),M=Oc(r,M),he=!0;for(var p=0;p<n;++p)(r[p].flags&bc)>0&&r[p].before(this,i[r[p].uid]);he=!1;var d;try{d=t.apply(this,arguments)}catch(f){u=!0;for(var p=0;p<n;++p)if((M[p].flags&Ds)!=0)try{c=M[p].error(i[r[p].uid],f)||c}catch(g){throw Pc=!0,g}if(!c)throw process.removeListener("uncaughtException",fn),process._originalNextTick(function(){process.addListener("uncaughtException",fn)}),f}finally{if(!u||c){for(he=!0,p=0;p<n;++p)(r[p].flags&Ic)>0&&r[p].after(this,i[r[p].uid]);he=!1}M=qt.pop()}return d}},process.addListener("uncaughtException",fn));var ws,hn,Pc;function TP(e,t,r){he=!0;for(var n=0;n<r;++n){var i=t[n];i.create&&i.create(i.data)}return he=!1,function(){qt.push(M),M=Oc(t,M);var a=e.apply(this,arguments);return M=qt.pop(),a}}function SP(e){var t=M.length;if(t===0)return e;for(var r=M.slice(),n=0;n<t;++n)if(r[n].flags>0)return Cc(e,r,t);return TP(e,r,t)}function We(e,t){typeof e.create=="function"&&(this.create=e.create,this.flags|=Ac),typeof e.before=="function"&&(this.before=e.before,this.flags|=bc),typeof e.after=="function"&&(this.after=e.after,this.flags|=Ic),typeof e.error=="function"&&(this.error=e.error,this.flags|=Ds),this.uid=++yP,this.data=t===void 0?null:t}We.prototype.create=void 0;We.prototype.before=void 0;We.prototype.after=void 0;We.prototype.error=void 0;We.prototype.data=void 0;We.prototype.uid=0;We.prototype.flags=0;function iv(e,t){if(typeof e!="object"||!e)throw new TypeError("callbacks argument must be an object");return e instanceof We?e:new We(e,t)}function AP(e,t){var r;e instanceof We?r=e:r=iv(e,t);for(var n=!1,i=0;i<M.length;i++)if(r===M[i]){n=!0;break}return n||M.push(r),r}function bP(e){for(var t=0;t<M.length;t++)if(e===M[t]){M.splice(t,1);break}}process.createAsyncListener=iv;process.addAsyncListener=AP;process.removeAsyncListener=bP;av.exports=SP});var uv=l((SM,ov)=>{"use strict";ov.exports=(e,t)=>class extends e{constructor(n){var i,a;super(o);var s=this;try{n.apply(i,a)}catch(u){a[1](u)}return s;function o(u,c){i=this,a=[p,d];function p(f){return t(s,!1),u(f)}function d(f){return t(s,!1),c(f)}}}}});var _v=l(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var cv=bs(),Ms=Wi(),Se=cv.wrap,kt=cv.massWrap,B=sv(),IP=require("util"),CP=Ms.gte(process.version,"6.0.0"),Rc=Ms.gte(process.version,"7.0.0"),OP=Ms.gte(process.version,"8.0.0"),PP=Ms.gte(process.version,"11.0.0"),Ze=require("net");Rc&&!Ze._normalizeArgs?Ze._normalizeArgs=function(e){if(e.length===0)return[{},null];var t=e[0],r={};typeof t=="object"&&t!==null?r=t:MP(t)?r.path=t:(r.port=t,e.length>1&&typeof e[1]=="string"&&(r.host=e[1]));var n=e[e.length-1];return typeof n!="function"?[r,null]:[r,n]}:!Rc&&!Ze._normalizeConnectArgs&&(Ze._normalizeConnectArgs=function(e){var t={};function r(i){return(i=Number(i))>=0?i:!1}typeof e[0]=="object"&&e[0]!==null?t=e[0]:typeof e[0]=="string"&&r(e[0])===!1?t.path=e[0]:(t.port=e[0],typeof e[1]=="string"&&(t.host=e[1]));var n=e[e.length-1];return typeof n=="function"?[t,n]:[t]});"_setUpListenHandle"in Ze.Server.prototype?Se(Ze.Server.prototype,"_setUpListenHandle",lv):Se(Ze.Server.prototype,"_listen2",lv);function lv(e){return function(){this.on("connection",function(t){t._handle&&(t._handle.onread=B(t._handle.onread))});try{return e.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=B(this._handle.onconnection))}}}function pv(e){if(e&&e._handle){var t=e._handle;t._originalOnread||(t._originalOnread=t.onread),t.onread=B(t._originalOnread)}}Se(Ze.Socket.prototype,"connect",function(e){return function(){var t;OP&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?t=arguments[0]:t=Rc?Ze._normalizeArgs(arguments):Ze._normalizeConnectArgs(arguments),t[1]&&(t[1]=B(t[1]));var r=e.apply(this,t);return pv(this),r}});var RP=require("http");Se(RP.Agent.prototype,"addRequest",function(e){return function(t){var r=t.onSocket;return t.onSocket=B(function(n){return pv(n),r.apply(this,arguments)}),e.apply(this,arguments)}});var Nc=require("child_process");function dv(e){Array.isArray(e.stdio)&&e.stdio.forEach(function(t){t&&t._handle&&(t._handle.onread=B(t._handle.onread),Se(t._handle,"close",Ls))}),e._handle&&(e._handle.onexit=B(e._handle.onexit))}Nc.ChildProcess?Se(Nc.ChildProcess.prototype,"spawn",function(e){return function(){var t=e.apply(this,arguments);return dv(this),t}}):kt(Nc,["execFile","fork","spawn"],function(e){return function(){var t=e.apply(this,arguments);return dv(t),t}});process._fatalException||(process._originalNextTick=process.nextTick);var Dc=[];process._nextDomainTick&&Dc.push("_nextDomainTick");process._tickDomainCallback&&Dc.push("_tickDomainCallback");kt(process,Dc,Je);Se(process,"nextTick",Ls);var wc=["setTimeout","setInterval"];global.setImmediate&&wc.push("setImmediate");var fv=require("timers"),NP=global.setTimeout===fv.setTimeout;kt(fv,wc,Ls);NP&&kt(global,wc,Ls);var Mc=require("dns");kt(Mc,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],Je);Mc.resolveNaptr&&Se(Mc,"resolveNaptr",Je);var mr=require("fs");kt(mr,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],Je);mr.lchown&&Se(mr,"lchown",Je);mr.lchmod&&Se(mr,"lchmod",Je);mr.ftruncate&&Se(mr,"ftruncate",Je);var Si;try{Si=require("zlib")}catch(e){}Si&&Si.Deflate&&Si.Deflate.prototype&&(yr=Object.getPrototypeOf(Si.Deflate.prototype),yr._transform?Se(yr,"_transform",Je):yr.write&&yr.flush&&yr.end&&kt(yr,["write","flush","end"],Je));var yr,xc;try{xc=require("crypto")}catch(e){}xc&&(Lc=["pbkdf2","randomBytes"],PP||Lc.push("pseudoRandomBytes"),kt(xc,Lc,Je));var Lc,xs=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";xs&&(hv=process.addAsyncListener({create:function(){xs=!1}}),global.Promise.resolve(!0).then(function(){xs=!1}),process.removeAsyncListener(hv));var hv;xs&&DP();function DP(){var e=global.Promise;function t(s){if(!(this instanceof t))return e(s);if(typeof s!="function")return new e(s);var o,u,c=new e(p);c.__proto__=t.prototype;try{s.apply(o,u)}catch(d){u[1](d)}return c;function p(d,f){o=this,u=[_,g];function _(y){return n(c,!1),d(y)}function g(y){return n(c,!1),f(y)}}}if(IP.inherits(t,e),Se(e.prototype,"then",a),e.prototype.chain&&Se(e.prototype,"chain",a),CP)global.Promise=uv()(e,n);else{var r=["all","race","reject","resolve","accept","defer"];r.forEach(function(s){typeof e[s]=="function"&&(t[s]=e[s])}),global.Promise=t}function n(s,o){(!s.__asl_wrapper||o)&&(s.__asl_wrapper=B(i))}function i(s,o,u,c){var p;try{return p=o.call(s,u),{returnVal:p,error:!1}}catch(d){return{errorVal:d,error:!0}}finally{p instanceof e?c.__asl_wrapper=function(){var f=p.__asl_wrapper||i;return f.apply(this,arguments)}:n(c,!0)}}function a(s){return function(){var u=this,c=s.apply(u,Array.prototype.map.call(arguments,p));return c.__asl_wrapper=function(f,_,g,y){return u.__asl_wrapper?(u.__asl_wrapper(f,function(){},null,c),c.__asl_wrapper(f,_,g,y)):i(f,_,g,y)},c;function p(d){return typeof d!="function"?d:B(function(f){var _=(u.__asl_wrapper||i)(this,d,f,c);if(_.error)throw _.errorVal;return _.returnVal})}}}}function Je(e){var t=function(){var r,n=arguments.length-1;if(typeof arguments[n]=="function"){r=Array(arguments.length);for(var i=0;i<arguments.length-1;i++)r[i]=arguments[i];r[n]=B(arguments[n])}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=B(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof n=="function"&&(n=B(n)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof i=="function"&&(i=B(i)),e.call(this,r,n,i))};case 4:return function(r,n,i,a){return arguments.length!==4?t.apply(this,arguments):(typeof a=="function"&&(a=B(a)),e.call(this,r,n,i,a))};case 5:return function(r,n,i,a,s){return arguments.length!==5?t.apply(this,arguments):(typeof s=="function"&&(s=B(s)),e.call(this,r,n,i,a,s))};case 6:return function(r,n,i,a,s,o){return arguments.length!==6?t.apply(this,arguments):(typeof o=="function"&&(o=B(o)),e.call(this,r,n,i,a,s,o))};default:return t}}function Ls(e){var t=function(){var r;if(typeof arguments[0]=="function"){r=Array(arguments.length),r[0]=B(arguments[0]);for(var n=1;n<arguments.length;n++)r[n]=arguments[n]}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=B(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof r=="function"&&(r=B(r)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof r=="function"&&(r=B(r)),e.call(this,r,n,i))};case 4:return function(r,n,i,a){return arguments.length!==4?t.apply(this,arguments):(typeof r=="function"&&(r=B(r)),e.call(this,r,n,i,a))};case 5:return function(r,n,i,a,s){return arguments.length!==5?t.apply(this,arguments):(typeof r=="function"&&(r=B(r)),e.call(this,r,n,i,a,s))};case 6:return function(r,n,i,a,s,o){return arguments.length!==6?t.apply(this,arguments):(typeof r=="function"&&(r=B(r)),e.call(this,r,n,i,a,s,o))};default:return t}}function wP(e){return(e=Number(e))>=0?e:!1}function MP(e){return typeof e=="string"&&wP(e)===!1}});var yv=l((IM,mv)=>{"use strict";var ht=require("assert"),xP=Os(),Ai="cls@contexts",qc="error@context";process.addAsyncListener||_v();function Fe(e){this.name=e,this.active=null,this._set=[],this.id=null}Fe.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,t};Fe.prototype.get=function(e){if(!!this.active)return this.active[e]};Fe.prototype.createContext=function(){return Object.create(this.active)};Fe.prototype.run=function(e){var t=this.createContext();this.enter(t);try{return e(t),t}catch(r){throw r&&(r[qc]=t),r}finally{this.exit(t)}};Fe.prototype.runAndReturn=function(e){var t;return this.run(function(r){t=e(r)}),t};Fe.prototype.bind=function(e,t){t||(this.active?t=this.active:t=this.createContext());var r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(n){throw n&&(n[qc]=t),n}finally{r.exit(t)}}};Fe.prototype.enter=function(e){ht.ok(e,"context must be provided for entering"),this._set.push(this.active),this.active=e};Fe.prototype.exit=function(e){if(ht.ok(e,"context must be provided for exiting"),this.active===e){ht.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var t=this._set.lastIndexOf(e);ht.ok(t>=0,"context not currently entered; can't exit"),ht.ok(t,"can't remove top context"),this._set.splice(t,1)};Fe.prototype.bindEmitter=function(e){ht.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");var t=this,r="context@"+this.name;function n(a){!a||(a[Ai]||(a[Ai]=Object.create(null)),a[Ai][r]={namespace:t,context:t.active})}function i(a){if(!(a&&a[Ai]))return a;var s=a,o=a[Ai];return Object.keys(o).forEach(function(u){var c=o[u];s=c.namespace.bind(s,c.context)}),s}xP(e,n,i)};Fe.prototype.fromException=function(e){return e[qc]};function gv(e){return process.namespaces[e]}function LP(e){ht.ok(e,"namespace must be given a name!");var t=new Fe(e);return t.id=process.addAsyncListener({create:function(){return t.active},before:function(r,n){n&&t.enter(n)},after:function(r,n){n&&t.exit(n)},error:function(r){r&&t.exit(r)}}),process.namespaces[e]=t,t}function vv(e){var t=gv(e);ht.ok(t,"can't delete nonexistent namespace!"),ht.ok(t.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(t.id),process.namespaces[e]=null}function Ev(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){vv(e)}),process.namespaces=Object.create(null)}process.namespaces||Ev();mv.exports={getNamespace:gv,createNamespace:LP,destroyNamespace:vv,reset:Ev}});var $t=l(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});qs.CorrelationContextManager=void 0;var Tv=ne(),qP=ms(),_n=li(),kc=Fu(),Sv=uc(),kP=function(){function e(){}return e.getCurrentContext=function(){if(!e.enabled)return null;var t=e.session.get(e.CONTEXT_NAME);return t===void 0?null:t},e.generateContextObject=function(t,r,n,i,a,s){return r=r||t,this.enabled?{operation:{name:n,id:t,parentId:r,traceparent:a,tracestate:s},customProperties:new jP(i)}:null},e.spanToContextObject=function(t,r,n){var i=new _n;return i.traceId=t.traceId,i.spanId=t.spanId,i.traceFlag=_n.formatOpenTelemetryTraceFlags(t.traceFlags)||_n.DEFAULT_TRACE_FLAG,i.parentId=r,e.generateContextObject(i.traceId,i.parentId,n,null,i)},e.runWithContext=function(t,r){var n;return e.enabled?e.session.bind(r,(n={},n[e.CONTEXT_NAME]=t,n))():r()},e.wrapEmitter=function(t){e.enabled&&e.session.bindEmitter(t)},e.wrapCallback=function(t,r){var n;return e.enabled?e.session.bind(t,r?(n={},n[e.CONTEXT_NAME]=r,n):void 0):t},e.enable=function(t){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}e.hasEverEnabled||(this.forceClsHooked=t,this.hasEverEnabled=!0,typeof this.cls=="undefined"&&(e.forceClsHooked===!0||e.forceClsHooked===void 0&&e.shouldUseClsHooked()?this.cls=nv():this.cls=yv()),e.session=this.cls.createNamespace("AI-CLS-Session"),qP.registerContextPreservation(function(r){return e.session.bind(r)})),this.enabled=!0}},e.startOperation=function(t,r){var n=t&&t.traceContext||null,i=t&&t.traceId?t:null,a=t&&t.headers;if(i){var s=new _n("00-"+i.traceId+"-"+i.spanId+"-01"),o=new kc(i.traceState?i.traceState.serialize():null),u=e.generateContextObject(i.traceId,"|"+i.traceId+"."+i.spanId+".",typeof r=="string"?r:"",void 0,s,o);return u}if(n){var s=new _n(n.traceparent),o=new kc(n.tracestate),c=typeof r=="object"?new Sv(r):null,u=e.generateContextObject(s.traceId,s.parentId,typeof r=="string"?r:c.getOperationName({}),c&&c.getCorrelationContextHeader()||void 0,s,o);return u}if(a){var s=new _n(a.traceparent?a.traceparent.toString():null),o=new kc(a.tracestate?a.tracestate.toString():null),c=new Sv(t),u=e.generateContextObject(s.traceId,s.parentId,c.getOperationName({}),c.getCorrelationContextHeader(),s,o);return u}return Tv.warn("startOperation was called with invalid arguments",arguments),null},e.disable=function(){this.enabled=!1},e.reset=function(){e.hasEverEnabled&&(e.session=null,e.session=this.cls.createNamespace("AI-CLS-Session"))},e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>3||parseInt(t[0])>2&&parseInt(t[1])>2},e.shouldUseClsHooked=function(){var t=process.versions.node.split(".");return parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=2},e.canUseClsHooked=function(){var t=process.versions.node.split("."),r=parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=0,n=parseInt(t[0])<8||parseInt(t[0])<=8&&parseInt(t[1])<2,i=parseInt(t[0])>4||parseInt(t[0])>=4&&parseInt(t[1])>=7;return!(r&&n)&&i},e.enabled=!1,e.hasEverEnabled=!1,e.forceClsHooked=void 0,e.CONTEXT_NAME="ApplicationInsights-Context",e}();qs.CorrelationContextManager=kP;var jP=function(){function e(t){this.props=[],this.addHeaderData(t)}return e.prototype.addHeaderData=function(t){var r=t?t.split(", "):[];this.props=r.map(function(n){var i=n.split("=");return{key:i[0],value:i[1]}}).concat(this.props)},e.prototype.serializeToHeader=function(){return this.props.map(function(t){return t.key+"="+t.value}).join(", ")},e.prototype.getProperty=function(t){for(var r=0;r<this.props.length;++r){var n=this.props[r];if(n.key===t)return n.value}},e.prototype.setProperty=function(t,r){if(e.bannedCharacters.test(t)||e.bannedCharacters.test(r)){Tv.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+t+" and value: "+r);return}for(var n=0;n<this.props.length;++n){var i=this.props[n];if(i.key===t){i.value=r;return}}this.props.push({key:t,value:r})},e.bannedCharacters=/[,=]/,e}()});var bv=l(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.dispose=gn.enable=void 0;var Av=Ee(),jc=Y(),Tr=[],Hc=function(e){var t=e.data.message;Tr.forEach(function(r){t instanceof Error?r.trackException({exception:t}):(t.lastIndexOf(`
`)==t.length-1&&(t=t.substring(0,t.length-1)),r.trackTrace({message:t,severity:e.data.stderr?Av.SeverityLevel.Warning:Av.SeverityLevel.Information}))})};function HP(e,t){e?(Tr.length===0&&jc.channel.subscribe("console",Hc),Tr.push(t)):(Tr=Tr.filter(function(r){return r!=t}),Tr.length===0&&jc.channel.unsubscribe("console",Hc))}gn.enable=HP;function UP(){jc.channel.unsubscribe("console",Hc),Tr=[]}gn.dispose=UP});var Iv=l(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.dispose=En.enable=void 0;var vn=Ee(),Uc=Y(),Sr=[],BP={10:vn.SeverityLevel.Verbose,20:vn.SeverityLevel.Verbose,30:vn.SeverityLevel.Information,40:vn.SeverityLevel.Warning,50:vn.SeverityLevel.Error,60:vn.SeverityLevel.Critical},Bc=function(e){var t=e.data.result;Sr.forEach(function(r){var n=BP[e.data.level];t instanceof Error?r.trackException({exception:t}):r.trackTrace({message:t,severity:n})})};function GP(e,t){e?(Sr.length===0&&Uc.channel.subscribe("bunyan",Bc),Sr.push(t)):(Sr=Sr.filter(function(r){return r!=t}),Sr.length===0&&Uc.channel.unsubscribe("bunyan",Bc))}En.enable=GP;function FP(){Uc.channel.unsubscribe("bunyan",Bc),Sr=[]}En.dispose=FP});var Cv=l(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.dispose=mn.enable=void 0;var ce=Ee(),Gc=Y(),Ar=[],VP={syslog:function(e){var t={emerg:ce.SeverityLevel.Critical,alert:ce.SeverityLevel.Critical,crit:ce.SeverityLevel.Critical,error:ce.SeverityLevel.Error,warning:ce.SeverityLevel.Warning,notice:ce.SeverityLevel.Information,info:ce.SeverityLevel.Information,debug:ce.SeverityLevel.Verbose};return t[e]===void 0?ce.SeverityLevel.Information:t[e]},npm:function(e){var t={error:ce.SeverityLevel.Error,warn:ce.SeverityLevel.Warning,info:ce.SeverityLevel.Information,verbose:ce.SeverityLevel.Verbose,debug:ce.SeverityLevel.Verbose,silly:ce.SeverityLevel.Verbose};return t[e]===void 0?ce.SeverityLevel.Information:t[e]},unknown:function(e){return ce.SeverityLevel.Information}},Fc=function(e){var t=e.data.message;Ar.forEach(function(r){if(t instanceof Error)r.trackException({exception:t,properties:e.data.meta});else{var n=VP[e.data.levelKind](e.data.level);r.trackTrace({message:t,severity:n,properties:e.data.meta})}})};function $P(e,t){e?(Ar.length===0&&Gc.channel.subscribe("winston",Fc),Ar.push(t)):(Ar=Ar.filter(function(r){return r!=t}),Ar.length===0&&Gc.channel.unsubscribe("winston",Fc))}mn.enable=$P;function zP(){Gc.channel.unsubscribe("winston",Fc),Ar=[]}mn.dispose=zP});var Pv=l((NM,Ov)=>{"use strict";var KP=ms(),YP=function(){function e(t){if(e.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=t,e.INSTANCE=this}return e.prototype.enable=function(t,r){KP.IsInitialized&&(bv().enable(t&&r,this._client),Iv().enable(t,this._client),Cv().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1,!1)},e._methodNames=["debug","info","log","warn","error"],e}();Ov.exports=YP});var Nv=l((DM,Rv)=>{"use strict";var XP=function(){function e(t){if(e.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t;var r=process.versions.node.split(".");e._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||parseInt(r[0])===13&&parseInt(r[1])>=7}return e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.enable=function(t){var r=this;if(t){this._isInitialized=!0;var n=this;if(!this._exceptionListenerHandle){var i=function(a,s,o){o===void 0&&(o=new Error(e._FALLBACK_ERROR_MESSAGE)),r._client.trackException({exception:o}),r._client.flush({isAppCrashing:!0}),a&&s&&process.listeners(s).length===1&&(console.error(o),process.exit(1))};e._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=i.bind(this,!0,e.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(e._canUseUncaughtExceptionMonitor?process.removeListener(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.INSTANCE=null,e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",e.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",e.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",e._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",e._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",e._canUseUncaughtExceptionMonitor=!1,e}();Rv.exports=XP});var _t=l(m=>{"use strict";var Ve;Object.defineProperty(m,"__esModule",{value:!0});m.HeartBeatMetricName=m.DependencyTypeName=m.SpanAttribute=m.TelemetryTypeStringToQuickPulseDocumentType=m.TelemetryTypeStringToQuickPulseType=m.QuickPulseType=m.QuickPulseDocumentType=m.PerformanceToQuickPulseCounter=m.MetricId=m.PerformanceCounter=m.QuickPulseCounter=m.DEFAULT_LIVEMETRICS_HOST=m.DEFAULT_LIVEMETRICS_ENDPOINT=m.DEFAULT_BREEZE_ENDPOINT=void 0;m.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";m.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";m.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var _e;(function(e){e.COMMITTED_BYTES="\\Memory\\Committed Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",e.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",e.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",e.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",e.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",e.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",e.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(_e=m.QuickPulseCounter||(m.QuickPulseCounter={}));var ks;(function(e){e.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",e.AVAILABLE_BYTES="\\Memory\\Available Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",e.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",e.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(ks=m.PerformanceCounter||(m.PerformanceCounter={}));var QP;(function(e){e.REQUESTS_DURATION="requests/duration",e.DEPENDENCIES_DURATION="dependencies/duration",e.EXCEPTIONS_COUNT="exceptions/count",e.TRACES_COUNT="traces/count"})(QP=m.MetricId||(m.MetricId={}));m.PerformanceToQuickPulseCounter=(Ve={},Ve[ks.PROCESSOR_TIME]=_e.PROCESSOR_TIME,Ve[ks.REQUEST_RATE]=_e.REQUEST_RATE,Ve[ks.REQUEST_DURATION]=_e.REQUEST_DURATION,Ve[_e.COMMITTED_BYTES]=_e.COMMITTED_BYTES,Ve[_e.REQUEST_FAILURE_RATE]=_e.REQUEST_FAILURE_RATE,Ve[_e.DEPENDENCY_RATE]=_e.DEPENDENCY_RATE,Ve[_e.DEPENDENCY_FAILURE_RATE]=_e.DEPENDENCY_FAILURE_RATE,Ve[_e.DEPENDENCY_DURATION]=_e.DEPENDENCY_DURATION,Ve[_e.EXCEPTION_RATE]=_e.EXCEPTION_RATE,Ve);m.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"};m.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"};m.TelemetryTypeStringToQuickPulseType={EventData:m.QuickPulseType.Event,ExceptionData:m.QuickPulseType.Exception,MessageData:m.QuickPulseType.Trace,MetricData:m.QuickPulseType.Metric,RequestData:m.QuickPulseType.Request,RemoteDependencyData:m.QuickPulseType.Dependency,AvailabilityData:m.QuickPulseType.Availability,PageViewData:m.QuickPulseType.PageView};m.TelemetryTypeStringToQuickPulseDocumentType={EventData:m.QuickPulseDocumentType.Event,ExceptionData:m.QuickPulseDocumentType.Exception,MessageData:m.QuickPulseDocumentType.Trace,MetricData:m.QuickPulseDocumentType.Metric,RequestData:m.QuickPulseDocumentType.Request,RemoteDependencyData:m.QuickPulseDocumentType.Dependency,AvailabilityData:m.QuickPulseDocumentType.Availability,PageViewData:m.QuickPulseDocumentType.PageView};m.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"};m.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"};m.HeartBeatMetricName="HeartBeat"});var Hs=l((MM,Dv)=>{"use strict";var js=require("os"),Le=_t(),WP=function(){function e(t,r,n){r===void 0&&(r=6e4),n===void 0&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._lastCpus=js.cpus(),this._lastRequests={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:e._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countRequest=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalRequestExecutionTime+=n,r===!1&&e._totalFailedRequestCount++,e._totalRequestCount++}},e.countException=function(){e._totalExceptionCount++},e.countDependency=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalDependencyExecutionTime+=n,r===!1&&e._totalFailedDependencyCount++,e._totalDependencyCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},e.prototype._trackCpu=function(){var t=js.cpus();if(t&&t.length&&this._lastCpus&&t.length===this._lastCpus.length){for(var r=0,n=0,i=0,a=0,s=0,o=0;!!t&&o<t.length;o++){var u=t[o],c=this._lastCpus[o],p="% cpu("+o+") ",d=u.model,f=u.speed,_=u.times,g=c.times,y=_.user-g.user||0;r+=y;var R=_.sys-g.sys||0;n+=R;var K=_.nice-g.nice||0;i+=K;var le=_.idle-g.idle||0;a+=le;var nt=_.irq-g.irq||0;s+=nt}var Or=void 0;if(typeof process.cpuUsage=="function"){var xn=process.cpuUsage(),Pr=process.hrtime(),Cm=xn.user-this._lastAppCpuUsage.user+(xn.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime!="undefined"&&this._lastHrtime.length===2){var Om=(Pr[0]-this._lastHrtime[0])*1e6+(Pr[1]-this._lastHrtime[1])/1e3||0;Or=100*Cm/(Om*t.length)}this._lastAppCpuUsage=xn,this._lastHrtime=Pr}var no=r+n+i+a+s||1;this._client.trackMetric({name:Le.PerformanceCounter.PROCESSOR_TIME,value:(no-a)/no*100}),this._client.trackMetric({name:Le.PerformanceCounter.PROCESS_TIME,value:Or||r/no*100})}this._lastCpus=t},e.prototype._trackMemory=function(){var t=js.freemem(),r=process.memoryUsage().rss,n=js.totalmem()-t;this._client.trackMetric({name:Le.PerformanceCounter.PRIVATE_BYTES,value:r}),this._client.trackMetric({name:Le.PerformanceCounter.AVAILABLE_BYTES,value:t}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Le.QuickPulseCounter.COMMITTED_BYTES,value:n})},e.prototype._trackNetwork=function(){var t=this._lastRequests,r={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-t.totalRequestCount||0,i=r.totalFailedRequestCount-t.totalFailedRequestCount||0,a=r.time-t.time,s=a/1e3,o=(e._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=e._intervalRequestExecutionTime,a>0){var u=n/s,c=i/s;this._client.trackMetric({name:Le.PerformanceCounter.REQUEST_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Le.PerformanceCounter.REQUEST_DURATION,value:o}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Le.QuickPulseCounter.REQUEST_FAILURE_RATE,value:c})}this._lastRequests=r},e.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastDependencies,r={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-t.totalDependencyCount||0,i=r.totalFailedDependencyCount-t.totalFailedDependencyCount||0,a=r.time-t.time,s=a/1e3,o=(e._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=e._intervalDependencyExecutionTime,a>0){var u=n/s,c=i/s;this._client.trackMetric({name:Le.QuickPulseCounter.DEPENDENCY_RATE,value:u}),this._client.trackMetric({name:Le.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:c}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Le.QuickPulseCounter.DEPENDENCY_DURATION,value:o})}this._lastDependencies=r}},e.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastExceptions,r={totalExceptionCount:e._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-t.totalExceptionCount||0,i=r.time-t.time,a=i/1e3;if(i>0){var s=n/a;this._client.trackMetric({name:Le.QuickPulseCounter.EXCEPTION_RATE,value:s})}this._lastExceptions=r}},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e._totalRequestCount=0,e._totalFailedRequestCount=0,e._totalDependencyCount=0,e._totalFailedDependencyCount=0,e._totalExceptionCount=0,e._intervalDependencyExecutionTime=0,e._intervalRequestExecutionTime=0,e}();Dv.exports=WP});var wv=l(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});Us.AggregatedMetricCounter=void 0;var ZP=function(){function e(t){this.dimensions=t,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}return e}();Us.AggregatedMetricCounter=ZP});var Mv=l(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.PreaggregatedMetricPropertyNames=void 0;Bs.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}});var $c=l((Vc,xv)=>{"use strict";var Gs=Vc&&Vc.__assign||function(){return Gs=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Gs.apply(this,arguments)},Fs=_t(),JP=wv(),eR=Mv(),tR=function(){function e(t,r){r===void 0&&(r=6e4),e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,e._dependencyCountersCollection=[],e._requestCountersCollection=[],e._exceptionCountersCollection=[],e._traceCountersCollection=[],this._client=t,this._collectionInterval=r}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPreAggregatedMetrics()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countException=function(t){if(!!e.isEnabled()){var r=e._getAggregatedCounter(t,this._exceptionCountersCollection);r.totalCount++}},e.countTrace=function(t){if(!!e.isEnabled()){var r=e._getAggregatedCounter(t,this._traceCountersCollection);r.totalCount++}},e.countRequest=function(t,r){if(!!e.isEnabled()){var n,i=e._getAggregatedCounter(r,this._requestCountersCollection);if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;i.intervalExecutionTime+=n,i.totalCount++}},e.countDependency=function(t,r){if(!!e.isEnabled()){var n=e._getAggregatedCounter(r,this._dependencyCountersCollection),i;if(typeof t=="string")i=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")i=t;else return;n.intervalExecutionTime+=i,n.totalCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},e._getAggregatedCounter=function(t,r){for(var n=!1,i=0;i<r.length;i++){if(t===r[i].dimensions)return r[i];if(Object.keys(t).length===Object.keys(r[i].dimensions).length){for(var a in t)if(t[a]!=r[i].dimensions[a]){n=!0;break}if(!n)return r[i];n=!1}}var s=new JP.AggregatedMetricCounter(t);return r.push(s),s},e.prototype._trackRequestMetrics=function(){for(var t=0;t<e._requestCountersCollection.length;t++){var r=e._requestCountersCollection[t];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,i=r.time-r.lastTime,a=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/n||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,i>0&&n>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:r.dimensions,value:a,count:n,aggregationInterval:i,metricType:Fs.MetricId.REQUESTS_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackDependencyMetrics=function(){for(var t=0;t<e._dependencyCountersCollection.length;t++){var r=e._dependencyCountersCollection[t];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,i=r.time-r.lastTime,a=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/n||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,i>0&&n>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:r.dimensions,value:a,count:n,aggregationInterval:i,metricType:Fs.MetricId.DEPENDENCIES_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackExceptionMetrics=function(){for(var t=0;t<e._exceptionCountersCollection.length;t++){var r=e._exceptionCountersCollection[t],n=r.totalCount-r.lastTotalCount||0,i=r.time-r.lastTime;this._trackPreAggregatedMetric({name:"Exceptions",dimensions:r.dimensions,value:n,count:n,aggregationInterval:i,metricType:Fs.MetricId.EXCEPTIONS_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackTraceMetrics=function(){for(var t=0;t<e._traceCountersCollection.length;t++){var r=e._traceCountersCollection[t],n=r.totalCount-r.lastTotalCount||0,i=r.time-r.lastTime;this._trackPreAggregatedMetric({name:"Traces",dimensions:r.dimensions,value:n,count:n,aggregationInterval:i,metricType:Fs.MetricId.TRACES_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackPreAggregatedMetric=function(t){var r={};for(var n in t.dimensions)r[eR.PreaggregatedMetricPropertyNames[n]]=t.dimensions[n];r=Gs(Gs({},r),{"_MS.MetricId":t.metricType,"_MS.AggregationIntervalMs":String(t.aggregationInterval),"_MS.IsAutocollected":"True"});var i={name:t.name,value:t.value,count:t.count,properties:r,kind:"Aggregation"};this._client.trackMetric(i)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e}();xv.exports=tR});var bi=l((qM,jv)=>{"use strict";var gt=require("os"),Lv=require("fs"),qv=require("path"),rR=Ee(),kv=ne(),nR=function(){function e(t){this.keys=new rR.ContextTagKeys,this.tags={},this._loadApplicationContext(t),this._loadDeviceContext(),this._loadInternalContext()}return e.prototype._loadApplicationContext=function(t){if(t=t||qv.resolve(__dirname,"../../../../package.json"),!e.appVersion[t]){e.appVersion[t]="unknown";try{var r=JSON.parse(Lv.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.appVersion[t]=r.version)}catch(n){kv.info("unable to read app version: ",n)}}this.tags[this.keys.applicationVersion]=e.appVersion[t]},e.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=gt&&gt.hostname(),this.tags[this.keys.deviceOSVersion]=gt&&gt.type()+" "+gt.release(),this.tags[this.keys.cloudRole]=e.DefaultRoleName,this.tags["ai.device.osArchitecture"]=gt&&gt.arch(),this.tags["ai.device.osPlatform"]=gt&&gt.platform()},e.prototype._loadInternalContext=function(){var t=qv.resolve(__dirname,"../../package.json");if(!e.sdkVersion){e.sdkVersion="unknown";try{var r=JSON.parse(Lv.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.sdkVersion=r.version)}catch(n){kv.info("unable to read app version: ",n)}}this.tags[this.keys.internalSdkVersion]="node:"+e.sdkVersion},e.DefaultRoleName="Web",e.appVersion={},e.sdkVersion=null,e}();jv.exports=nR});var Uv=l((Kc,Hv)=>{"use strict";var iR=Kc&&Kc.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$e=require("url"),zc=Ee(),aR=Ie(),sR=un(),oR=ac(),uR=vr(),cR=function(e){iR(t,e);function t(r,n){var i=e.call(this)||this;return n&&n.method&&r&&(i.method=n.method,i.url=t._getUrlFromRequestOptions(r,n),i.startTime=+new Date),i}return t.prototype.onError=function(r){this._setStatus(void 0,r)},t.prototype.onResponse=function(r){this._setStatus(r.statusCode,void 0),this.correlationId=aR.getCorrelationContextTarget(r,sR.requestContextTargetKey)},t.prototype.getDependencyTelemetry=function(r,n){var i=$e.parse(this.url);i.search=void 0,i.hash=void 0;var a=this.method.toUpperCase()+" "+i.pathname,s=zc.RemoteDependencyDataConstants.TYPE_HTTP,o=i.hostname;i.port&&(o+=":"+i.port),this.correlationId?(s=zc.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==uR.correlationIdPrefix&&(o+=" | "+this.correlationId)):s=zc.RemoteDependencyDataConstants.TYPE_HTTP;var u={id:n,name:a,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:s,target:o};if(r&&r.time?u.time=r.time:this.startTime&&(u.time=new Date(this.startTime)),r){for(var c in r)u[c]||(u[c]=r[c]);if(r.properties)for(var c in r.properties)u.properties[c]=r.properties[c]}return u},t._getUrlFromRequestOptions=function(r,n){if(typeof r=="string")if(r.indexOf("http://")===0||r.indexOf("https://")===0)r=$e.parse(r);else{var i=$e.parse(r);i.host==="443"?r=$e.parse("https://"+r):r=$e.parse("http://"+r)}else{if(r&&typeof $e.URL=="function"&&r instanceof $e.URL)return $e.format(r);var a=r;r={},a&&Object.keys(a).forEach(function(u){r[u]=a[u]})}if(r.path){var s=$e.parse(r.path);r.pathname=s.pathname,r.search=s.search}if(r.host&&r.port){var o=$e.parse("http://"+r.host);!o.port&&r.port&&(r.hostname=r.host,delete r.host)}return r.protocol=r.protocol||n.agent&&n.agent.protocol||n.protocol||void 0,r.hostname=r.hostname||"localhost",$e.format(r)},t}(oR);Hv.exports=cR});var Bv=l(yn=>{"use strict";var Ii=yn&&yn.__assign||function(){return Ii=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ii.apply(this,arguments)};Object.defineProperty(yn,"__esModule",{value:!0});yn.spanToTelemetryContract=void 0;var lR=w(),Ae=_t();function Yc(e){var t=Ii({},e);return Object.keys(Ae.SpanAttribute).forEach(function(r){delete t[r]}),t}function pR(e){var t="|"+e.spanContext().traceId+"."+e.spanContext().spanId+".",r=Math.round(e._duration[0]*1e3+e._duration[1]/1e6),n=e.attributes["peer.address"]?e.attributes["peer.address"].toString():"",i=e.attributes.component?e.attributes.component.toString():"",a=i.toUpperCase()===Ae.DependencyTypeName.Http||!!e.attributes[Ae.SpanAttribute.HttpUrl],s=i.toLowerCase()===Ae.DependencyTypeName.Grpc;if(a){var o=e.attributes[Ae.SpanAttribute.HttpMethod]||"GET",u=new URL(e.attributes[Ae.SpanAttribute.HttpUrl].toString()),c=e.attributes[Ae.SpanAttribute.HttpHost]||u.host,p=e.attributes[Ae.SpanAttribute.HttpPort]||u.port||null,d=u.pathname||"/",f=o+" "+d,_=Ae.DependencyTypeName.Http,g=p?(c+":"+p).toString():c.toString(),y=u.toString(),R=e.attributes[Ae.SpanAttribute.HttpStatusCode]||e.status.code||0,K=R<400;return{id:t,name:f,dependencyTypeName:_,target:g,data:y,success:K,duration:r,url:y,resultCode:String(R),properties:Yc(e.attributes)}}else if(s){var o=e.attributes[Ae.SpanAttribute.GrpcMethod]||"rpc",le=e.attributes[Ae.SpanAttribute.GrpcService],nt=le?o+" "+le:e.name;return{id:t,duration:r,name:nt,target:le.toString(),data:le.toString()||nt,url:le.toString()||nt,dependencyTypeName:Ae.DependencyTypeName.Grpc,resultCode:String(e.status.code||0),success:e.status.code===0,properties:Yc(e.attributes)}}else{var Or=e.name,xn=e.links&&e.links.map(function(Pr){return{operation_Id:Pr.context.traceId,id:Pr.context.spanId}});return{id:t,duration:r,name:Or,target:n,data:n||Or,url:n||Or,dependencyTypeName:e.kind===lR.SpanKind.INTERNAL?Ae.DependencyTypeName.InProc:i||e.name,resultCode:String(e.status.code||0),success:e.status.code===0,properties:Ii(Ii({},Yc(e.attributes)),{"_MS.links":xn||void 0})}}}yn.spanToTelemetryContract=pR});var Vv=l(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.enable=jt.subscriber=void 0;var Xc=w(),Gv=Y(),Fv=li(),dR=Bv(),fR=io(),Tn=[],hR=function(e){var t=e.data,r=dR.spanToTelemetryContract(t),n=t.spanContext(),i=new Fv;i.traceId=n.traceId,i.spanId=n.spanId,i.traceFlag=Fv.formatOpenTelemetryTraceFlags(n.traceFlags),i.parentId=t.parentSpanId?"|"+n.traceId+"."+t.parentSpanId+".":null,fR.AsyncScopeManager.with(t,function(){Tn.forEach(function(a){t.kind===Xc.SpanKind.SERVER?a.trackRequest(r):(t.kind===Xc.SpanKind.CLIENT||t.kind===Xc.SpanKind.INTERNAL)&&a.trackDependency(r)})})};jt.subscriber=hR;function _R(e,t){e?(Tn.length===0&&Gv.channel.subscribe("azure-coretracing",jt.subscriber),Tn.push(t)):(Tn=Tn.filter(function(r){return r!=t}),Tn.length===0&&Gv.channel.unsubscribe("azure-coretracing",jt.subscriber))}jt.enable=_R});var zv=l(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.enable=Ht.subscriber=void 0;var $v=Y(),Sn=[],gR=function(e){e.data.event.commandName!=="ismaster"&&Sn.forEach(function(t){var r=e.data.startedData&&e.data.startedData.databaseName||"Unknown database";t.trackDependency({target:r,data:e.data.event.commandName,name:e.data.event.commandName,duration:e.data.event.duration,success:e.data.succeeded,resultCode:e.data.succeeded?"0":"1",time:e.data.startedData.time,dependencyTypeName:"mongodb"})})};Ht.subscriber=gR;function vR(e,t){e?(Sn.length===0&&$v.channel.subscribe("mongodb",Ht.subscriber),Sn.push(t)):(Sn=Sn.filter(function(r){return r!=t}),Sn.length===0&&$v.channel.unsubscribe("mongodb",Ht.subscriber))}Ht.enable=vR});var Yv=l(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.enable=Ut.subscriber=void 0;var Kv=Y(),An=[],ER=function(e){An.forEach(function(t){var r=e.data.query||{},n=r.sql||"Unknown query",i=!e.data.err,a=r._connection||{},s=a.config||{},o=s.socketPath?s.socketPath:(s.host||"localhost")+":"+s.port;t.trackDependency({target:o,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"mysql"})})};Ut.subscriber=ER;function mR(e,t){e?(An.length===0&&Kv.channel.subscribe("mysql",Ut.subscriber),An.push(t)):(An=An.filter(function(r){return r!=t}),An.length===0&&Kv.channel.unsubscribe("mysql",Ut.subscriber))}Ut.enable=mR});var Qv=l(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.enable=Bt.subscriber=void 0;var Xv=Y(),bn=[],yR=function(e){bn.forEach(function(t){e.data.commandObj.command!=="info"&&t.trackDependency({target:e.data.address,name:e.data.commandObj.command,data:e.data.commandObj.command,duration:e.data.duration,success:!e.data.err,resultCode:e.data.err?"1":"0",time:e.data.time,dependencyTypeName:"redis"})})};Bt.subscriber=yR;function TR(e,t){e?(bn.length===0&&Xv.channel.subscribe("redis",Bt.subscriber),bn.push(t)):(bn=bn.filter(function(r){return r!=t}),bn.length===0&&Xv.channel.unsubscribe("redis",Bt.subscriber))}Bt.enable=TR});var Zv=l(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.enable=Gt.subscriber=void 0;var Wv=Y(),In=[],SR=function(e){In.forEach(function(t){var r=e.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",i=!e.data.error,a=e.data.database.host+":"+e.data.database.port;t.trackDependency({target:a,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"postgres"})})};Gt.subscriber=SR;function AR(e,t){e?(In.length===0&&Wv.channel.subscribe("postgres",Gt.subscriber),In.push(t)):(In=In.filter(function(r){return r!=t}),In.length===0&&Wv.channel.unsubscribe("postgres",Gt.subscriber))}Gt.enable=AR});var Pn=l((Zc,rE)=>{"use strict";var Vs=Zc&&Zc.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n},Cn=require("http"),On=require("https"),Qc=ne(),Jv=Ie(),Ft=un(),bR=Uv(),eE=$t(),tE=vr(),Wc=li(),IR=ms(),CR=function(){function e(t){if(e.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,this._isEnabled&&!this._isInitialized&&this._initialize(),IR.IsInitialized&&(Vv().enable(!0,this._client),zv().enable(t,this._client),Yv().enable(t,this._client),Qv().enable(t,this._client),Zv().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=Cn.request,n=On.request,i=function(a,s){var o=!s[e.disableCollectionRequestOption]&&!a[e.alreadyAutoCollectedFlag];s.headers&&s.headers["user-agent"]&&s.headers["user-agent"].toString().indexOf("azsdk-js")!==-1&&(o=!1),a[e.alreadyAutoCollectedFlag]=!0,a&&s&&o&&(eE.CorrelationContextManager.wrapEmitter(a),e.trackRequest(t._client,{options:s,request:a}))};Cn.request=function(a){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];var u=r.call.apply(r,Vs([Cn,a],s));return i(u,a),u},On.request=function(a){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];var u=n.call.apply(n,Vs([On,a],s));return i(u,a),u},Cn.get=function(a){for(var s,o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=(s=Cn.request).call.apply(s,Vs([Cn,a],o));return c.end(),c},On.get=function(a){for(var s,o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=(s=On.request).call.apply(s,Vs([On,a],o));return c.end(),c}},e.trackRequest=function(t,r){if(!r.options||!r.request||!t){Qc.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!t);return}var n=new bR(r.options,r.request),i=eE.CorrelationContextManager.getCurrentContext(),a,s;if(i&&i.operation&&i.operation.traceparent&&Wc.isValidTraceId(i.operation.traceparent.traceId))i.operation.traceparent.updateSpanId(),a=i.operation.traceparent.getBackCompatRequestId();else if(tE.w3cEnabled){var o=new Wc;s=o.toString(),a=o.getBackCompatRequestId()}else a=i&&i.operation&&i.operation.parentId+e.requestNumber+++".";if(Jv.canIncludeCorrelationHeader(t,n.getUrl())&&r.request.getHeader&&r.request.setHeader&&t.config&&t.config.correlationId){var u=r.request.getHeader(Ft.requestContextHeader);try{Jv.safeIncludeCorrelationHeader(t,r.request,u)}catch(d){Qc.warn("Request-Context header could not be set. Correlation of requests may be lost",d)}if(i&&i.operation)try{if(r.request.setHeader(Ft.requestIdHeader,a),t.config.ignoreLegacyHeaders||(r.request.setHeader(Ft.parentIdHeader,i.operation.id),r.request.setHeader(Ft.rootIdHeader,a)),s||i.operation.traceparent)r.request.setHeader(Ft.traceparentHeader,s||i.operation.traceparent.toString());else if(tE.w3cEnabled){var o=new Wc().toString();r.request.setHeader(Ft.traceparentHeader,o)}if(i.operation.tracestate){var c=i.operation.tracestate.toString();c&&r.request.setHeader(Ft.traceStateHeader,c)}var p=i.customProperties.serializeToHeader();p&&r.request.setHeader(Ft.correlationContextHeader,p)}catch(d){Qc.warn("Correlation headers could not be set. Correlation of requests may be lost.",d)}}r.request.on&&(r.request.on("response",function(d){n.onResponse(d);var f=n.getDependencyTelemetry(r,a);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects["http.ClientResponse"]=d,t.trackDependency(f)}),r.request.on("error",function(d){n.onError(d);var f=n.getDependencyTelemetry(r,a);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects.Error=d,t.trackDependency(f)}),r.request.on("abort",function(){n.onError(new Error);var d=n.getDependencyTelemetry(r,a);d.contextObjects=d.contextObjects||{},d.contextObjects["http.RequestOptions"]=r.options,d.contextObjects["http.ClientRequest"]=r.request,t.trackDependency(d)}))},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.disableCollectionRequestOption="disableAppInsightsAutoCollection",e.requestNumber=1,e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();rE.exports=CR});var aE=l((FM,iE)=>{"use strict";var OR=require("os"),nE=_t(),PR=Ie(),RR=bi(),NR=Pn(),DR="http://169.254.169.254/metadata/instance/compute",wR="api-version=2017-12-01",MR="format=json",xR="ENETUNREACH",LR=function(){function e(t){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._handle=setInterval(function(){return n.trackHeartBeat(r,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackHeartBeat=function(t,r){var n=this,i=!1,a={},s=RR.sdkVersion;a.sdk=s,a.osType=OR.type(),process.env.WEBSITE_SITE_NAME?(a.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",a.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",a.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?a.azfunction_appId=process.env.WEBSITE_HOSTNAME:t&&(this._isVM===void 0?(i=!0,this._getAzureComputeMetadata(t,function(){n._isVM&&Object.keys(n._vmData).length>0&&(a.azInst_vmId=n._vmData.vmId||"",a.azInst_subscriptionId=n._vmData.subscriptionId||"",a.azInst_osType=n._vmData.osType||"",n._azInst_vmId=n._vmData.vmId||"",n._azInst_subscriptionId=n._vmData.subscriptionId||"",n._azInst_osType=n._vmData.osType||""),n._client.trackMetric({name:nE.HeartBeatMetricName,value:0,properties:a}),r()})):this._isVM&&(a.azInst_vmId=this._azInst_vmId,a.azInst_subscriptionId=this._azInst_subscriptionId,a.azInst_osType=this._azInst_osType)),i||(this._client.trackMetric({name:nE.HeartBeatMetricName,value:0,properties:a}),r())},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.prototype._getAzureComputeMetadata=function(t,r){var n,i=this,a=DR+"?"+wR+"&"+MR,s=(n={method:"GET"},n[NR.disableCollectionRequestOption]=!0,n.headers={Metadata:"True"},n),o=PR.makeRequest(t,a,s,function(u){if(u.statusCode===200){i._isVM=!0;var c="";u.on("data",function(p){c+=p}),u.on("end",function(){i._vmData=i._isJSON(c)?JSON.parse(c):{},r()})}else r()});o&&(o.on("error",function(u){u&&u.message&&u.message.indexOf(xR)>-1&&(i._isVM=!1),r()}),o.end())},e.prototype._isJSON=function(t){try{return JSON.parse(t)&&!!t}catch(r){return!1}},e}();iE.exports=LR});var el=l((VM,lE)=>{"use strict";var sE=require("http"),oE=require("https"),uE=ne(),cE=Ie(),qR=un(),Jc=uc(),vt=$t(),kR=Hs(),jR=function(){function e(t){if(e.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,(this._isAutoCorrelating||this._isEnabled||kR.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},e.prototype.useAutoCorrelation=function(t,r){t&&!this._isAutoCorrelating?vt.CorrelationContextManager.enable(r):!t&&this._isAutoCorrelating&&vt.CorrelationContextManager.disable(),this._isAutoCorrelating=t},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},e.prototype._generateCorrelationContext=function(t){if(!!this._isAutoCorrelating)return vt.CorrelationContextManager.generateContextObject(t.getOperationId(this._client.context.tags),t.getRequestId(),t.getOperationName(this._client.context.tags),t.getCorrelationContextHeader(),t.getTraceparent(),t.getTracestate())},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=function(s){if(!!s){if(typeof s!="function")throw new Error("onRequest handler must be a function");return function(o,u){vt.CorrelationContextManager.wrapEmitter(o),vt.CorrelationContextManager.wrapEmitter(u);var c=o&&!o[e.alreadyAutoCollectedFlag];if(o&&c){var p=new Jc(o),d=t._generateCorrelationContext(p);vt.CorrelationContextManager.runWithContext(d,function(){t._isEnabled&&(o[e.alreadyAutoCollectedFlag]=!0,e.trackRequest(t._client,{request:o,response:u},p)),typeof s=="function"&&s(o,u)})}else typeof s=="function"&&s(o,u)}}},n=function(s){var o=s.addListener.bind(s);s.addListener=function(u,c){switch(u){case"request":case"checkContinue":return o(u,r(c));default:return o(u,c)}},s.on=s.addListener},i=sE.createServer;sE.createServer=function(s,o){if(o&&typeof o=="function"){var u=i(s,r(o));return n(u),u}else{var u=i(r(s));return n(u),u}};var a=oE.createServer;oE.createServer=function(s,o){var u=a(s,r(o));return n(u),u}},e.trackRequestSync=function(t,r){if(!r.request||!r.response||!t){uE.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!t);return}e.addResponseCorrelationIdHeader(t,r.response);var n=vt.CorrelationContextManager.getCurrentContext(),i=new Jc(r.request,n&&n.operation.parentId);n&&(n.operation.id=i.getOperationId(t.context.tags)||n.operation.id,n.operation.name=i.getOperationName(t.context.tags)||n.operation.name,n.operation.parentId=i.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(i.getCorrelationContextHeader())),e.endRequest(t,i,r,r.duration,r.error)},e.trackRequest=function(t,r,n){if(!r.request||!r.response||!t){uE.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!t);return}var i=vt.CorrelationContextManager.getCurrentContext(),a=n||new Jc(r.request,i&&i.operation.parentId);cE.canIncludeCorrelationHeader(t,a.getUrl())&&e.addResponseCorrelationIdHeader(t,r.response),i&&!n&&(i.operation.id=a.getOperationId(t.context.tags)||i.operation.id,i.operation.name=a.getOperationName(t.context.tags)||i.operation.name,i.operation.parentId=a.getOperationParentId(t.context.tags)||i.operation.parentId,i.customProperties.addHeaderData(a.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",function(){e.endRequest(t,a,r,null,null)}),r.request.on&&r.request.on("error",function(s){e.endRequest(t,a,r,null,s)}),r.request.on&&r.request.on("aborted",function(){var s="The request has been aborted and the network socket has closed.";e.endRequest(t,a,r,null,s)})},e.addResponseCorrelationIdHeader=function(t,r){if(t.config&&t.config.correlationId&&r.getHeader&&r.setHeader&&!r.headersSent){var n=r.getHeader(qR.requestContextHeader);cE.safeIncludeCorrelationHeader(t,r,n)}},e.endRequest=function(t,r,n,i,a){a?r.onError(a,i):r.onResponse(n.response,i);var s=r.getRequestTelemetry(n);if(s.tagOverrides=r.getRequestTags(t.context.tags),n.tagOverrides)for(var o in n.tagOverrides)s.tagOverrides[o]=n.tagOverrides[o];var u=r.getLegacyRootId();u&&(s.properties.ai_legacyRootId=u),s.contextObjects=s.contextObjects||{},s.contextObjects["http.ServerRequest"]=n.request,s.contextObjects["http.ServerResponse"]=n.response,t.trackRequest(s)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1,vt.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();lE.exports=jR});var fE=l((rl,dE)=>{"use strict";var qe=rl&&rl.__assign||function(){return qe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},qe.apply(this,arguments)},tl=require("os"),br=Ee(),pE=_t(),HR=Ie(),UR=ne(),BR=HR.w3cTraceId(),GR=function(){function e(){}return e.createQuickPulseEnvelope=function(t,r,n,i){var a=tl&&typeof tl.hostname=="function"&&tl.hostname()||"Unknown",s=i.tags&&i.keys&&i.keys.cloudRoleInstance&&i.tags[i.keys.cloudRoleInstance]||a,o=i.tags&&i.keys&&i.keys.cloudRole&&i.tags[i.keys.cloudRole]||null,u={Documents:r.length>0?r:null,InstrumentationKey:n.instrumentationKey||"",Metrics:t.length>0?t:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:i.tags[i.keys.internalSdkVersion],StreamId:BR,MachineName:a,Instance:s,RoleName:o};return u},e.createQuickPulseMetric=function(t){var r;return r={Name:t.name,Value:t.value,Weight:t.count||1},r},e.telemetryEnvelopeToQuickPulseDocument=function(t){switch(t.data.baseType){case br.TelemetryTypeString.Event:return e.createQuickPulseEventDocument(t);case br.TelemetryTypeString.Exception:return e.createQuickPulseExceptionDocument(t);case br.TelemetryTypeString.Trace:return e.createQuickPulseTraceDocument(t);case br.TelemetryTypeString.Dependency:return e.createQuickPulseDependencyDocument(t);case br.TelemetryTypeString.Request:return e.createQuickPulseRequestDocument(t)}return null},e.createQuickPulseEventDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.name,i=qe(qe({},r),{Name:n});return i},e.createQuickPulseTraceDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.severityLevel||0,i=qe(qe({},r),{Message:t.data.baseData.message,SeverityLevel:br.SeverityLevel[n]});return i},e.createQuickPulseExceptionDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.exceptions,i="",a="",s="";n&&n.length>0&&(n[0].parsedStack&&n[0].parsedStack.length>0?n[0].parsedStack.forEach(function(u){i+=u.assembly+`
`}):n[0].stack&&n[0].stack.length>0&&(i=n[0].stack),a=n[0].message,s=n[0].typeName);var o=qe(qe({},r),{Exception:i,ExceptionMessage:a,ExceptionType:s});return o},e.createQuickPulseRequestDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=qe(qe({},r),{Name:n.name,Success:n.success,Duration:n.duration,ResponseCode:n.responseCode,OperationName:n.name});return i},e.createQuickPulseDependencyDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=qe(qe({},r),{Name:n.name,Target:n.target,Success:n.success,Duration:n.duration,ResultCode:n.resultCode,CommandName:n.data,OperationName:r.OperationId,DependencyTypeName:n.type});return i},e.createQuickPulseDocument=function(t){var r,n,i,a;t.data.baseType?(n=pE.TelemetryTypeStringToQuickPulseType[t.data.baseType],r=pE.TelemetryTypeStringToQuickPulseDocumentType[t.data.baseType]):UR.warn("Document type invalid; not sending live metric document",t.data.baseType),i=t.tags[e.keys.operationId],a=e.aggregateProperties(t);var s={DocumentType:r,__type:n,OperationId:i,Version:"1.0",Properties:a};return s},e.aggregateProperties=function(t){var r=[],n=t.data.baseData.measurements||{};for(var i in n)if(n.hasOwnProperty(i)){var a=n[i],s={key:i,value:a};r.push(s)}var o=t.data.baseData.properties||{};for(var i in o)if(o.hasOwnProperty(i)){var a=o[i],s={key:i,value:a};r.push(s)}return r},e.keys=new br.ContextTagKeys,e}();dE.exports=GR});var _E=l(($M,hE)=>{"use strict";var FR=function(){return(Date.now()+621355968e5)*1e4};hE.exports={getTransmissionTime:FR}});var yE=l((Ci,mE)=>{"use strict";var gE=Ci&&Ci.__awaiter||function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(p){try{c(n.next(p))}catch(d){s(d)}}function u(p){try{c(n.throw(p))}catch(d){s(d)}}function c(p){p.done?a(p.value):i(p.value).then(o,u)}c((n=n.apply(e,t||[])).next())})},vE=Ci&&Ci.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(c){return function(p){return u([c,p])}}function u(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){r.label=c[1];break}if(c[0]===6&&r.label<a[1]){r.label=a[1],a=c;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(c);break}a[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(p){c=[6,p],i=0}finally{n=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},VR=require("https"),$R=Pn(),EE=ne(),zR=_E(),KR=Ie(),ke={method:"POST",time:"x-ms-qps-transmission-time",pollingIntervalHint:"x-ms-qps-service-polling-interval-hint",endpointRedirect:"x-ms-qps-service-endpoint-redirect",instanceName:"x-ms-qps-instance-name",streamId:"x-ms-qps-stream-id",machineName:"x-ms-qps-machine-name",roleName:"x-ms-qps-role-name",streamid:"x-ms-qps-stream-id",invariantVersion:"x-ms-qps-invariant-version",subscribed:"x-ms-qps-subscribed"},YR=function(){function e(t){this._config=t,this._consecutiveErrors=0}return e.prototype.ping=function(t,r,n){var i=[{name:ke.streamId,value:t.StreamId},{name:ke.machineName,value:t.MachineName},{name:ke.roleName,value:t.RoleName},{name:ke.instanceName,value:t.Instance},{name:ke.invariantVersion,value:t.InvariantVersion.toString()}];this._submitData(t,r,n,"ping",i)},e.prototype.post=function(t,r,n){return gE(this,void 0,void 0,function(){return vE(this,function(i){switch(i.label){case 0:return[4,this._submitData([t],r,n,"post")];case 1:return i.sent(),[2]}})})},e.prototype._submitData=function(t,r,n,i,a){return gE(this,void 0,void 0,function(){var s,o,u,c,p,d=this;return vE(this,function(f){return s=JSON.stringify(t),o=(c={},c[$R.disableCollectionRequestOption]=!0,c.host=r&&r.length>0?r:this._config.quickPulseHost,c.method=ke.method,c.path="/QuickPulseService.svc/"+i+"?ikey="+this._config.instrumentationKey,c.headers=(p={Expect:"100-continue"},p[ke.time]=zR.getTransmissionTime(),p["Content-Type"]="application/json",p["Content-Length"]=Buffer.byteLength(s),p),c),a&&a.length>0&&a.forEach(function(_){return o.headers[_.name]=_.value}),this._config.httpsAgent?o.agent=this._config.httpsAgent:o.agent=KR.tlsRestrictedAgent,u=VR.request(o,function(_){if(_.statusCode==200){var g=_.headers[ke.subscribed]==="true",y=_.headers[ke.endpointRedirect]?_.headers[ke.endpointRedirect].toString():null,R=_.headers[ke.pollingIntervalHint]?parseInt(_.headers[ke.pollingIntervalHint].toString()):null;d._consecutiveErrors=0,n(g,_,y,R)}else d._onError("StatusCode:"+_.statusCode+" StatusMessage:"+_.statusMessage),n()}),u.on("error",function(_){d._onError(_),n()}),u.write(s),u.end(),[2]})})},e.prototype._onError=function(t){this._consecutiveErrors++;var r="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%e.MAX_QPS_FAILURES_BEFORE_WARN==0?(r="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",EE.warn(e.TAG,r,t)):EE.info(e.TAG,r,t)},e.TAG="QuickPulseSender",e.MAX_QPS_FAILURES_BEFORE_WARN=25,e}();mE.exports=YR});var IE=l((Oi,bE)=>{"use strict";var TE=Oi&&Oi.__awaiter||function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(p){try{c(n.next(p))}catch(d){s(d)}}function u(p){try{c(n.throw(p))}catch(d){s(d)}}function c(p){p.done?a(p.value):i(p.value).then(o,u)}c((n=n.apply(e,t||[])).next())})},SE=Oi&&Oi.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(c){return function(p){return u([c,p])}}function u(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){r.label=c[1];break}if(c[0]===6&&r.label<a[1]){r.label=a[1],a=c;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(c);break}a[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(p){c=[6,p],i=0}finally{n=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},AE=ne(),nl=fE(),XR=yE(),QR=_t(),WR=bi(),ZR=function(){function e(t,r){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=t,this.context=r||new WR,this._sender=new XR(this.config),this._isEnabled=!1}return e.prototype.addCollector=function(t){this._collectors.push(t)},e.prototype.trackMetric=function(t){this._addMetric(t)},e.prototype.addDocument=function(t){var r=nl.telemetryEnvelopeToQuickPulseDocument(t);r&&this._documents.push(r)},e.prototype.enable=function(t){t&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!t&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},e.prototype.enableCollectors=function(t){this._collectors.forEach(function(r){r.enable(t)})},e.prototype._addMetric=function(t){var r=t.value,n=t.count||1,i=QR.PerformanceToQuickPulseCounter[t.name];i&&(this._metrics[i]?(this._metrics[i].Value=(this._metrics[i].Value*this._metrics[i].Weight+r*n)/(this._metrics[i].Weight+n),this._metrics[i].Weight+=n):(this._metrics[i]=nl.createQuickPulseMetric(t),this._metrics[i].Name=i,this._metrics[i].Weight=1))},e.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},e.prototype._goQuickPulse=function(){return TE(this,void 0,void 0,function(){var t,r,n,i,a=this;return SE(this,function(s){switch(s.label){case 0:return t=Object.keys(this._metrics).map(function(o){return a._metrics[o]}),r=nl.createQuickPulseEnvelope(t,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(r)]:[3,2];case 1:return s.sent(),[3,3];case 2:this._ping(r),s.label=3;case 3:return n=this._pollingIntervalHint>0?this._pollingIntervalHint:e.PING_INTERVAL,i=this._isCollectingData?e.POST_INTERVAL:n,this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,i=e.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(i=e.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),i),this._handle.unref(),[2]}})})},e.prototype._ping=function(t){this._sender.ping(t,this._redirectedHost,this._quickPulseDone.bind(this))},e.prototype._post=function(t){return TE(this,void 0,void 0,function(){return SE(this,function(r){switch(r.label){case 0:return[4,this._sender.post(t,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return r.sent(),[2]}})})},e.prototype._quickPulseDone=function(t,r,n,i){t!=null?(this._isCollectingData!==t&&(AE.info("Live Metrics sending data",t),this.enableCollectors(t)),this._isCollectingData=t,n&&n.length>0&&(this._redirectedHost=n,AE.info("Redirecting endpoint to: ",n)),i&&i>0&&(this._pollingIntervalHint=i),r&&r.statusCode<300&&r.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},e.MAX_POST_WAIT_TIME=2e4,e.MAX_PING_WAIT_TIME=6e4,e.FALLBACK_INTERVAL=6e4,e.PING_INTERVAL=5e3,e.POST_INTERVAL=1e3,e}();bE.exports=ZR});var PE=l((zM,OE)=>{"use strict";var CE=_t(),JR=function(){function e(){}return e.parse=function(t){if(!t)return{};var r=t.split(e._FIELDS_SEPARATOR),n=r.reduce(function(a,s){var o=s.split(e._FIELD_KEY_VALUE_SEPARATOR);if(o.length===2){var u=o[0].toLowerCase(),c=o[1];a[u]=c}return a},{});if(Object.keys(n).length>0){if(n.endpointsuffix){var i=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+i+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+i+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||CE.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||CE.DEFAULT_LIVEMETRICS_ENDPOINT}return n},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}();OE.exports=JR});var al=l((KM,DE)=>{"use strict";var il=vr(),RE=PE(),eN=ne(),NE=_t(),tN=require("url"),rN=function(){function e(t){var r=this;this.endpointBase=NE.DEFAULT_BREEZE_ENDPOINT;var n=process.env[e.ENV_connectionString],i=RE.parse(t),a=RE.parse(n),s=!i.instrumentationkey&&Object.keys(i).length>0?null:t;this.instrumentationKey=i.instrumentationkey||s||a.instrumentationkey||e._getInstrumentationKey(),e._validateInstrumentationKey(this.instrumentationKey)||eN.warn("An invalid instrumentation key was provided. There may be resulting telemetry loss",this.instrumentationKey),this.endpointUrl=(i.ingestionendpoint||a.ingestionendpoint||this.endpointBase)+"/v2.1/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(o){return r.correlationId=o},this.proxyHttpUrl=process.env[e.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[e.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=i.ingestionendpoint||a.ingestionendpoint||process.env[e.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=i.liveendpoint||a.liveendpoint||process.env[e.ENV_quickPulseHost]||NE.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=tN.parse(this._quickPulseHost).host)}return Object.defineProperty(e.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(t){il.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=t,this.correlationId=il.correlationIdPrefix,il.queryCorrelationId(this,this.setCorrelationId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(t){this._quickPulseHost=t},enumerable:!1,configurable:!0}),e._getInstrumentationKey=function(){var t=process.env[e.ENV_iKey]||process.env[e.ENV_azurePrefix+e.ENV_iKey]||process.env[e.legacy_ENV_iKey]||process.env[e.ENV_azurePrefix+e.legacy_ENV_iKey];if(!t||t=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return t},e._validateInstrumentationKey=function(t){var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(t)},e.ENV_azurePrefix="APPSETTING_",e.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",e.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",e.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",e.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",e.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",e.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",e.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",e.ENV_http_proxy="http_proxy",e.ENV_https_proxy="https_proxy",e}();DE.exports=rN});var ME=l(Rn=>{"use strict";var $s=Rn&&Rn.__assign||function(){return $s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},$s.apply(this,arguments)};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.AutoCollectNativePerformance=void 0;var wE=al(),Pi=bi(),nN=ne(),iN=function(){function e(t){this._disabledMetrics={},e.INSTANCE&&e.INSTANCE.dispose(),e.INSTANCE=this,this._client=t}return e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>=6},e.prototype.enable=function(t,r,n){var i=this;if(r===void 0&&(r={}),n===void 0&&(n=6e4),!!e.isNodeVersionCompatible()){if(e._metricsAvailable==null&&t&&!this._isInitialized)try{var a=require("applicationinsights-native-metrics");e._emitter=new a,e._metricsAvailable=!0,nN.info("Native metrics module successfully loaded!")}catch(s){e._metricsAvailable=!1;return}this._isEnabled=t,this._disabledMetrics=r,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&e._emitter?(e._emitter.enable(!0,n),this._handle||(this._handle=setInterval(function(){return i._trackNativeMetrics()},n),this._handle.unref())):e._emitter&&(e._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},e.prototype.dispose=function(){this.enable(!1)},e.parseEnabled=function(t){var r=process.env[wE.ENV_nativeMetricsDisableAll],n=process.env[wE.ENV_nativeMetricsDisablers];if(r)return{isEnabled:!1,disabledMetrics:{}};if(n){var i=n.split(","),a={};if(i.length>0)for(var s=0,o=i;s<o.length;s++){var u=o[s];a[u]=!0}return typeof t=="object"?{isEnabled:!0,disabledMetrics:$s($s({},t),a)}:{isEnabled:t,disabledMetrics:a}}return typeof t=="boolean"?{isEnabled:t,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:t}},e.prototype._trackNativeMetrics=function(){var t=!0;typeof this._isEnabled!="object"&&(t=this._isEnabled),t&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},e.prototype._trackGarbageCollection=function(){var t;if(!this._disabledMetrics.gc){var r=e._emitter.getGCData();for(var n in r){var i=r[n].metrics,a=n+" Garbage Collection Duration",s=Math.sqrt(i.sumSquares/i.count-Math.pow(i.total/i.count,2))||0;this._client.trackMetric({name:a,value:i.total,count:i.count,max:i.max,min:i.min,stdDev:s,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Pi.sdkVersion,t)})}}},e.prototype._trackEventLoop=function(){var t;if(!this._disabledMetrics.loop){var r=e._emitter.getLoopData(),n=r.loopUsage;if(n.count!=0){var i="Event Loop CPU Time",a=Math.sqrt(n.sumSquares/n.count-Math.pow(n.total/n.count,2))||0;this._client.trackMetric({name:i,value:n.total,count:n.count,min:n.min,max:n.max,stdDev:a,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Pi.sdkVersion,t)})}}},e.prototype._trackHeapUsage=function(){var t,r,n;if(!this._disabledMetrics.heap){var i=process.memoryUsage(),a=i.heapUsed,s=i.heapTotal,o=i.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:a,count:1,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Pi.sdkVersion,t)}),this._client.trackMetric({name:"Memory Total (Heap)",value:s,count:1,tagOverrides:(r={},r[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Pi.sdkVersion,r)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:o-s,count:1,tagOverrides:(n={},n[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Pi.sdkVersion,n)})}},e}();Rn.AutoCollectNativePerformance=iN});var LE=l((XM,xE)=>{"use strict";var aN=ne(),sN=function(){function e(t,r,n,i){this._buffer=[],this._lastSend=0,this._isDisabled=t,this._getBatchSize=r,this._getBatchIntervalMs=n,this._sender=i}return e.prototype.setUseDiskRetryCaching=function(t,r,n){this._sender.setDiskRetryMode(t,r,n)},e.prototype.send=function(t){var r=this;if(!this._isDisabled()){if(!t){aN.warn("Cannot send null/undefined telemetry");return}if(this._buffer.push(t),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){r._timeoutHandle=null,r.triggerSend(!1)},this._getBatchIntervalMs()))}},e.prototype.triggerSend=function(t,r){var n=this._buffer.length<1;n||(t?(this._sender.saveOnCrash(this._buffer),typeof r=="function"&&r("data saved on crash")):this._sender.send(this._buffer,r)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,n&&typeof r=="function"&&r("no data to send")},e}();xE.exports=sN});var qE=l(zs=>{"use strict";Object.defineProperty(zs,"__esModule",{value:!0});zs.azureRoleEnvironmentTelemetryProcessor=void 0;function oN(e,t){process.env.WEBSITE_SITE_NAME&&(e.tags[t.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}zs.azureRoleEnvironmentTelemetryProcessor=oN});var HE=l(Nn=>{"use strict";Object.defineProperty(Nn,"__esModule",{value:!0});Nn.getSamplingHashCode=Nn.samplingTelemetryProcessor=void 0;var kE=Ee();function uN(e,t){var r=e.sampleRate,n=!1;return r==null||r>=100||e.data&&kE.TelemetryType.Metric===kE.baseTypeToTelemetryType(e.data.baseType)?!0:(t.correlationContext&&t.correlationContext.operation?n=jE(t.correlationContext.operation.id)<r:n=Math.random()*100<r,n)}Nn.samplingTelemetryProcessor=uN;function jE(e){var t=-2147483648,r=2147483647,n=5381;if(!e)return 0;for(;e.length<8;)e=e+e;for(var i=0;i<e.length;i++)n=((n<<5)+n|0)+e.charCodeAt(i)|0;return n=n<=t?r:Math.abs(n),n/r*100}Nn.getSamplingHashCode=jE});var UE=l(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.performanceMetricsTelemetryProcessor=void 0;var sl=Hs(),ol=Ee();function cN(e,t){switch(t&&t.addDocument(e),e.data.baseType){case ol.TelemetryTypeString.Exception:sl.countException();break;case ol.TelemetryTypeString.Request:var r=e.data.baseData;sl.countRequest(r.duration,r.success);break;case ol.TelemetryTypeString.Dependency:var n=e.data.baseData;sl.countDependency(n.duration,n.success);break}return!0}Ks.performanceMetricsTelemetryProcessor=cN});var BE=l(Dn=>{"use strict";var et=Dn&&Dn.__assign||function(){return et=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},et.apply(this,arguments)};Object.defineProperty(Dn,"__esModule",{value:!0});Dn.preAggregatedMetricsTelemetryProcessor=void 0;var lN=Ee(),Ri=$c(),Ys=Ee();function pN(e,t){if(Ri.isEnabled())switch(e.data.baseType){case Ys.TelemetryTypeString.Exception:var r=e.data.baseData;r.properties=et(et({},r.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var n={cloudRoleInstance:e.tags[t.keys.cloudRoleInstance],cloudRoleName:e.tags[t.keys.cloudRole]};Ri.countException(n);break;case Ys.TelemetryTypeString.Trace:var i=e.data.baseData;i.properties=et(et({},i.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var a={cloudRoleInstance:e.tags[t.keys.cloudRoleInstance],cloudRoleName:e.tags[t.keys.cloudRole],traceSeverityLevel:lN.SeverityLevel[i.severity]};Ri.countTrace(a);break;case Ys.TelemetryTypeString.Request:var s=e.data.baseData;s.properties=et(et({},s.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var o={cloudRoleInstance:e.tags[t.keys.cloudRoleInstance],cloudRoleName:e.tags[t.keys.cloudRole],operationSynthetic:e.tags[t.keys.operationSyntheticSource],requestSuccess:s.success,requestResultCode:s.responseCode};Ri.countRequest(s.duration,o);break;case Ys.TelemetryTypeString.Dependency:var u=e.data.baseData;u.properties=et(et({},u.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var c={cloudRoleInstance:e.tags[t.keys.cloudRoleInstance],cloudRoleName:e.tags[t.keys.cloudRole],operationSynthetic:e.tags[t.keys.operationSyntheticSource],dependencySuccess:u.success,dependencyType:u.type,dependencyTarget:u.target,dependencyResultCode:u.resultCode};Ri.countDependency(u.duration,c);break}return!0}Dn.preAggregatedMetricsTelemetryProcessor=pN});var GE=l(tt=>{"use strict";var dN=tt&&tt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Xs=tt&&tt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&dN(t,e,r)};Object.defineProperty(tt,"__esModule",{value:!0});Xs(qE(),tt);Xs(HE(),tt);Xs(UE(),tt);Xs(BE(),tt)});var $E=l((Ni,VE)=>{"use strict";var fN=Ni&&Ni.__awaiter||function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(p){try{c(n.next(p))}catch(d){s(d)}}function u(p){try{c(n.throw(p))}catch(d){s(d)}}function c(p){p.done?a(p.value):i(p.value).then(o,u)}c((n=n.apply(e,t||[])).next())})},hN=Ni&&Ni.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(c){return function(p){return u([c,p])}}function u(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){r.label=c[1];break}if(c[0]===6&&r.label<a[1]){r.label=a[1],a=c;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(c);break}a[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(p){c=[6,p],i=0}finally{n=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},ae=require("fs"),FE=require("os"),Et=require("path"),_N=require("zlib"),wn=require("child_process"),se=ne(),gN=Pn(),Qs=Ie(),vN=function(){function e(t,r,n){if(this._redirectedHost=null,this._config=t,this._onSuccess=r,this._onError=n,this._enableDiskRetryMode=!1,this._resendInterval=e.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=e.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._fileCleanupTimer=null,this._tempDir=Et.join(FE.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey),!e.OS_PROVIDES_FILE_PROTECTION)if(e.USE_ICACLS){try{e.OS_PROVIDES_FILE_PROTECTION=ae.existsSync(e.ICACLS_PATH)}catch(i){}e.OS_PROVIDES_FILE_PROTECTION||se.warn(e.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else e.OS_PROVIDES_FILE_PROTECTION=!0}return e.prototype.setDiskRetryMode=function(t,r,n){var i=this;this._enableDiskRetryMode=e.OS_PROVIDES_FILE_PROTECTION&&t,typeof r=="number"&&r>=0&&(this._resendInterval=Math.floor(r)),typeof n=="number"&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),t&&!e.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,se.warn(e.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout(function(){i._fileCleanupTask()},e.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref()):this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer)},e.prototype.send=function(t,r){return fN(this,void 0,void 0,function(){var n,i,a,s,o=this;return hN(this,function(u){return t&&(n=this._redirectedHost||this._config.endpointUrl,i={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},a="",t.forEach(function(c){var p=o._stringify(c);typeof p=="string"&&(a+=p+`
`)}),a.length>0&&(a=a.substring(0,a.length-1)),s=Buffer.from?Buffer.from(a):new Buffer(a),_N.gzip(s,function(c,p){var d=p;c?(se.warn(c),d=s,i.headers["Content-Length"]=s.length.toString()):(i.headers["Content-Encoding"]="gzip",i.headers["Content-Length"]=p.length.toString()),se.info(e.TAG,i),i[gN.disableCollectionRequestOption]=!0;var f=function(g){g.setEncoding("utf-8");var y="";g.on("data",function(R){y+=R}),g.on("end",function(){if(o._numConsecutiveFailures=0,o._enableDiskRetryMode){if(g.statusCode===200)o._resendTimer||(o._resendTimer=setTimeout(function(){o._resendTimer=null,o._sendFirstFileOnDisk()},o._resendInterval),o._resendTimer.unref());else if(o._isRetriable(g.statusCode))try{var R=JSON.parse(y),K=[];R.errors.forEach(function(nt){o._isRetriable(nt.statusCode)&&K.push(t[nt.index])}),K.length>0&&o._storeToDisk(K)}catch(nt){o._storeToDisk(t)}}if(g.statusCode===307||g.statusCode===308)if(o._numConsecutiveRedirects++,o._numConsecutiveRedirects<10){var le=g.headers.location?g.headers.location.toString():null;le&&(o._redirectedHost=le,o.send(t,r))}else typeof r=="function"&&r("Error sending telemetry because of circular redirects.");else o._numConsecutiveRedirects=0,typeof r=="function"&&r(y),se.info(e.TAG,y),typeof o._onSuccess=="function"&&o._onSuccess(y)})},_=Qs.makeRequest(o._config,n,i,f);_.on("error",function(g){if(o._numConsecutiveFailures++,!o._enableDiskRetryMode||o._numConsecutiveFailures>0&&o._numConsecutiveFailures%e.MAX_CONNECTION_FAILURES_BEFORE_WARN==0){var y="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";o._enableDiskRetryMode&&(y="Ingestion endpoint could not be reached "+o._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),se.warn(e.TAG,y,Qs.dumpObj(g))}else{var y="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";se.info(e.TAG,y,Qs.dumpObj(g))}o._onErrorHelper(g),typeof r=="function"&&(g&&r(Qs.dumpObj(g)),r("Error sending telemetry")),o._enableDiskRetryMode&&o._storeToDisk(t)}),_.write(d),_.end()})),[2]})})},e.prototype.saveOnCrash=function(t){this._enableDiskRetryMode&&this._storeToDiskSync(this._stringify(t))},e.prototype._isRetriable=function(t){return t===206||t===408||t===429||t===439||t===500||t===503},e.prototype._runICACLS=function(t,r){var n=wn.spawn(e.ICACLS_PATH,t,{windowsHide:!0});n.on("error",function(i){return r(i)}),n.on("close",function(i,a){return r(i===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+i+")"))})},e.prototype._runICACLSSync=function(t){if(wn.spawnSync){var r=wn.spawnSync(e.ICACLS_PATH,t,{windowsHide:!0});if(r.error)throw r.error;if(r.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},e.prototype._getACLIdentity=function(t){if(e.ACL_IDENTITY)return t(null,e.ACL_IDENTITY);var r=wn.spawn(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),n="";r.stdout.on("data",function(i){return n+=i}),r.on("error",function(i){return t(i,null)}),r.on("close",function(i,a){return e.ACL_IDENTITY=n&&n.trim(),t(i===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+i+")"),e.ACL_IDENTITY)})},e.prototype._getACLIdentitySync=function(){if(e.ACL_IDENTITY)return e.ACL_IDENTITY;if(wn.spawnSync){var t=wn.spawnSync(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(t.error)throw t.error;if(t.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+t.status+")");return e.ACL_IDENTITY=t.stdout&&t.stdout.toString().trim(),e.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},e.prototype._getACLArguments=function(t,r){return[t,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",r+":(OI)(CI)F","/inheritance:r"]},e.prototype._applyACLRules=function(t,r){var n=this;if(!e.USE_ICACLS)return r(null);if(e.ACLED_DIRECTORIES[t]===void 0)e.ACLED_DIRECTORIES[t]=!1,this._getACLIdentity(function(i,a){if(i)return e.ACLED_DIRECTORIES[t]=!1,r(i);n._runICACLS(n._getACLArguments(t,a),function(s){return e.ACLED_DIRECTORIES[t]=!s,r(s)})});else return r(e.ACLED_DIRECTORIES[t]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},e.prototype._applyACLRulesSync=function(t){if(e.USE_ICACLS){if(e.ACLED_DIRECTORIES[t]===void 0){this._runICACLSSync(this._getACLArguments(t,this._getACLIdentitySync())),e.ACLED_DIRECTORIES[t]=!0;return}else if(!e.ACLED_DIRECTORIES[t])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},e.prototype._confirmDirExists=function(t,r){var n=this;ae.lstat(t,function(i,a){i&&i.code==="ENOENT"?ae.mkdir(t,function(s){s&&s.code!=="EEXIST"?r(s):n._applyACLRules(t,r)}):!i&&a.isDirectory()?n._applyACLRules(t,r):r(i||new Error("Path existed but was not a directory"))})},e.prototype._getShallowDirectorySize=function(t,r){ae.readdir(t,function(n,i){if(n)return r(n,-1);var a=null,s=0,o=0;if(i.length===0){r(null,0);return}for(var u=0;u<i.length;u++)ae.stat(Et.join(t,i[u]),function(c,p){o++,c?a=c:p.isFile()&&(s+=p.size),o===i.length&&(a?r(a,-1):r(a,s))})})},e.prototype._getShallowDirectorySizeSync=function(t){for(var r=ae.readdirSync(t),n=0,i=0;i<r.length;i++)n+=ae.statSync(Et.join(t,r[i])).size;return n},e.prototype._storeToDisk=function(t){var r=this;se.info(e.TAG,"Checking existence of data storage directory: "+this._tempDir),this._confirmDirExists(this._tempDir,function(n){if(n){se.warn(e.TAG,"Error while checking/creating directory: "+(n&&n.message)),r._onErrorHelper(n);return}r._getShallowDirectorySize(r._tempDir,function(i,a){if(i||a<0){se.warn(e.TAG,"Error while checking directory size: "+(i&&i.message)),r._onErrorHelper(i);return}else if(a>r._maxBytesOnDisk){se.warn(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+a);return}var s=new Date().getTime()+".ai.json",o=Et.join(r._tempDir,s);se.info(e.TAG,"saving data to disk at: "+o),ae.writeFile(o,r._stringify(t),{mode:384},function(u){return r._onErrorHelper(u)})})})},e.prototype._storeToDiskSync=function(t){try{se.info(e.TAG,"Checking existence of data storage directory: "+this._tempDir),ae.existsSync(this._tempDir)||ae.mkdirSync(this._tempDir),this._applyACLRulesSync(this._tempDir);var r=this._getShallowDirectorySizeSync(this._tempDir);if(r>this._maxBytesOnDisk){se.info(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+r);return}var n=new Date().getTime()+".ai.json",i=Et.join(this._tempDir,n);se.info(e.TAG,"saving data before crash to disk at: "+i),ae.writeFileSync(i,t,{mode:384})}catch(a){se.warn(e.TAG,"Error while saving data to disk: "+(a&&a.message)),this._onErrorHelper(a)}},e.prototype._sendFirstFileOnDisk=function(){var t=this;ae.exists(this._tempDir,function(r){r&&ae.readdir(t._tempDir,function(n,i){if(n)t._onErrorHelper(n);else if(i=i.filter(function(o){return Et.basename(o).indexOf(".ai.json")>-1}),i.length>0){var a=i[0],s=Et.join(t._tempDir,a);ae.readFile(s,function(o,u){o?t._onErrorHelper(o):ae.unlink(s,function(c){if(c)t._onErrorHelper(c);else try{var p=JSON.parse(u.toString());t.send(p)}catch(d){se.warn("Failed to read persisted file",d)}})})}})})},e.prototype._onErrorHelper=function(t){typeof this._onError=="function"&&this._onError(t)},e.prototype._stringify=function(t){try{return JSON.stringify(t)}catch(r){se.warn("Failed to serialize payload",r,t)}},e.prototype._fileCleanupTask=function(){var t=this;ae.exists(this._tempDir,function(r){r&&ae.readdir(t._tempDir,function(n,i){n?t._onErrorHelper(n):(i=i.filter(function(a){return Et.basename(a).indexOf(".ai.json")>-1}),i.length>0&&i.forEach(function(a){var s=new Date(parseInt(a.split(".ai.json")[0])),o=new Date(+new Date-e.FILE_RETEMPTION_PERIOD)>s;if(o){var u=Et.join(t._tempDir,a);ae.unlink(u,function(c){c&&t._onErrorHelper(c)})}}))})})},e.TAG="Sender",e.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",e.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",e.ACLED_DIRECTORIES={},e.ACL_IDENTITY=null,e.WAIT_BETWEEN_RESEND=60*1e3,e.MAX_BYTES_ON_DISK=50*1024*1024,e.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,e.CLEANUP_TIMEOUT=60*60*1e3,e.FILE_RETEMPTION_PERIOD=7*24*60*60*1e3,e.TEMPDIR_PREFIX="appInsights-node",e.OS_PROVIDES_FILE_PROTECTION=!1,e.USE_ICACLS=FE.type()==="Windows_NT",e}();VE.exports=vN});var YE=l((tx,KE)=>{"use strict";var T=Ee(),je=Ie(),EN=$t(),mN=function(){function e(){}return e.createEnvelope=function(t,r,n,i,a){var s=null;switch(r){case T.TelemetryType.Trace:s=e.createTraceData(t);break;case T.TelemetryType.Dependency:s=e.createDependencyData(t);break;case T.TelemetryType.Event:s=e.createEventData(t);break;case T.TelemetryType.Exception:s=e.createExceptionData(t);break;case T.TelemetryType.Request:s=e.createRequestData(t);break;case T.TelemetryType.Metric:s=e.createMetricData(t);break;case T.TelemetryType.Availability:s=e.createAvailabilityData(t);break;case T.TelemetryType.PageView:s=e.createPageViewData(t);break}if(n&&T.domainSupportsProperties(s.baseData)){if(s&&s.baseData)if(!s.baseData.properties)s.baseData.properties=n;else for(var o in n)s.baseData.properties[o]||(s.baseData.properties[o]=n[o]);s.baseData.properties=je.validateStringMap(s.baseData.properties)}var u=a&&a.instrumentationKey||"",c=new T.Envelope;return c.data=s,c.iKey=u,c.name="Microsoft.ApplicationInsights."+u.replace(/-/g,"")+"."+s.baseType.substr(0,s.baseType.length-4),c.tags=this.getTags(i,t.tagOverrides),c.time=new Date().toISOString(),c.ver=1,c.sampleRate=a?a.samplingPercentage:100,r===T.TelemetryType.Metric&&(c.sampleRate=100),c},e.createTraceData=function(t){var r=new T.MessageData;r.message=t.message,r.properties=t.properties,isNaN(t.severity)?r.severityLevel=T.SeverityLevel.Information:r.severityLevel=t.severity;var n=new T.Data;return n.baseType=T.telemetryTypeToBaseType(T.TelemetryType.Trace),n.baseData=r,n},e.createDependencyData=function(t){var r=new T.RemoteDependencyData;typeof t.name=="string"&&(r.name=t.name.length>1024?t.name.slice(0,1021)+"...":t.name),r.data=t.data,r.target=t.target,r.duration=je.msToTimeSpan(t.duration),r.success=t.success,r.type=t.dependencyTypeName,r.properties=t.properties,r.resultCode=t.resultCode?t.resultCode+"":"",t.id?r.id=t.id:r.id=je.w3cTraceId();var n=new T.Data;return n.baseType=T.telemetryTypeToBaseType(T.TelemetryType.Dependency),n.baseData=r,n},e.createEventData=function(t){var r=new T.EventData;r.name=t.name,r.properties=t.properties,r.measurements=t.measurements;var n=new T.Data;return n.baseType=T.telemetryTypeToBaseType(T.TelemetryType.Event),n.baseData=r,n},e.createExceptionData=function(t){var r=new T.ExceptionData;r.properties=t.properties,isNaN(t.severity)?r.severityLevel=T.SeverityLevel.Error:r.severityLevel=t.severity,r.measurements=t.measurements,r.exceptions=[];var n=t.exception.stack,i=new T.ExceptionDetails;i.message=t.exception.message,i.typeName=t.exception.name,i.parsedStack=this.parseStack(n),i.hasFullStack=je.isArray(i.parsedStack)&&i.parsedStack.length>0,r.exceptions.push(i);var a=new T.Data;return a.baseType=T.telemetryTypeToBaseType(T.TelemetryType.Exception),a.baseData=r,a},e.createRequestData=function(t){var r=new T.RequestData;t.id?r.id=t.id:r.id=je.w3cTraceId(),r.name=t.name,r.url=t.url,r.source=t.source,r.duration=je.msToTimeSpan(t.duration),r.responseCode=t.resultCode?t.resultCode+"":"",r.success=t.success,r.properties=t.properties;var n=new T.Data;return n.baseType=T.telemetryTypeToBaseType(T.TelemetryType.Request),n.baseData=r,n},e.createMetricData=function(t){var r=new T.MetricData;r.metrics=[];var n=new T.DataPoint;n.count=isNaN(t.count)?1:t.count,n.kind=T.DataPointType.Aggregation,n.max=isNaN(t.max)?t.value:t.max,n.min=isNaN(t.min)?t.value:t.min,n.name=t.name,n.stdDev=isNaN(t.stdDev)?0:t.stdDev,n.value=t.value,r.metrics.push(n),r.properties=t.properties;var i=new T.Data;return i.baseType=T.telemetryTypeToBaseType(T.TelemetryType.Metric),i.baseData=r,i},e.createAvailabilityData=function(t){var r=new T.AvailabilityData;t.id?r.id=t.id:r.id=je.w3cTraceId(),r.name=t.name,r.duration=je.msToTimeSpan(t.duration),r.success=t.success,r.runLocation=t.runLocation,r.message=t.message,r.measurements=t.measurements,r.properties=t.properties;var n=new T.Data;return n.baseType=T.telemetryTypeToBaseType(T.TelemetryType.Availability),n.baseData=r,n},e.createPageViewData=function(t){var r=new T.PageViewData;r.name=t.name,r.duration=je.msToTimeSpan(t.duration),r.url=t.url,r.measurements=t.measurements,r.properties=t.properties;var n=new T.Data;return n.baseType=T.telemetryTypeToBaseType(T.TelemetryType.PageView),n.baseData=r,n},e.getTags=function(t,r){var n=EN.CorrelationContextManager.getCurrentContext(),i={};if(t&&t.tags)for(var a in t.tags)i[a]=t.tags[a];if(r)for(var a in r)i[a]=r[a];return n&&(i[t.keys.operationId]=i[t.keys.operationId]||n.operation.id,i[t.keys.operationName]=i[t.keys.operationName]||n.operation.name,i[t.keys.operationParentId]=i[t.keys.operationParentId]||n.operation.parentId),i},e.parseStack=function(t){var r=void 0;if(typeof t=="string"){var n=t.split(`
`);r=[];for(var i=0,a=0,s=0;s<=n.length;s++){var o=n[s];if(zE.regex.test(o)){var u=new zE(n[s],i++);a+=u.sizeInBytes,r.push(u)}}var c=32*1024;if(a>c)for(var p=0,d=r.length-1,f=0,_=p,g=d;p<d;){var y=r[p].sizeInBytes,R=r[d].sizeInBytes;if(f+=y+R,f>c){var K=g-_+1;r.splice(_,K);break}_=p,g=d,p++,d--}}return r},e}(),zE=function(){function e(t,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=je.trim(t);var n=t.match(e.regex);n&&n.length>=5&&(this.method=je.trim(n[2])||this.method,this.fileName=je.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=e.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return e.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,e.baseSize=58,e}();KE.exports=mN});var ZE=l((rx,WE)=>{"use strict";var yN=require("url"),TN=al(),SN=bi(),mt=Ee(),AN=LE(),Ws=GE(),XE=$t(),bN=$E(),ul=Ie(),QE=ne(),IN=YE(),CN=function(){function e(t){this._telemetryProcessors=[],this._enableAzureProperties=!1;var r=new TN(t);this.config=r,this.context=new SN,this.commonProperties={};var n=new bN(this.config);this.channel=new AN(function(){return r.disableAppInsights},function(){return r.maxBatchSize},function(){return r.maxBatchIntervalMs},n)}return e.prototype.trackAvailability=function(t){this.track(t,mt.TelemetryType.Availability)},e.prototype.trackPageView=function(t){this.track(t,mt.TelemetryType.PageView)},e.prototype.trackTrace=function(t){this.track(t,mt.TelemetryType.Trace)},e.prototype.trackMetric=function(t){this.track(t,mt.TelemetryType.Metric)},e.prototype.trackException=function(t){t&&t.exception&&!ul.isError(t.exception)&&(t.exception=new Error(t.exception.toString())),this.track(t,mt.TelemetryType.Exception)},e.prototype.trackEvent=function(t){this.track(t,mt.TelemetryType.Event)},e.prototype.trackRequest=function(t){this.track(t,mt.TelemetryType.Request)},e.prototype.trackDependency=function(t){t&&!t.target&&t.data&&(t.target=yN.parse(t.data).host),this.track(t,mt.TelemetryType.Dependency)},e.prototype.flush=function(t){this.channel.triggerSend(t?!!t.isAppCrashing:!1,t?t.callback:void 0)},e.prototype.track=function(t,r){if(t&&mt.telemetryTypeToBaseType(r)){var n=IN.createEnvelope(t,r,this.commonProperties,this.context,this.config);t.time&&(n.time=t.time.toISOString()),this._enableAzureProperties&&Ws.azureRoleEnvironmentTelemetryProcessor(n,this.context);var i=this.runTelemetryProcessors(n,t.contextObjects);i=i&&Ws.samplingTelemetryProcessor(n,{correlationContext:XE.CorrelationContextManager.getCurrentContext()}),Ws.preAggregatedMetricsTelemetryProcessor(n,this.context),i&&(Ws.performanceMetricsTelemetryProcessor(n,this.quickPulseClient),this.channel.send(n))}else QE.warn("track() requires telemetry object and telemetryType to be specified.")},e.prototype.setAutoPopulateAzureProperties=function(t){this._enableAzureProperties=t},e.prototype.addTelemetryProcessor=function(t){this._telemetryProcessors.push(t)},e.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},e.prototype.runTelemetryProcessors=function(t,r){var n=!0,i=this._telemetryProcessors.length;if(i===0)return n;r=r||{},r.correlationContext=XE.CorrelationContextManager.getCurrentContext();for(var a=0;a<i;++a)try{var s=this._telemetryProcessors[a];if(s&&s.apply(null,[t,r])===!1){n=!1;break}}catch(o){n=!0,QE.warn("One of telemetry processors failed, telemetry item will be sent.",o,t)}return n&&(t&&t.tags&&(t.tags=ul.validateStringMap(t.tags)),t&&t.data&&t.data.baseData&&t.data.baseData.properties&&(t.data.baseData.properties=ul.validateStringMap(t.data.baseData.properties))),n},e}();WE.exports=CN});var tm=l((cl,em)=>{"use strict";var ON=cl&&cl.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),PN=ZE(),JE=el(),RN=Pn(),Zs=ne(),NN=function(e){ON(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.trackNodeHttpRequestSync=function(r){r&&r.request&&r.response&&r.duration?JE.trackRequestSync(this,r):Zs.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},t.prototype.trackNodeHttpRequest=function(r){(r.duration||r.error)&&Zs.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),r&&r.request&&r.response?JE.trackRequest(this,r):Zs.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},t.prototype.trackNodeHttpDependency=function(r){r&&r.request?RN.trackRequest(this,r):Zs.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},t}(PN);em.exports=NN});var nm=l(rm=>{"use strict";Object.defineProperty(rm,"__esModule",{value:!0})});var bm=l(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.dispose=v.Configuration=v.wrapWithCorrelationContext=v.startOperation=v.getCorrelationContext=v.start=v.setup=v.liveMetricsClient=v.defaultClient=v.DistributedTracingModes=void 0;var ll=$t(),DN=Pv(),wN=Nv(),im=Hs(),MN=$c(),xN=aE(),LN=Pn(),qN=el(),am=vr(),Di=ne(),kN=IE(),sm=ME();v.TelemetryClient=tm();v.Contracts=Ee();v.azureFunctionsTypes=nm();var om;(function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C"})(om=v.DistributedTracingModes||(v.DistributedTracingModes={}));var um=!0,cm=!1,lm=!0,pm=!0,dm=!0,fm=!1,hm=!0,_m=!0,gm=!0,pl=!0,vm,Js=!1,Em=!0,mm,ym=void 0,Tm=void 0,wi,Mi,xi,Li,qi,Mn,Ir,ki,rt=!1,Sm;function jN(e){return v.defaultClient?Di.info("The default client is already setup"):(v.defaultClient=new v.TelemetryClient(e),wi=new DN(v.defaultClient),Mi=new wN(v.defaultClient),xi=new im(v.defaultClient),Li=new MN(v.defaultClient),qi=new xN(v.defaultClient),Ir=new qN(v.defaultClient),ki=new LN(v.defaultClient),Mn||(Mn=new sm.AutoCollectNativePerformance(v.defaultClient))),v.defaultClient&&v.defaultClient.channel&&v.defaultClient.channel.setUseDiskRetryCaching(gm,ym,Tm),dl}v.setup=jN;function Am(){return v.defaultClient?(rt=!0,wi.enable(um,cm),Mi.enable(lm),xi.enable(pm),Li.enable(dm),qi.enable(fm,v.defaultClient.config),Mn.enable(Em,mm),Ir.useAutoCorrelation(pl,vm),Ir.enable(hm),ki.enable(_m),v.liveMetricsClient&&Js&&v.liveMetricsClient.enable(Js)):Di.warn("Start cannot be called before setup"),dl}v.start=Am;function HN(){return pl?ll.CorrelationContextManager.getCurrentContext():null}v.getCorrelationContext=HN;function UN(e,t){return ll.CorrelationContextManager.startOperation(e,t)}v.startOperation=UN;function BN(e,t){return ll.CorrelationContextManager.wrapCallback(e,t)}v.wrapWithCorrelationContext=BN;var dl=function(){function e(){}return e.setDistributedTracingMode=function(t){return am.w3cEnabled=t===om.AI_AND_W3C,e},e.setAutoCollectConsole=function(t,r){return r===void 0&&(r=!1),um=t,cm=r,rt&&wi.enable(t,r),e},e.setAutoCollectExceptions=function(t){return lm=t,rt&&Mi.enable(t),e},e.setAutoCollectPerformance=function(t,r){r===void 0&&(r=!0),pm=t;var n=sm.AutoCollectNativePerformance.parseEnabled(r);return Em=n.isEnabled,mm=n.disabledMetrics,rt&&(xi.enable(t),Mn.enable(n.isEnabled,n.disabledMetrics)),e},e.setAutoCollectPreAggregatedMetrics=function(t){return dm=t,rt&&Li.enable(t),e},e.setAutoCollectHeartbeat=function(t){return fm=t,rt&&qi.enable(t,v.defaultClient.config),e},e.setAutoCollectRequests=function(t){return hm=t,rt&&Ir.enable(t),e},e.setAutoCollectDependencies=function(t){return _m=t,rt&&ki.enable(t),e},e.setAutoDependencyCorrelation=function(t,r){return pl=t,vm=r,rt&&Ir.useAutoCorrelation(t,r),e},e.setUseDiskRetryCaching=function(t,r,n){return gm=t,ym=r,Tm=n,v.defaultClient&&v.defaultClient.channel&&v.defaultClient.channel.setUseDiskRetryCaching(t,r,n),e},e.setInternalLogging=function(t,r){return t===void 0&&(t=!1),r===void 0&&(r=!0),Di.enableDebug=t,Di.disableWarnings=!r,e},e.setSendLiveMetrics=function(t){return t===void 0&&(t=!1),v.defaultClient?(!v.liveMetricsClient&&t?(v.liveMetricsClient=new kN(v.defaultClient.config,null),Sm=new im(v.liveMetricsClient,1e3,!0),v.liveMetricsClient.addCollector(Sm),v.defaultClient.quickPulseClient=v.liveMetricsClient):v.liveMetricsClient&&v.liveMetricsClient.enable(t),Js=t,e):(Di.warn("Live metrics client cannot be setup without the default client"),e)},e.start=Am,e}();v.Configuration=dl;function GN(){am.w3cEnabled=!0,v.defaultClient=null,rt=!1,wi&&wi.dispose(),Mi&&Mi.dispose(),xi&&xi.dispose(),Li&&Li.dispose(),qi&&qi.dispose(),Mn&&Mn.dispose(),Ir&&Ir.dispose(),ki&&ki.dispose(),v.liveMetricsClient&&(v.liveMetricsClient.enable(!1),Js=!1,v.liveMetricsClient=void 0)}v.dispose=GN});Mm(exports,{default:()=>fl});var to=Ui(require("os")),ro=Ui(require("vscode")),Cr=Ui(bm());var z=Ui(require("vscode")),eo=class{constructor(t,r,n,i,a){this.extensionId=t;this.extensionVersion=r;this.telemetryAppender=n;this.osShim=i;this.firstParty=!1;this.userOptIn=!1;this.firstParty=!!a,this.updateUserOptStatus(),z.env.onDidChangeTelemetryEnabled!==void 0?this.optOutListener=z.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus()):this.optOutListener=z.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus())}updateUserOptStatus(){let t=z.workspace.getConfiguration(eo.TELEMETRY_CONFIG_ID),r=z.env.isTelemetryEnabled===void 0?t.get(eo.TELEMETRY_CONFIG_ENABLED_ID,!0):z.env.isTelemetryEnabled;this.userOptIn!==r&&(this.userOptIn=r)}cleanRemoteName(t){if(!t)return"none";let r="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(n=>{t.indexOf(`${n}+`)===0&&(r=n)}),r}get extension(){return this._extension===void 0&&(this._extension=z.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(t,r){if(t===null||typeof t!="object"||typeof r!="function")return t;let n={};for(let i in t)n[i]=r(i,t[i]);return n}shouldSendErrorTelemetry(){return this.firstParty?this.cleanRemoteName(z.env.remoteName)!=="other"?!0:!(this.extension===void 0||this.extension.extensionKind===z.ExtensionKind.Workspace||z.env.uiKind===z.UIKind.Web):!0}getCommonProperties(){let t=Object.create(null);if(t["common.os"]=this.osShim.platform,t["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),t["common.extname"]=this.extensionId,t["common.extversion"]=this.extensionVersion,z&&z.env){switch(t["common.vscodemachineid"]=z.env.machineId,t["common.vscodesessionid"]=z.env.sessionId,t["common.vscodeversion"]=z.version,t["common.isnewappinstall"]=z.env.isNewAppInstall,z.env.uiKind){case z.UIKind.Web:t["common.uikind"]="web";break;case z.UIKind.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}t["common.remotename"]=this.cleanRemoteName(z.env.remoteName)}return t}anonymizeFilePaths(t,r){if(t==null)return"";let n=[new RegExp(z.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")];this.extension&&n.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let i=t;if(r){let a=[];for(let c of n)for(;;){let p=c.exec(t);if(!p)break;a.push([p.index,c.lastIndex])}let s=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,o=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g,u=0;for(i="";;){let c=o.exec(t);if(!c)break;!s.test(c[0])&&a.every(([p,d])=>c.index<p||c.index>=d)&&(i+=t.substring(u,c.index)+"<REDACTED: user-file-path>",u=o.lastIndex)}u<t.length&&(i+=t.substr(u))}for(let a of n)i=i.replace(a,"");return i}sendTelemetryEvent(t,r,n){if(this.userOptIn&&t!==""){r={...r,...this.getCommonProperties()};let i=this.cloneAndChange(r,(a,s)=>this.anonymizeFilePaths(s,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:i,measurements:n})}}sendTelemetryErrorEvent(t,r,n,i){if(this.userOptIn&&t!==""){r={...r,...this.getCommonProperties()};let a=this.cloneAndChange(r,(s,o)=>this.shouldSendErrorTelemetry()?this.anonymizeFilePaths(o,this.firstParty):i===void 0||i.indexOf(s)!==-1?"REDACTED":this.anonymizeFilePaths(o,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:a,measurements:n})}}sendTelemetryException(t,r,n){if(this.shouldSendErrorTelemetry()&&this.userOptIn&&t){r={...r,...this.getCommonProperties()};let i=this.cloneAndChange(r,(a,s)=>this.anonymizeFilePaths(s,this.firstParty));this.telemetryAppender.logException(t,{properties:i,measurements:n})}}dispose(){return this.telemetryAppender.flush(),this.optOutListener.dispose()}},ji=eo;ji.TELEMETRY_CONFIG_ID="telemetry",ji.TELEMETRY_CONFIG_ENABLED_ID="enableTelemetry";var Im=class{constructor(t){Cr.defaultClient?(this._appInsightsClient=new Cr.TelemetryClient(t),this._appInsightsClient.channel.setUseDiskRetryCaching(!0)):(Cr.setup(t).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setUseDiskRetryCaching(!0).start(),this._appInsightsClient=Cr.defaultClient),ro&&ro.env&&(this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.userId]=ro.env.machineId,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.sessionId]=ro.env.sessionId),t&&t.indexOf("AIF-")===0&&(this._appInsightsClient.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1")}logEvent(t,r){!this._appInsightsClient||this._appInsightsClient.trackEvent({name:t,properties:r.properties,measurements:r.measurements})}logException(t,r){!this._appInsightsClient||this._appInsightsClient.trackException({exception:t,properties:r.properties,measurements:r.measurements})}flush(){return this._appInsightsClient&&(this._appInsightsClient.flush(),this._appInsightsClient=void 0),Promise.resolve(void 0)}},fl=class extends ji{constructor(t,r,n,i){let a=new Im(n);n&&n.indexOf("AIF-")===0&&(i=!0),super(t,r,a,{release:to.release(),platform:to.platform()},i)}};0&&(module.exports={});
